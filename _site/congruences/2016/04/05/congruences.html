<p>Como nos indica el ejemplo anterior, para estudiar
congruencias, basta estudiar congruencias módulo la
potencia de un primo. El caso más simple es el de
congruencias módulo un primo, sobre el que se pueden
demostrar toda una serie de resultados. El primero de todos
es el siguiente:</p>

<p>\proclaim Teorema \fermat\ {\rm (Fermat)}. Sea <script type="math/tex">p</script> un
número primo. Entonces, para cada <script type="math/tex">a\in\mathbb{Z}</script> no divisible
por <script type="math/tex">p</script> se tiene <script type="math/tex">a^{p-1}\equiv 1\ (\text{mod } p)</script>. Como
consecuencia, <script type="math/tex">a^p\equiv a\ (\text{mod } p)</script> para cualquier
<script type="math/tex">a\in\mathbb{Z}</script>.</p>

<p><b>DEMOSTRACIÓN:</b> 
Por la Proposición <b>EJEMPLO:</b> plosrestos(iii), sabemos que, si
<script type="math/tex">\text{mcd}(a,p)=1</script>, los números <script type="math/tex">0,a,2a,\dots,(p-1)a</script> forman
un sistema completo de restos módulo <script type="math/tex">p</script>. Por el Lema
\sistemarestos, esto quiere decir que sus restos al
dividir por <script type="math/tex">p</script> son, en cierto orden, <script type="math/tex">0,1,2,\dots,p-1</script>.
Como obviamente el cero del primer conjunto se corresponde
con el cero del segundo, se tiene que los números
<script type="math/tex">a,2a,\dots,(p-1)a</script> son congruentes módulo <script type="math/tex">p</script>, en
cierto orden, con
<script type="math/tex">1,2,\dots,p-1</script>. Multiplicando todas las congruencias
tendremos <script type="math/tex">(p-1)!a^{p-1}\equiv(p-1)!\ (\text{mod } p)</script>. Además,
como <script type="math/tex">p</script> es un número primo, es coprimo con todos los
factores <script type="math/tex">1,2,\dots,p-1</script> de <script type="math/tex">(p-1)!</script>, luego (Corolario
\productomuchoscoprimos) <script type="math/tex">\text{mcd}((p-1)!,p)=1</script>. Se sigue
entonces de la Proposición \propiedadescongruencias(vi)
que <script type="math/tex">a^{p-1}\equiv 1\ (\text{mod } p)</script>.</p>

<p>La congruencia anterior implica automáticamente
<script type="math/tex">a^p\equiv a\ (\text{mod } p)</script>, siempre bajo la hipótesis
<script type="math/tex">\text{mcd}(a,p)=1</script>. Si en cambio <script type="math/tex">p\vert a</script>, entonces tanto <script type="math/tex">a^p</script>
como <script type="math/tex">a</script> son congruentes con cero módulo <script type="math/tex">p</script>, luego la
congruencia <script type="math/tex">a^p\equiv a\ (\text{mod } p)</script> es también válida
en este caso.
\qed</p>

<p>La propiedad del Teorema de Fermat no es
característica de los números primos, ya que hay
números compuestos que satisfacen lo mismo.</p>

<p><b>DEFINICIÓN:</b>  Se llama {\it número pseudoprimo en base <script type="math/tex">a</script>} a un
número compuesto <script type="math/tex">n</script> tal que <script type="math/tex">a^n\equiv a\ (\text{mod } n)</script>. Se
llama simplemente {\it número pseudoprimo} a un número
compuesto <script type="math/tex">n</script> tal que <script type="math/tex">2^n\equiv 2\ (\text{mod } n)</script>. Finalmente,
se llama {\it pseudoprimo absoluto} o {\it número de
Carmichael} a un número compuesto <script type="math/tex">n</script> tal que
<script type="math/tex">a^n\equiv a\ (\text{mod } n)</script> para cualquier número entero
<script type="math/tex">a</script>.</p>

<p>Obviamente son mucho más interesantes (y más
difíciles de encontrar) los números de Carmichael
que los pseudoprimos (aunque los matemáticos chinos de
hace 25 siglos pensaban que no había números
pseudoprimos). De ambos se sabe que hay infinitos de ellos.
En el caso de pseudoprimos, no cuesta mucho ver que, dado
un número pseudoprimo impar <script type="math/tex">n</script>, entonces <script type="math/tex">2^n-1</script> es
también un número pseudoprimo, lo que permite
construir infinitos pseudoprimos (basta empezar por
<script type="math/tex">341=11\cdot31</script>, que es el primer número pseudoprimo).
Para números de Carmichael, nos limitaremos a dar el
siguiente resultado:</p>

<p><b>LEMA:</b> \carmichael. Sea <script type="math/tex">n=p_1p_2\dots p_r</script>
un producto de <script type="math/tex">r</script> primos distintos, con <script type="math/tex">r>1</script>. Si para
cada <script type="math/tex">i=1,2,\dots,r</script> se tiene <script type="math/tex">p_i-1\vert n-1</script>, entonces <script type="math/tex">n</script> es
un número de Carmichael.</p>

<p><b>DEMOSTRACIÓN:</b>  Claramente <script type="math/tex">n</script> es compuesto, porque <script type="math/tex">r>1</script>, así
que hay que demostrar que <script type="math/tex">a^n\equiv a\ (\text{mod } p_1p_2\dots
p_r)</script> para todo entero <script type="math/tex">a</script>. Por la Proposición
\congruenciaproducto, hay que demostrar que, para cada
<script type="math/tex">i=1,2,\dots,r</script>, se tiene <script type="math/tex">a^n\equiv a(\text{mod } p_i)</script>.
Obviamente esto es cierto si <script type="math/tex">p_i\vert a</script>, así que podemos
suponer <script type="math/tex">\text{mcd}(a,p_i)=1</script>. En tal caso, por el Teorema de
Fermat se tendrá <script type="math/tex">a^{p_i-1}\equiv1\ (\text{mod } p_i)</script> y, como
por hipótesis <script type="math/tex">p_i-1\vert n-1</script>, se tendrá también 
<script type="math/tex">a^{n-1}\equiv 1(\text{mod } p_i)</script>, lo que implica <script type="math/tex">a^n\equiv
a(\text{mod } p_i)</script>.
\qed</p>

<p><b>EJEMPLO:</b> {<b>EJEMPLO:</b> ploCarmichael} Con la proposición anterior, se
demuestra que <script type="math/tex">561=3\cdot11\cdot17</script> es un número de
Carmichael (de hecho es el primero de todos). Otros
ejemplos obtenidos de este modo son los números
<script type="math/tex">1729=7\cdot13\cdot19</script>, <script type="math/tex">6601=7\cdot23\cdot41</script> y
<script type="math/tex">10585=5\cdot29\cdot73</script>. Aunque no verifiquen el
critero de la proposición anterior, también son
números de Carmichael <script type="math/tex">1105=5\cdot13\cdot17</script>,
<script type="math/tex">2821=7\cdot13\cdot31</script>, <script type="math/tex">15841=7\cdot31\cdot73</script> y
<script type="math/tex">16046641=13\cdot37\cdot73\cdot457</script> (uno de los pocos
conocidos con cuatro factores, descubierto por el propio
Carmichael). Sólo en 1994 se demostró que existen
infinitos números de Carmichael. Son tan escasos que
sólo hay <script type="math/tex">43</script> de ellos menores que un millón.</p>

<p><b>EJEMPLO:</b> {<b>EJEMPLO:</b> plowilson} Si consideramos el conjunto de restos
módulo <script type="math/tex">11</script>, observamos que tenemos los pares
disjuntos <script type="math/tex">\{2,6\}</script>, <script type="math/tex">\{3,4\}</script>, <script type="math/tex">\{5,9\}</script>, <script type="math/tex">\{7,8\}</script> con la
propiedad de que el producto de los elementos de un par es
congruente con <script type="math/tex">1</script> módulo <script type="math/tex">11</script>. Además, la unión de
todos los pares da el conjunto <script type="math/tex">\{2,3,4,5,6,7,8,9\}</script>, por
lo que tendremos
<script type="math/tex"></script>2\cdot3\cdot4\cdot5\cdot6\cdot7\cdot8\cdot9
=(2\cdot6)(3\cdot4)(5\cdot9)(7\cdot8)\equiv1\ (\text{mod } 11).<script type="math/tex"></script>
Esto no es casualidad, y para cada número primo tenemos
la misma situación, lo que nos permite demostrar el
siguiente teorema.</p>

<p>\proclaim Teorema \wilson\ {\rm (Wilson)}. Si <script type="math/tex">p</script> es un
número primo, entonces <script type="math/tex">(p-1)!\equiv-1\ (\text{mod } p)</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Suponemos <script type="math/tex">p>3</script>, ya que los casos <script type="math/tex">p=2,3</script> se pueden
comprobar trivialmente a mano. Para cada <script type="math/tex">a=1,2\dots,p-1</script>,
consideramos la congruencia <script type="math/tex">ax\equiv1\ (\text{mod } p)</script> que, por
la Proposición \congruencialineal\ tendrá exactamente
una solución módulo <script type="math/tex">p</script>, luego se podrá representar
exactamente por un número <script type="math/tex">a'\in\{1,2,\dots,p-1\}</script>
(claramente, no puede ser <script type="math/tex">a'=0</script>). Por tanto, tenemos una
aplicación <script type="math/tex">\{1,2,\dots,p-1\}\to\{1,2,\dots,p-1\}</script> que
asocia a cada <script type="math/tex">a</script> el elemento <script type="math/tex">a'</script>. Tal aplicación es
necesariamente biyectiva, al tener ambos conjuntos el mismo
número de elementos. Obsérvese que, si <script type="math/tex">a'=a</script>, entonces
<script type="math/tex">a^2\equiv1\ (\text{mod } p)</script>, es decir <script type="math/tex">p\vert a^2-1=(a+1)(a-1)</script>. Por
el Corolario \primodivideproducto, se tiene <script type="math/tex">p\vert a+1</script> o bien
<script type="math/tex">p\vert a-1</script>. Como <script type="math/tex">a\in\{1,2,\dots,p-1\}</script>, se sigue <script type="math/tex">a=1</script> o bien
<script type="math/tex">a=p-1</script>. Por tanto, el conjunto <script type="math/tex">\{2,3,\dots,p-2\}</script> se
descompone, como en el Ejemplo <b>EJEMPLO:</b> plowilson, en pares
<script type="math/tex">\{a,a'\}</script> con la propiedad <script type="math/tex">aa'\equiv1\ (\text{mod } p)</script>.
Agrupando según estos pares el producto de todos los
elementos de <script type="math/tex">\{2,3,\dots,p-2\}</script>, se llega a
<script type="math/tex">2\cdot3\dots(p-2)\equiv1\ (\text{mod } p)</script> y, por tanto,
<script type="math/tex">(p-1)!=1\cdot(2\cdot3\dots(p-2))(p-1)\equiv
1\cdot 1\cdot(p-1)\equiv-1\ (\text{mod } p)</script>, como queríamos.
\qed</p>

<p>\obs{\reciprocoWilson} Nótese que, al contrario que pasa
con el teorema de Fermat, la propiedad anterior sí que
caracteriza a los números primos. En efecto, dado un
número compuesto <script type="math/tex">n</script>, si <script type="math/tex">d\ne1,n</script> es un divisor
suyo, se tendrá que <script type="math/tex">d</script> es uno de los factores de
<script type="math/tex">(n-1)!</script>, por lo que <script type="math/tex">(n-1)!\equiv0\ (\text{mod } d)</script>. Por tanto,
no puede ser <script type="math/tex">(n-1)!\equiv-1\ (\text{mod } n)</script>. En realidad, no
es difícil demostrar que, si <script type="math/tex">n>4</script> es un número
compuesto, entonces <script type="math/tex">(n-1)!\equiv0\ (\text{mod } n)</script>.</p>

<p>El Teorema de Wilson tiene el siguiente corolario
inesperado:</p>

<p>\proclaim Teorema \menosunocuadrado. Si <script type="math/tex">p</script> es primo, la
congruencia <script type="math/tex">x^2\equiv -1\ (\text{mod } p)</script> tiene solución si y
sólo si <script type="math/tex">p=2</script> o bien <script type="math/tex">p\equiv 1\ (\text{mod }4)</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Supongamos primero que la congruencia tiene
una solución, que llamaremos <script type="math/tex">a</script>. Obviamente, <script type="math/tex">a</script> no
puede ser divisible por <script type="math/tex">p</script>, porque en tal caso
<script type="math/tex">a^2\equiv0\ (\text{mod } p)</script>. Para ver que <script type="math/tex">p=2</script> o bien <script type="math/tex">p\equiv
1\ (\text{mod }4)</script> basta demostrar que <script type="math/tex">p\not\equiv 3\
(\text{mod }4)</script>. En efecto, si fuera <script type="math/tex">p\equiv 3\
(\text{mod }4)</script>, entonces <script type="math/tex">p-1\over2</script> sería un número
impar, y como <script type="math/tex">a^2\equiv-1\ (\text{mod } p)</script>, entonces 
<script type="math/tex"></script>a^{p-1}=(a^2)^{p-1\over2}\equiv(-1)^{p-1\over2}\ (\text{mod }
p)=-1\ (\text{mod } p),<script type="math/tex"></script>
mientras que el Teorema de
Fermat (Teorema \fermat),  implica <script type="math/tex">a^{p-1}\equiv1\ (\text{mod }
p)</script>, lo que da una contradicción.</p>

<p>Recíprocamente, supongamos <script type="math/tex">p=2</script> o bien <script type="math/tex">p\equiv 1\
(\text{mod }4)</script> y veamos que la congruencia tiene solución. Es
claro que <script type="math/tex">x^2\equiv -1\ (\text{mod } 2)</script> tiene solución (de
hecho, cualquier <script type="math/tex">x</script> impar lo es), así que podemos
limitarnos al caso <script type="math/tex">p\equiv 1\ (\text{mod }4)</script>. En tal caso,
tenemos que <script type="math/tex">p-1\over2</script> es un número par. Esto quiere
decir que el número de congruencias (triviales)
<script type="math/tex"></script>1\equiv -(p-1)\ (\text{mod } p)<script type="math/tex"></script>
<script type="math/tex"></script>2\equiv -(p-2)\ (\text{mod } p)<script type="math/tex"></script>
<script type="math/tex"></script>\vdots<script type="math/tex"></script>
<script type="math/tex"></script>{p-1\over2}\equiv -{p+1\over2}\ (\text{mod } p)<script type="math/tex"></script>
es par. Por tanto, multiplicándolas todas tendremos
<script type="math/tex"></script>({p-1\over2})!\equiv(p-1)(p-2)\dots{p+1\over2}\ (\text{mod }
p)<script type="math/tex"></script> 
de donde se deduce, usando el Teorema de Wilson para la
última congruencia,
<script type="math/tex"></script>\big(({p-1\over2})!\big)^2
\equiv(p-1)(p-2)\dots{p+1\over2}({p-1\over2})!=(p-1)!
\equiv-1\ (\text{mod } p).<script type="math/tex"></script>
Por tanto, <script type="math/tex">x=({p-1\over2})!</script> es una solución de
<script type="math/tex">x^2\equiv -1\ (\text{mod } p)</script>.</p>

<p>\qed</p>

<p>\proclaim Corolario \infinitosprimoscuatrokmasuno. Existen
infinitos números primos de la forma <script type="math/tex">4k+1</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Como siempre, supongamos por reducción al absurdo
que <script type="math/tex">p_1,p_2,\dots, p_r</script> sean todos los números primos de
la forma <script type="math/tex">4k+1</script>. Consideramos entonces el número
<script type="math/tex">a=(2p_1p_2\dots p_r)^2+1</script> y sea <script type="math/tex">p</script> un divisor primo de
<script type="math/tex">a</script> (que obviamente existe, por ser <script type="math/tex">a>4</script>. Entonces,
<script type="math/tex">2p_1p_2\dots p_r</script> es una solución de la congruencia
<script type="math/tex">x^2\equiv-1\ (\text{mod } p)</script>, por lo que el Teorema
\menosunocuadrado\ implica que <script type="math/tex">p=2</script> o bien <script type="math/tex">p</script> es de la
forma <script type="math/tex">4k+1</script>, es decir, es uno de los <script type="math/tex">p_1,p_2,\dots,p_r</script>.
Como claramente ni <script type="math/tex">2</script> ni <script type="math/tex">p_1,p_2,\dots,p_r</script> son
divisores de <script type="math/tex">a</script>, se llega la contradicción buscada.
\qed</p>

<p>Podemos mejorar el resultado anterior de la misma forma
que hicimos en la Observación
\infinitosprimoscuatrokmastres\ con el Teorema de Euclides:</p>

<p>\proclaim Corolario \infinitosprimosochokmascinco. Existen
infinitos números primos de la forma <script type="math/tex">8k+5</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Supongamos que <script type="math/tex">p_1,p_2,\dots, p_r</script> sean todos los
números primos de la forma <script type="math/tex">8k+5</script>, y consideramos de
nuevo <script type="math/tex">a=(2p_1p_2\dots p_r)^2+1</script>. Ya hemos observado en la
demostración anterior que los divisores primos de <script type="math/tex">a</script>
son de la forma <script type="math/tex">4k+1</script>. Por tanto, son de la forma <script type="math/tex">8k+1</script>
o bien <script type="math/tex">8k+5</script>. Ahora bien, como cada <script type="math/tex">(p_1p_2\dots p_r)^2</script>
es impar,  es decir, de la forma <script type="math/tex">2k+1</script>, entonces
<script type="math/tex">a=4(p_1p_2\dots p_r)^2+1</script> es de la forma <script type="math/tex">8k+5</script>. Por
tanto, no todos los divisores primos de <script type="math/tex">a</script> son de la
forma <script type="math/tex">8k+1</script>, por lo que <script type="math/tex">a</script> es divisible por algún
primo de la forma <script type="math/tex">8k+5</script>, es decir, por algún <script type="math/tex">p_i</script>, lo
que es imposible.
\qed</p>
