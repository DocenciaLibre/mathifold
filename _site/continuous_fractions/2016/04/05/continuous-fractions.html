<p>Cuando pasamos de los números enteros a los racionales,
la escritura que solemos hacer de ellos, aparte de como
fracciones, es a partir de su notación decimal. Esta
escritura decimal presenta dos inconvenientes. Uno es que
depende de una elección de escritura en base <script type="math/tex">10</script>, que a
priori es arbitraria. El segundo inconveniente es que las
expresiones con decimales suelen ser infinitas, aunque al
menos son periódicas y se pueden representar de forma
finita.</p>

<p><b>EJEMPLO:</b> {\justificacioncontinua} Veamos una tercera
representación de un número racional a partir del
algoritmo de Euclides. Si tenemos el número
<script type="math/tex">a\over b</script>, escribimos
<script type="math/tex"></script>\matrix{
a=ba_0+r_1&amp;&amp;&amp;0\lt r_1\lt b\hfill\cr
b=r_1a_1+r_2&amp;&amp;&amp;0\lt r_2\lt r_1\hfill\cr
r_1=r_2a_2+r_3&amp;&amp;&amp;0\lt r_3\lt r_2\hfill\cr
\vdots\cr
r_{n-2}=r_{n-1}a_{n-1}+r_n&amp;&amp;&amp;0\lt r_n\lt r_{n-1}\hfill\cr
r_{n-1}=r_na_n
}<script type="math/tex"></script>
donde <script type="math/tex">r_n=\text{mcd}(a,b)</script>. Además, <script type="math/tex">a_1,\dots,a_r>0</script>
porque son cocientes de números positivos uno mayor que
el otro. Podemos entonces escribir:
<script type="math/tex"></script>{a\over b}=a_0+{r_1\over b}<script type="math/tex"></script>
<script type="math/tex"></script>{b\over r_1}=a_1+{r_2\over r_1}<script type="math/tex"></script>
<script type="math/tex"></script>{r_1\over r_2}=a_2+{r_3\over r_2}<script type="math/tex"></script>
<script type="math/tex"></script>\vdots<script type="math/tex"></script>
<script type="math/tex"></script>{r_{n-2}\over r_{n-1}}=a_{n-1}+{r_n\over r_{n-1}}<script type="math/tex"></script>
<script type="math/tex"></script>{r_{n-1}\over r_n}=a_n<script type="math/tex"></script>
(es decir, <script type="math/tex">a_0,a_1,\dots,a_r</script> son las partes enteras de
<script type="math/tex">{a\over b},{b\over r_1},\dots,{r_{n-1}\over r_n}</script>) y,
poniendo todo junto,
<script type="math/tex"></script>{a\over b}=a_0+{r_1\over b}
=a_0+{1\over a_1+{r_2\over r_1}}
=a_0+{1\over a_1+{1\over a_2+{r_3\over
r_2}}}=\dots=a_0+{1\over a_1+{1\over a_2+{1\over
\ddots{1\over a_{n-1}+{1\over a_n}}}}}<script type="math/tex"></script></p>

<p><b>EJEMPLO:</b> {\continuainfinita} Podríamos intentar ahora
repetir un proceso parecido para cualquier número: dado un
número real
<script type="math/tex">\alpha\ne0</script>, vamos escribiendo
<script type="math/tex"></script>\alpha_0:=\alpha=[\alpha_0]+(\alpha_0-[\alpha_0])=a_0+(\alpha_0-a_0)<script type="math/tex"></script>
<script type="math/tex"></script>\alpha_1:={1\over\alpha_0-a_0}=[\alpha_1]+(\alpha_1-[\alpha_1])=a_1+(\alpha_1-a_1)<script type="math/tex"></script>
<script type="math/tex"></script>\vdots<script type="math/tex"></script>
es decir, definimos por recurrencia, a partir de
<script type="math/tex">\alpha_0=\alpha</script>, los números <script type="math/tex">a_k</script> y <script type="math/tex">\alpha_k</script> mediante:
<script type="math/tex"></script>a_k=[\alpha_k]<script type="math/tex"></script> 
<script type="math/tex"></script>\alpha_{k+1}={1\over\alpha_k-a_k}.<script type="math/tex"></script>
Tendremos entonces
<script type="math/tex"></script>\alpha=a_0+{1\over a_1+{1\over a_2+{1\over
\ddots{1\over a_{k-1}+{1\over
a_k+{1\over\alpha_{k+1}}}}}}}.<script type="math/tex"></script> Obsérvese que, como
<script type="math/tex">a_k\le\alpha_k\lt a_k+1</script>, necesariamente
<script type="math/tex">0\le\alpha_k-a_k\lt 1</script>, por lo que, si <script type="math/tex">\alpha_k\ne a_k</script> (es
decir, si <script type="math/tex">\alpha_k</script> no es entero), se tendrá
<script type="math/tex">\alpha_{k+1}>1</script>, por lo que <script type="math/tex">a_k\ge1</script> si <script type="math/tex">k\ge1</script> (aunque
<script type="math/tex">a_0</script> puede ser cero o incluso negativo). Si <script type="math/tex">\alpha</script> es
racional, el Ejemplo \justificacioncontinua\ indica que el
proceso termina (lo que ocurre cuando llegamos a algún
<script type="math/tex">\alpha_k</script> entero y, por tanto <script type="math/tex">a_k=\alpha_k</script>), mientras que
si <script type="math/tex">\alpha</script> es irracional, entonces cada <script type="math/tex">\alpha_k</script> es
también irracional, y por tanto el proceso no termina
nunca. Por ejemplo, si tomamos <script type="math/tex">\alpha\sqrt2</script>, tendremos
entonces 
<script type="math/tex"></script>\alpha_0=\sqrt2=1’414213562\dots=1+0’414213562\dots=1+(\sqrt2-1)<script type="math/tex"></script>
<script type="math/tex"></script>\alpha_1={1\over\sqrt2-1}={\sqrt2+1}=2’414213562\dots
=2+0’414213562\dots=2+(\sqrt2-1)<script type="math/tex"></script>
y, a partir de aquí,
<script type="math/tex">\alpha_1=\alpha_2=\dots=\sqrt2+1</script>, y por tanto
<script type="math/tex">a_1=a_2=\dots=1</script>, mientras <script type="math/tex">a_0=1</script>. Parecería
entonces natural escribir
<script type="math/tex"></script>\sqrt2=1+{1\over 2+{1\over 2+{1\over
2+{1\over 2+\dots}}}}<script type="math/tex"></script></p>

<p><b>DEFINICIÓN:</b> Se llama {\it fracción continua} a una expresión
del tipo
<script type="math/tex"></script>[a_0;a_1,a_2,\dots]:=a_0+{1\over a_1+{1\over a_2+{1\over
a_3+{1\over a_4+\dots}}}}<script type="math/tex"></script>
donde los números <script type="math/tex">a_1,a_2,\dots</script> (que pueden ser una
cantidad finita o infinita) son estrictamente positivos.
Se llama {\it fracción
continua asociada a un número real}
<script type="math/tex">\alpha</script> a la fracción continua <script type="math/tex">[a_0;a_1,a_2,\dots]</script>
definida como en el Ejemplo \continuainfinita. Se dice que
una fracción continua es {\it simple} si
<script type="math/tex">a_0,a_1,\dots</script> son números enteros (y por tanto
<script type="math/tex">a_1,a_2,\dots\ge1</script>). Usaremos también la notación
<script type="math/tex">[a_0;a_1,\dots,a_r,\overline{a_{r+1},\dots,a_{r+s}}]</script> para
indicar la fracción continua infinita periódica 
<script type="math/tex">[a_0;a_1,\dots,a_r,a_{r+1},\dots,a_{r+s}
,a_{r+1},\dots,a_{r+s},a_{r+1},\dots,a_{r+s},\dots]</script>.</p>

<p>Por lo que hemos visto, un número racional se expresa
siempre como una fracción continua simple finita, y es
obvio que las fracciones continuas simples finitas
representan números racionales. Por otra parte, el
método anterior sugiere que los números
irracionales tienen asociada una fracción
continua infinita. Para dar sentido a dicha expresión
infinita, habrá que verla como
límite de sus subfracciones infinitas. Más
precisamente:</p>

<p><b>DEFINICIÓN:</b> Se llama {\it convergente <script type="math/tex">k</script>-ésimo} de una fracción
continua simple <script type="math/tex">[a_0;a_1,a_2,\dots]</script> (finita o infinita) a
<script type="math/tex">C_k=[a_0;a_1,a_2,\dots,a_k]</script>.</p>

<p>\proclaim Teorema \formulaconvergentes. Sea
<script type="math/tex">[a_0;a_1,a_2,\dots]</script> una fracción continua (no
necesariamente simple o finita). Definimos recursivamente
dos sucesiones de números <script type="math/tex">p_k</script> y <script type="math/tex">q_k</script> con <script type="math/tex">k\ge-2</script>
mediante
<script type="math/tex"></script>\left{\eqalign{
p_{-2}=&amp;0\cr 
p_{-1}=&amp;1\cr
p_k=&amp;a_kp_{k-1}+p_{k-2}
}\right. \ \ \ \ \ \ \ \
\left{\eqalign{
q_{-2}=&amp;1\cr 
q_{-1}=&amp;0\cr
q_k=&amp;a_kq_{k-1}+q_{k-2}
}\right.<script type="math/tex"></script>
Entonces:
\item{(i)} Para cada <script type="math/tex">k\ge0</script> se tiene <script type="math/tex">C_k={p_k\over q_k}</script>.
\item{(ii)} Para cada <script type="math/tex">k\ge-2</script>
se tiene <script type="math/tex">p_{k+1}q_k-p_kq_{k+1}=(-1)^k</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Demostraremos (i) por inducción sobre <script type="math/tex">k</script>. Para
<script type="math/tex">k=0</script>, se tiene <script type="math/tex">p_0=a_0</script>, <script type="math/tex">q_0=1</script>, luego <script type="math/tex">{p_0\over
q_0}=a_0=[a_0]=C_0</script>.</p>

<p>Supongamos ahora que sabemos que la fórmula es cierta
para convergentes <script type="math/tex">k</script>-ésimos y veamos que es cierta para
los <script type="math/tex">(k+1)</script>-ésimos. Para ello consideramos la fracción
continua
<script type="math/tex"></script>[a’<em>0;a’_1,a’_2,\dots,a’_k]:=
[a_0;a_1,a_2,\dots,a_k+{1\over a</em>{k+1}}],<script type="math/tex"></script>
que claramente coincide con <script type="math/tex">C_{k+1}</script>. Por otra parte, es
claro que si <script type="math/tex">i\le k-1</script> entonces <script type="math/tex">p'_i=p_i</script> y <script type="math/tex">q'_i=q_i</script>,
mientras que para <script type="math/tex">i=k</script> se tiene
<script type="math/tex"></script>p’<em>k=a’_kp’</em>{k-1}+p’<em>{k-2}=(a_k+{1\over
a</em>{k+1}})p_{k-1}+p_{k-2}
=a_kp_{k-1}+p_{k-2}+{p_{k-1}\over a_{k+1}}
=p_k+{p_{k-1}\over a_{k+1}}<script type="math/tex"></script>
<script type="math/tex"></script>q’<em>k=a’_kq’</em>{k-1}+q’<em>{k-2}=(a_k+{1\over
a</em>{k+1}})q_{k-1}+q_{k-2}
=a_kq_{k-1}+q_{k-2}+{q_{k-1}\over a_{k+1}}
=q_k+{q_{k-1}\over a_{k+1}}<script type="math/tex"></script>
luego, por hipótesis de inducción,
<script type="math/tex"></script>C_{k+1}=C’<em>k={p’_k\over q’_k}=
{p_k+{p</em>{k-1}\over a_{k+1}}\over q_k+{q_{k-1}\over a_{k+1}}}
={a_{k+1}p_k+p_{k-1}\over a_{k+1}q_k+q_{k-1}}
={p_{k+1}\over q_{k+1}}<script type="math/tex"></script></p>

<p>Demostramos (ii) también por inducción sobre <script type="math/tex">k</script>,
siendo trivial el caso <script type="math/tex">k=-2</script>. Supuesta cierta la fórmula
para <script type="math/tex">k</script>, se tiene
<script type="math/tex"></script>p_{k+2}q_{k+1}-p_{k+1}q_{k+2}=
(a_{k+2}p_{k+1}+p_k)q_{k+1}-p_{k+1}(a_{k+2}q_{k+1}+q_k)
=p_kq_{k+1}-p_{k+1}q_k=<script type="math/tex"></script>
<script type="math/tex"></script>=-(p_{k+1}q_k-p_kq_{k+1})
=-(-1)^k=(-1)^{(k+1)}.<script type="math/tex"></script>
\qed</p>

<p><b>EJEMPLO:</b> {\bezoutconvergentes} La parte (ii) del teorema
anterior implica, si la fracción continua es simple, que
<script type="math/tex">p_k,q_k</script> son enteros primos entre sí (usando por
ejemplo el Teorema
\bezout). De hecho, puede usarse esta parte para obtener
explícitamente una combinación lineal de dos enteros
que dé su máximo común divisor. Por ejemplo,
consideremos los enteros <script type="math/tex">a=34,b=14</script>. Si aplicamos el
algoritmo de Euclides podremos escribir
<script type="math/tex"></script>34=2\cdot14+6<script type="math/tex"></script>
<script type="math/tex"></script>14=2\cdot6+2<script type="math/tex"></script>
<script type="math/tex"></script>6=3\cdot2+0<script type="math/tex"></script>
de donde sacamos 
<script type="math/tex"></script>{34\over14}=[2;2,3].<script type="math/tex"></script>
Las sucesiones <script type="math/tex">p_k,q_k</script> valen entonces
<script type="math/tex"></script>p_0=2,\ p_1=5,\ p_2=17<script type="math/tex"></script>
<script type="math/tex"></script>q_0=1,\ q_1=2,\ q_2=7<script type="math/tex"></script>
lo que nos da <script type="math/tex">{34\over14}=C_2={17\over7}</script>. Esto indica,
por una parte, que <script type="math/tex">\text{mcd}(34,14)=2</script>, y por otra parte nos da
la relación
<script type="math/tex"></script>2\cdot17-5\cdot7=-1,<script type="math/tex"></script>
que, cambiando de signo y multiplicada por el máximo
común divisor nos da
<script type="math/tex"></script>5\cdot14-2\cdot34=2<script type="math/tex"></script></p>

<p><b>LEMA:</b>  \acotacionconvergentes. Dada una fracción
continua, se tiene, para todo <script type="math/tex">k\ge0</script>,:
\item{(i)} <script type="math/tex">C_{k+1}-C_k={(-1)^k\over q_{k+1}q_k}</script>.
\item{(ii)} <script type="math/tex">C_{k+2}-C_k={(-1)^k\over q_{k+1}}({1\over
q_k}-{1\over q_{k+2}})</script>.
\item{(iii)} Si la fracción es simple, 
<script type="math/tex">0\lt q_1\lt q_2\lt \dots</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Por el Teorema \formulaconvergentes, tenemos
<script type="math/tex"></script>C_{k+1}-C_k={p_{k+1}\over q_{k+1}}-{p_k\over q_k}
={p_{k+1}q_k-p_kq_{k+1}\over q_{k+1}q_k}
={(-1)^k\over q_{k+1}q_k},<script type="math/tex"></script>
lo que demuestra (i). Utilizando dos veces (i) tendremos
<script type="math/tex"></script>C_{k+2}-C_k=(C_{k+2}-C_{k+1})+(C_{k+1}-C_k)
={(-1)^{k+1}\over q_{k+2}q_{k+1}}+{(-1)^k\over q_{k+1}
q_k}
={(-1)^k\over q_{k+1}}\left({1\over q_k}-{1\over
q_{k+2}}\right),<script type="math/tex"></script> lo que demuestra (ii).</p>

<p>Para la parte (iii), se tiene <script type="math/tex">q_1=a_1>0</script>, luego
basta demostrar <script type="math/tex">q_{k-1}\lt q_k</script> para todo <script type="math/tex">k\ge2</script>. Lo
hacemos por inducción sobre <script type="math/tex">k</script>. Si <script type="math/tex">k=2</script>, tenemos
<script type="math/tex">q_2=a_2q_1+q_0=a_2q_1+1>a_2q_1</script>. Como <script type="math/tex">a_2\ge1</script> (ya que
<script type="math/tex">a_2>0</script> y <script type="math/tex">a_2</script> es entero por ser la fracción simple), se
sigue <script type="math/tex">q_2>q_1</script>. El paso de inducción sigue los mismos
pasos. Si suponemos que se verifica
<script type="math/tex">q_1\lt q_2\lt \dots\lt q_{k-1}\lt q_k</script>, entonces en particular
<script type="math/tex">q_{k-1},q_k>0</script>. Como de nuevo se tiene <script type="math/tex">a_{k+1}\ge1</script> por
ser la fracción simple, se sigue:
<script type="math/tex"></script>q_{k+1}=a_{k+1}q_k+q_{k-1}\ge q_k+q_{k-1}&gt;q_k.<script type="math/tex"></script>
\vskip -0.8cm\qed</p>

<p>\proclaim Teorema \convergenciaconvergentes. Dada una
fracción continua simple, se tiene, para todo <script type="math/tex">k\ge0</script>,
<script type="math/tex"></script>C_0\lt C_2\lt C_4\lt \dots\lt C_{2k}\lt C_{2k+1}\lt \dots\lt C_3\lt C_1.<script type="math/tex"></script>
Además, si la fracción continua es infinita, existe el
límite de la sucesión
<script type="math/tex">\{C_k\}</script>, que es un número irracional <script type="math/tex">\alpha</script> que
verifica <script type="math/tex">C_{2k}\lt \alpha\lt C_{2k+1}</script> para todo <script type="math/tex">k</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Por el Lema \acotacionconvergentes, se tiene
<script type="math/tex">C_{k+2}-C_k={(-1)^k\over q_{k+1}}({1\over
q_k}-{1\over q_{k+2}})</script> y además
<script type="math/tex">q_{k+1}>0</script> y
<script type="math/tex">q_k\lt q_{k+2}</script>, luego <script type="math/tex">C_{k+2}-C_k</script> es positivo si <script type="math/tex">k</script> es
par y negativo si <script type="math/tex">k</script> es impar, por lo que los convergentes
pares son crecientes y los impares son decrecientes.
Además <script type="math/tex">C_{k+1}-C_k={(-1)^k\over q_{k+1}q_k}</script>, que
es positivo si <script type="math/tex">k</script> es par y negativo si <script type="math/tex">k</script> es impar. Por
tanto, un convergente impar es siempre mayor que su
convergente anterior par.</p>

<p>Tenemos entonces la sucesión creciente
<script type="math/tex">C_0\lt C_2\lt C_4\lt \dots</script>, que está acotada, luego tiene un
límite <script type="math/tex">\alpha</script>, y la sucesión decreciente
<script type="math/tex">C_1>C_3>C_5>\dots</script>, que también está acotada, luego
tiene límite <script type="math/tex">\alpha'\ge\alpha</script>. Además, para todo
<script type="math/tex">k</script> se tiene
<script type="math/tex"></script>\alpha’-\alpha\lt C_{2k+1}-C_{2k}={(-1)^{2k}\over
q_{2k+1}q_{2k}},<script type="math/tex"></script>
que es un valor que tiende a cero (por ser <script type="math/tex">q_k</script> una
sucesión creciente de números enteros), luego
<script type="math/tex">\alpha=\alpha'</script>.</p>

<p>Veamos finalmente que <script type="math/tex">\alpha</script> es irracional. Supongamos, por
reducción al absurdo, que fuera <script type="math/tex">\alpha={a\over b}</script>, con
<script type="math/tex">a,b</script> enteros (y <script type="math/tex">b>0</script>). Entonces, como para cada <script type="math/tex">k</script> se
tiene que
<script type="math/tex">\alpha</script> está entre <script type="math/tex">C_k</script> y <script type="math/tex">C_{k+1}</script> (quién sea el
mayor de los dos depende de la paridad de <script type="math/tex">k</script>), se tiene
<script type="math/tex"></script>0\lt \vert {a\over b}-C_k\vert \lt \vert C_{k+1}-C_k\vert ={1\over q_{k+1}q_k}.<script type="math/tex"></script>
Multiplicando por <script type="math/tex">bq_k</script>, se obtiene
<script type="math/tex"></script>0\lt \vert aq_k-bp_k\vert \lt {b\over q_{k+1}},<script type="math/tex"></script>
lo que es absurdo, porque <script type="math/tex">aq_k-bp_k</script> es un entero y si <script type="math/tex">k</script>
es suficientemente grande se tendría <script type="math/tex">{b\over
q_{k+1}}\lt 1</script> (ya que <script type="math/tex">q_{k+1}</script> tiende a infinito).
\qed</p>

<p><b>DEFINICIÓN:</b> Se llama {\it valos de una fracción continua simple
infinita} al límite <script type="math/tex">\alpha</script> dado por el Teorema
\convergenciaconvergentes.</p>

<p><b>EJEMPLO:</b> {\convergentesfibonacci} Veamos ahora un ejemplo de
cálculo del valor de una fracción continua infinita.
Tomemos, por ejemplo, <script type="math/tex">[1;\bar1]</script>. Las sucesiones
<script type="math/tex">p_k,q_k</script> verifican
<script type="math/tex"></script>p_{-1}=1,\ p_0=1,\ p_k=p_{k-1}+p_{k-2}<script type="math/tex"></script>
<script type="math/tex"></script>q_0=1,\ q_1=1,\ q_k=q_{k-1}+q_{k-2},<script type="math/tex"></script>
por lo que <script type="math/tex">p_k=u_{k+2}</script> y
<script type="math/tex">q_k=u_{k+1}</script> (donde <script type="math/tex">u_n</script> es el <script type="math/tex">n</script>-ésimo número de
Fibonacci; ver Ejercicio \formulafibonacci). Se tiene
entonces <script type="math/tex">C_k={u_{k+2}\over u_{k+1}}</script>. Usando la fórmula
del Ejercicio \formulafibonacci\ para el <script type="math/tex">n</script>-ésimo
número de Fibonacci, es un simple ejercicio de Análisis
Matemático demostrar que
<script type="math/tex">\lim{u_{k+2}\over u_{k+1}}={1\over2}+{\sqrt5\over2}</script>. Sin
embargo, para fracciones continuas periódicas, hay un
truco más fácil para calcular su valor. Como el Teorema
\convergenciaconvergentes\ nos asegura que <script type="math/tex">[1;\bar1]</script> tiene
un valor <script type="math/tex">\alpha</script>, se tendrá la relación:
<script type="math/tex"></script>\alpha=1+{1\over 1+{1\over 1+{1\over
1+{1\over 1+\dots}}}}=1+{1\over \alpha},<script type="math/tex"></script>
por lo que debiera ser <script type="math/tex">\alpha^2-\alpha-1=0</script>, es decir,
<script type="math/tex">\alpha={1\over2}+{\sqrt5\over2}</script> (obviamente, debemos
tomar la solución positiva).</p>

<p>\bigskip</p>

<p>Tenemos entonces un modo de, a partir de un número
irracional, conseguir una fracción continua simple
infinita; y tenemos también un modo de, a partir de una
fracción continua simple infinita, darle un valor
irracional. Una pregunta natural es si ambos procesos son
inversos el uno del otro. Por ejemplo, se deja como ejercicio
al lector comprobar que la fracción continua asociada a
<script type="math/tex">{1\over2}+{\sqrt5\over2}</script> (ver el Ejemplo
\convergentesfibonacci) es precisamente
<script type="math/tex">[1;\bar1]</script>; de la misma forma, el valor de la fracción
continua <script type="math/tex">[1;\bar2]</script> (ver el Ejemplo \continuainfinita) es
<script type="math/tex">\sqrt2</script>. El resultado (afirmativo) general es el siguiente:</p>

<p>\proclaim Teorema \unicidadfraccion. Cada número irracional
<script type="math/tex">\alpha</script> es el valor de una y sólo una fracción continua
infinita simple, que es precisamente la fracción continua
asociada a <script type="math/tex">\alpha</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Supongamos primero que un número irracional <script type="math/tex">\alpha</script>
es el valor de las fracciones continuas simples
<script type="math/tex">[a_0;a_1,a_2,\dots]</script> y
<script type="math/tex">[a'_0;a'_1,a'_2,\dots]</script>. Entonces, por el Teorema
\convergenciaconvergentes, tendremos <script type="math/tex">C_0\lt \alpha\lt C_1</script>, es
decir <script type="math/tex">a_0\lt \alpha\lt a_0+{1\over a_1}</script>. Como <script type="math/tex">a_1\ge1</script>, se
tiene entonces <script type="math/tex">a_0=[\alpha]</script>, y de la misma forma
<script type="math/tex">a'_0=[\alpha]</script>, por lo que <script type="math/tex">a_0=a'_0</script>. Como se tiene
<script type="math/tex"></script>a_0+{1\over [a_1;a_2,a_3,\dots]}=
[a_0;a_1,a_2,\dots]=[a’_0;a’_1,a’_2,\dots]
=a’_0+{1\over [a’_1;a’_2,a’_3,\dots]}<script type="math/tex"></script>
se deduce <script type="math/tex">[a_1;a_2,a_3,\dots]=[a'_1;a'_2,a'_3,\dots]</script>, y
por un argumento de recurrencia se sigue <script type="math/tex">a'_k=a_k</script> para
todo
<script type="math/tex">k</script>.</p>

<p>Recíprocamente, dado un número irracional <script type="math/tex">\alpha</script>,
sea <script type="math/tex">[a_0;a_1,a_2,\dots]</script> su fracción continua asociada
(tomaremos la notación del Ejemplo \continuainfinita).
Es claro que, para todo <script type="math/tex">k</script>, se tiene
<script type="math/tex">\alpha=[a_0;a_1,a_2,\dots,a_k,\alpha_{k+1}]</script>. Entonces el
convergente <script type="math/tex">(k+1)</script>-ésimo de esta fracción continua
finita es <script type="math/tex">\alpha</script>, mientras que el convergente <script type="math/tex">k</script>-ésimo
es claramente el convergente <script type="math/tex">k</script>-ésimo <script type="math/tex">C_k</script> de
<script type="math/tex">[a_0;a_1,a_2,\dots]</script>. Por el Lema
\acotacionconvergentes\ aplicado a
<script type="math/tex">[a_0;a_1,a_2,\dots,a_k,\alpha_{k+1}]</script>, se tendrá entonces
<script type="math/tex"></script>\alpha-C_k={(-1)^k\over (\alpha_{k+1}q_k+q_{k-1})q_k},<script type="math/tex"></script>
donde hemos usado el Teorema \formulaconvergentes\ para
calcular el denominador del convergente <script type="math/tex">(k+1)</script>-ésimo.
Usando ahora las desigualdades <script type="math/tex">\alpha_{k+1}>a_{k+1}</script> y
<script type="math/tex">q_{k+1}>q_k</script> se tiene
<script type="math/tex"></script>\vert \alpha-C_k\vert ={1\over (\alpha_{k+1}q_k+q_{k-1})q_k}
\lt {1\over (a_{k+1}q_k+q_{k-1})q_k}={1\over
q_{k+1}q_k}\lt {1\over q_k^2}.<script type="math/tex"></script>
Como <script type="math/tex">q_k</script> tiende a infinito, se tiene que <script type="math/tex">\alpha=\lim
C_k</script>.
\qed</p>

<p><b>EJEMPLO:</b> {\continuaraizdetres} Aunque ya en el
Ejemplo \justificacioncontinua\ vimos cómo calcular la
fracción continua de <script type="math/tex">\sqrt2</script>, veamos que para
<script type="math/tex">\alpha=\sqrt3</script> pasa esencialmente lo mismo. Repetimos
entonces el proceso explicado en la demostración
anterior. Tendremos:
<script type="math/tex"></script>a_0=[\sqrt3]=1,\ \ \alpha_1={1\over
\sqrt3-1}={\sqrt3+1\over2}<script type="math/tex"></script>
<script type="math/tex"></script>a_1=[{\sqrt3+1\over2}]=1,\ \
\alpha_2={1\over{\sqrt3-1\over2}}={2\over
\sqrt3-1}=\sqrt3+1<script type="math/tex"></script>
<script type="math/tex"></script>a_2=[\sqrt3+1]=2,\ \
\alpha_2={1\over\sqrt3-1}={\sqrt3+1\over2}<script type="math/tex"></script>
de donde se sigue que <script type="math/tex">a_1=a_3=a_5=\dots=1</script> y
<script type="math/tex">a_2=a_4=a_6=\dots=2</script>, es decir,
<script type="math/tex">\sqrt3=[1;\overline{1,2}]</script>. De hecho, puede demostrarse
que para cada entero positivo <script type="math/tex">d</script> que no sea un cuadrado
perfecto, la fracción continua de <script type="math/tex">\sqrt d</script> es
periódica. Más aún, su representación se puede
escribir de la forma de la forma
<script type="math/tex">[a_0;\overline{a_1,a_2,a_3\dots a_3,a_2,a_1,2a_0}]</script> (es
decir, el último elemento del periodo es dos veces la
parte entera y el resto del periodo es simétrico).</p>

<p>\ejer{\continuae} Con la ayuda de una calculadora,
comprobar la validez de la fórmula (al menos en sus
primeros términos):
<script type="math/tex"></script>e=[2;1,2,1,1,4,1,1,6,1,1,8,\dots]<script type="math/tex"></script>
y utilizar la misma para calcular las diez primeras cifras
decimales de <script type="math/tex">e</script>.
\bigskip</p>

<p>\obs{\pellconvergentes} La demostración tanto del Lema
\acotacionconvergentes\ como del Teorema
\unicidadfraccion\ nos da el grado de aproximación de un
convergente a un número irracional <script type="math/tex">\alpha</script>, precisamente
<script type="math/tex">\vert \alpha-{p_k\over q_k}\vert \lt {1\over q_{k+1}q_k}\lt {1\over
q_k^2}</script>. Por otra parte, si una considera una solución
positiva
<script type="math/tex">x=p,y=q</script> de la ecuación de Pell <script type="math/tex">x^2-dy^2=1</script>, se tiene
<script type="math/tex">p^2=1+q^2d>q^2d</script>, de donde se deduce <script type="math/tex">p>q\sqrt d</script>. Por
tanto,
<script type="math/tex"></script>\vert {p\over q}-\sqrt d\vert ={1\over q}(p-q\sqrt d)=
{1\over q}{(p-q\sqrt d)(p+q\sqrt d)\over(p+q\sqrt d)}
={1\over q(p+q\sqrt d)}\lt {1\over2q^2\sqrt d}\lt {1\over2q^2}.<script type="math/tex"></script>
Cabe entonces preguntarse, ya que <script type="math/tex">p\over q</script> aproxima
<script type="math/tex">\sqrt d</script> como un convergente (incluso en principio
aún más), si eso no implicará que <script type="math/tex">p\over q</script> es
realmente un convergente. Si miramos por ejemplo el caso
<script type="math/tex">d=2</script> del Ejemplo
\continuainfinita, en que demostramos <script type="math/tex">\sqrt2=[1;\bar2]</script>
tenemos los siguientes valores:
<script type="math/tex"></script>p_0=1,\ p_1=3,\ p_2=7,\ p_3=17,\dots<script type="math/tex"></script>
<script type="math/tex"></script>q_0=1,\ q_1=2,\ q_2=5,\ q_3=12,\dots<script type="math/tex"></script>
Por tanto <script type="math/tex">(p_0,q_0)</script> y <script type="math/tex">(p_2,q_2)</script> son soluciones de la
ecuación <script type="math/tex">x^2-2y^2=1</script>, mientras que <script type="math/tex">(p_1,q_1)</script> y
<script type="math/tex">(p_3,q_3)</script> no son soluciones. De hecho, veremos que las
soluciones son convergentes, pero no todos los convergentes
son soluciones.</p>

<p>Para ver que un número racional que aproxima mucho a un
irracional es un convergente necesitaremos el siguiente
lema previo.</p>

<p><b>LEMA:</b>  \lemaaproximacionconvergentes. Sea <script type="math/tex">\alpha</script>
un número irracional, sea <script type="math/tex">p_k\over q_k</script> el convergente
<script type="math/tex">k</script>-ésimo de su fracción continua y sea
<script type="math/tex">q</script> un entero positivo tal que <script type="math/tex">q\lt q_{k+1}</script>. Entonces, para
todo entero <script type="math/tex">p</script> se tiene <script type="math/tex">\vert p_k-q_k\alpha\vert \le\vert p-q\alpha\vert</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Observamos en primer lugar que existen <script type="math/tex">x,y\in\mathbb{Z}</script> tales
que
<script type="math/tex"></script>\left{\eqalign{p_kx+p_{k+1}y=p\cr
q_kx+q_{k+1}y=q.}\right.<script type="math/tex"></script> 
En efecto, el determinante de la matriz de coeficientes
es, por el Teorema \formulaconvergentes(ii),
<script type="math/tex"></script>\left\vert \matrix{p_k&amp;p_{k+1}\cr q_k&amp;q_{k+1}}\right\vert 
=p_kq_{k+1}-p_{k+1}q_k=-(-1)^k=\pm1<script type="math/tex"></script>
luego existe una única solución del sistema anterior,
que es además entera.</p>

<p>Observamos también que <script type="math/tex">x\ne0</script>, ya que si fuera <script type="math/tex">x=0</script>,
entonces 
<script type="math/tex"></script>0=pq-qp=p(yq_{k+1})-q(yp_{k+1})=y(pq_{k+1}-qp_{k+1})<script type="math/tex"></script>
y como <script type="math/tex">y\ne0</script> (ya que <script type="math/tex">q\ne0</script>), se sigue
<script type="math/tex">pq_{k+1}=qp_{k+1}</script>. Ahora bien, <script type="math/tex">\text{mcd}(p_{k+1},q_{k+1})=1</script>,
luego <script type="math/tex">q_{k+1}\vert q</script>, lo que es absurdo porque <script type="math/tex">q\lt q_{k+1}</script>.</p>

<p>Comparemos ahora los signos de <script type="math/tex">x</script> e <script type="math/tex">y</script>. Si <script type="math/tex">y\lt 0</script>, entonces
<script type="math/tex"></script>q_kx=q-q_{k+1}y&gt;0<script type="math/tex"></script>
de donde se sigue <script type="math/tex">x>0</script>. Si en cambio <script type="math/tex">y>0</script>, entonces
<script type="math/tex">y\ge1</script> y se tiene
<script type="math/tex"></script>q_kx=q-q_{k+1}y\lt q_{k+1}-q_{k+1}y=q_{k+1}(1-y)\le0<script type="math/tex"></script>
y por tanto <script type="math/tex">x\lt 0</script>.</p>

<p>Usando lo anterior, tenemos
<script type="math/tex"></script>\vert p-q\alpha\vert =\vert (p_kx+p_{k+1}y)-(q_kx+q_{k+1}y)\alpha\vert 
=\vert x(p_k-q_k\alpha)+y(p_{k+1}+q_{k+1}\alpha)\vert .<script type="math/tex"></script>
Si supiéramos que
<script type="math/tex">\vert x(p_k-q_k\alpha)+y(p_{k+1}+q_{k+1}\alpha)\vert \ge\vert x(p_k-q_k\alpha)\vert</script>,
se concluiría inme-dia-ta-mente, ya que
<script type="math/tex"></script>\vert x(p_k-q_k\alpha)\vert =\vert x\vert \vert p_k-q_k\alpha\vert \ge\vert p_k-q_k\alpha\vert <script type="math/tex"></script>
(puesto que <script type="math/tex">x\ne0</script> y por tanto <script type="math/tex">\vert x\vert \ge1</script>). La desigualdad
<script type="math/tex">\vert x(p_k-q_k\alpha)+y(p_{k+1}+q_{k+1}\alpha)\vert \ge\vert x(p_k-q_k\alpha)\vert</script>
es inmediata si <script type="math/tex">y=0</script>, mientras que si <script type="math/tex">y\ne0</script> hay que
demostrar que <script type="math/tex">x(p_k-q_k\alpha)</script> e
<script type="math/tex">y(p_{k+1}-q_{k+1}\alpha)</script> tienen el mismo signo. Y esto es
así ya que, por una parte, hemos visto que <script type="math/tex">x</script> e
<script type="math/tex">y</script> tienen signos opuestos cuando <script type="math/tex">y\ne0</script>; y, por otra parte,
como
<script type="math/tex">\alpha</script> está siempre en medio de dos convergentes
consecutivos, los signos de
<script type="math/tex">{p_k\over q_k}-\alpha</script> y <script type="math/tex">{p_{k+1}\over q_{k+1}}-\alpha</script>
también son opuestos, es decir, <script type="math/tex">p_k-q_k\alpha</script> y
<script type="math/tex">p_{k+1}-q_{k+1}\alpha</script> tienen signos opuestos. Por tanto,
<script type="math/tex">x(p_k-q_k\alpha)</script> e <script type="math/tex">y(p_{k+1}-q_{k+1}\alpha)</script> tienen el
mismo signo, como queríamos.
\qed</p>

<p>Como primer corolario, podemos ver que el convergente
<script type="math/tex">k</script>-ésimo es la mejor aproximación de un número
irracional mediante un número racional de denominador
como mucho <script type="math/tex">q_k</script>:</p>

<p>\proclaim Corolario \convergentemejoraproximacion. Sea
<script type="math/tex">\alpha</script> un número irracional y sea
<script type="math/tex">p_k\over q_k</script> el convergente <script type="math/tex">k</script>-ésimo de su fracción
continua. Entonces, si <script type="math/tex">q\le q_k</script>, se tiene
<script type="math/tex">\vert {p_k\over q_k}-\alpha\vert \le\vert {p\over q}-\alpha\vert</script> para
cualquier entero <script type="math/tex">p</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Como <script type="math/tex">q_k\lt q_{k+1}</script>, se tiene, por el Lema
\lemaaproximacionconvergentes,
<script type="math/tex">\vert p_k-q_k\alpha\vert \le\vert p-q\alpha\vert</script> y por tanto
<script type="math/tex"></script>\vert {p_k\over q_k}-\alpha\vert ={\vert p_k-q_k\alpha\vert \over q_k}
\le{\vert p-q\alpha\vert \over q_k}\le{\vert p-q\alpha\vert \over q}=\vert {p\over
q}-\alpha\vert .<script type="math/tex"></script>
\qed</p>

<p>\proclaim Teorema \buenaaproximacionconvergente. Sea
<script type="math/tex">\alpha</script> un número irracional y sea <script type="math/tex">p\over q</script> un
número racional tal que <script type="math/tex">q>0</script>. Si <script type="math/tex">\left\vert \alpha-{p\over
q}\right\vert \lt {1\over2q^2}</script>, entonces <script type="math/tex">p\over q</script> es un
convergente de <script type="math/tex">\alpha</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Como <script type="math/tex">q_k</script> es una sucesión creciente de números
enteros, existirá <script type="math/tex">k</script> tal que <script type="math/tex">q_k\le q\lt q_{k+1}</script>. Veamos
entonces que <script type="math/tex">{p\over q}={p_k\over q_k}</script>. Si no fuera
así, entonces <script type="math/tex">pq_k-qp_k\ne0</script>, luego
<script type="math/tex">\vert pq_k-qp_k\vert \ge1</script>. Tendremos entonces, por una parte:
<script type="math/tex"></script>\left\vert {p\over q}-{p_k\over q_k}\right\vert ={\vert pq_k-qp_k\vert \over
qq_k}\ge{1\over qq_k}<script type="math/tex"></script>
y por otra parte, usando el  Lema
\lemaaproximacionconvergentes:
<script type="math/tex"></script>\left\vert {p\over q}-{p_k\over q_k}\right\vert \le
\left\vert {p\over q}-\alpha\right\vert +\left\vert \alpha-{p_k\over
q_k}\right\vert 
=\left\vert {p\over q}-\alpha\right\vert +{\vert p_k-q_k\alpha\vert \over
q_k}\le \left\vert {p\over q}-\alpha\right\vert +{\vert p-q\alpha\vert \over
q_k}=<script type="math/tex"></script>
<script type="math/tex"></script>=\left\vert {p\over q}-\alpha\right\vert +{q\over q_k}\left\vert {p\over
q}-\alpha\right\vert \lt {1\over2q^2}+{q\over q_k}{1\over2q^2}
={1\over2q^2}+{1\over2qq_k}.<script type="math/tex"></script>
Poniendo juntas las dos desigualdades se obtiene
<script type="math/tex"></script>{1\over qq_k}\lt {1\over2q^2}+{1\over2qq_k},<script type="math/tex"></script>
lo que implica <script type="math/tex">{1\over 2qq_k}\lt {1\over2q^2}</script>, que a su vez
implica <script type="math/tex">q\lt q_k</script>, lo que es una contradicción con la
elección de <script type="math/tex">k</script>.
\qed</p>

<p>\proclaim Corolario \solucionPellconvergente. Si <script type="math/tex">p,q</script> es
una solución positiva de
<script type="math/tex">x^2-dy^2=1</script>, entonces <script type="math/tex">p\over q</script> es un convergente de
<script type="math/tex">\sqrt d</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Por la Observación \pellconvergentes, 
<script type="math/tex">\vert {p\over q}-\sqrt d\vert \lt {1\over2q^2}</script>, lo que implica, por el
Teorema \buenaaproximacionconvergente, que <script type="math/tex">p\over q</script> es un
convergente de <script type="math/tex">\sqrt d</script>.
\qed</p>

<p>Necesitamos ver ahora qué convergentes de <script type="math/tex">\alpha=\sqrt d</script>
son soluciones de la ecuación de Pell. Por la
construcción por recurrencia del Ejemplo
\continuainfinita, está claro que cada
<script type="math/tex">\alpha_k</script> se puede escribir en función de <script type="math/tex">\sqrt d</script>. El
siguiente resultado nos dará una fórmula precisa, en
que lo fundamental es que el coeficiente de <script type="math/tex">\sqrt d</script> en el
numerador es <script type="math/tex">1</script>:</p>

<p><b>LEMA:</b>  \aproximacionesraizded. Sea <script type="math/tex">\alpha=\sqrt
d</script> y, para cada <script type="math/tex">k\ge0</script>, sea <script type="math/tex">\alpha_k</script> definido como en el
Ejemplo \continuainfinita. Entonces, definiendo por
recurrencia <script type="math/tex">s_0=0,t_0=1</script>, 
<script type="math/tex"></script>s_{k+1}=a_kt_k-s_k<script type="math/tex"></script>
<script type="math/tex"></script>t_{k+1}={d-(a_kt_k-s_k)^2\over t_k}={d-s_{k+1}^2\over
t_k}<script type="math/tex"></script>
se puede escribir <script type="math/tex">\alpha_k={s_k+\sqrt d\over t_k}</script>, y
además <script type="math/tex">s_k</script> y <script type="math/tex">t_k</script> son enteros y <script type="math/tex">t_k\ne0</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Lo demostramos por inducción sobre <script type="math/tex">k</script>, siendo claro
el caso <script type="math/tex">k=0</script>. Si ahora suponemos
<script type="math/tex">\alpha_k={s_k+\sqrt d\over t_k}</script> con <script type="math/tex">s_k</script> y <script type="math/tex">t_k</script> 
enteros y <script type="math/tex">t_k\ne0</script>, entonces tenemos
<script type="math/tex"></script>\alpha_{k+1}={1\over\alpha_k-a_k}
={1\over{s_k+\sqrt d\over t_k}-a_k}=<script type="math/tex"></script>
<script type="math/tex"></script>={t_k\over s_k+\sqrt d-a_kt_k}={t_k(\sqrt
d-s_k+a_kt_k)\over(\sqrt d+s_k-a_kt_k)(\sqrt
d-s_k+a_kt_k)}=<script type="math/tex"></script>
<script type="math/tex"></script>={t_k(a_kt_k-s_k+\sqrt d)\over
d-(a_kt_k-s_k)^2} ={a_kt_k-s_k+\sqrt d\over
{d-(a_kt_k-s_k)^2\over t_k}}={s_{k+1}+\sqrt d\over
t_{k+1}}.<script type="math/tex"></script>
Es claro que <script type="math/tex">s_{k+1}</script> es entero por serlo
<script type="math/tex">a_k,s_k,t_k</script>. Por otra parte, si escribimos
<script type="math/tex"></script>t_{k+1}={d-s_{k+1}^2\over t_k}={d-(a_kt_k-s_k)^2\over t_k}
={d-s_k^2\over
t_k}-a_k^2t_k+2a_ks_k=t_{k-1}-a_k^2t_k+2a_ks_k<script type="math/tex"></script>
se obtiene que <script type="math/tex">t_{k+1}</script> es entero (en realidad, como
estamos usando que <script type="math/tex">t_{k-1}</script> es entero, habría que
demostrar también el caso <script type="math/tex">k=1</script> de la inducción, pero al
ser <script type="math/tex">t_0=1</script> es evidente que <script type="math/tex">t_1</script> es entero).
\qed</p>

<p><b>LEMA:</b> \convergentesderaizded. Con las
notaciones del Lema \aproximacionesraizded, se tiene:
\item{(i)} Si <script type="math/tex">p_k\over q_k</script> es el convergente
<script type="math/tex">k</script>-ésimo de <script type="math/tex">\sqrt d</script>, entonces
<script type="math/tex">p_k^2-dq_k^2=(-1)^{k+1}t_{k+1}</script>. 
\item{(ii)} <script type="math/tex">t_k>0</script> para todo <script type="math/tex">k\ge0</script>.
\item{(iii)} Existen enteros <script type="math/tex">t,s</script> tales que <script type="math/tex">t_k=t</script> y
<script type="math/tex">s_k=s</script> para infinitos valores de <script type="math/tex">k</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Escribiendo <script type="math/tex">\sqrt d=[a_0;a_1,\dots,a_k,\alpha_{k+1}]</script>,
sabemos que coincide con su convergente <script type="math/tex">(k+1)</script>-ésimo, y
por el Teorema \formulaconvergentes\ tendremos 
<script type="math/tex"></script>\sqrt d
={\alpha_{k+1}p_k+p_{k-1}\over\alpha_{k+1}q_k+q_{k-1}}
={ {s_{k+1}+\sqrt d\over
t_{k+1}}p_k+p_{k-1}\over{s_{k+1}+\sqrt d\over
t_{k+1}}q_k+q_{k-1}}
={s_{k+1}p_k+t_{k+1}p_{k-1}+p_k\sqrt d\over 
s_{k+1}q_k+t_{k+1}q_{k-1}+q_k\sqrt d}<script type="math/tex"></script>
Por tanto
<script type="math/tex"></script>(s_{k+1}p_k+t_{k+1}p_{k-1})+p_k\sqrt d
=(s_{k+1}q_k+t_{k+1}q_{k-1}+q_k\sqrt d)\sqrt d
=dq_k+(s_{k+1}q_k+t_{k+1}q_{k-1})\sqrt d<script type="math/tex"></script>
lo que implica
<script type="math/tex"></script>\left{\eqalign{
p_k=&amp;s_{k+1}q_k+t_{k+1}q_{k-1}\cr
dq_k=&amp;s_{k+1}p_k+t_{k+1}p_{k-1}
}\right.<script type="math/tex"></script>
Usando estas igualdades junto con el Teorema
\formulaconvergentes(ii) tendremos
<script type="math/tex"></script>p_k^2-dq_k^2
=p_k(s_{k+1}q_k+t_{k+1}q_{k-1})-q_k(s_{k+1}p_k+t_{k+1}p_{k-1})
=<script type="math/tex"></script>
<script type="math/tex"></script>=t_{k+1}(p_kq_{k-1}-p_{k-1}q_k)=(-1)^{k-1}t_{k+1}<script type="math/tex"></script>
lo que prueba (i).</p>

<p>Demostremos (ii) por inducción sobre <script type="math/tex">k</script>. Es evidente para
<script type="math/tex">k=0</script>, ya que, por definición, <script type="math/tex">t_0=1</script>. Supongamos
entonces que sabemos <script type="math/tex">t_k>0</script> y demostremos <script type="math/tex">t_{k+1}>0</script>. 
Por (i), tendremos
<script type="math/tex"></script>{t_{k+1}\over t_k}
=-{p_{k+1}^2-dq_{k+1}^2\over p_k^2-dq_k^2}.<script type="math/tex"></script>
El signo del numerador es igual al signo de 
<script type="math/tex"></script>{p_{k+1}^2-dq_{k+1}^2\over q_{k+1}^2}=C_{k+1}^2-d<script type="math/tex"></script>
que es el signo de <script type="math/tex">C_{k+1}-\sqrt d</script>. Análogamente, el
signo del denominador es el signo <script type="math/tex">C_k-\sqrt d</script>. Como por
el Teorema \convergenciaconvergentes\ los signos de
<script type="math/tex">C_{k+1}-\sqrt d</script> y <script type="math/tex">C_k-\sqrt d</script> son distintos, se sigue
que <script type="math/tex">t_{k+1}\over t_k</script> tiene signo positivo, y como <script type="math/tex">t_k</script>
es positivo entonces también <script type="math/tex">t_{k+1}</script> es positivo. Esto
demuestra (ii).</p>

<p>Para demostrar (iii), basta recordar la igualdad
<script type="math/tex">t_kt_{k+1}+s_k^2=d</script> y, al ser <script type="math/tex">t_k,t_{k+1}>0</script> por (ii), se
tendrá <script type="math/tex">1\le t_k\le d</script> y <script type="math/tex">\vert s_k\vert \lt \sqrt d</script>. Por tanto, hay
una cantidad finita de posibles valores para los pares
<script type="math/tex">(t_k,s_k)</script>, por lo que necesariamente alguno se debe
repetir infinitas veces.
\qed</p>

<p>\obs{\continuaraizdedperiodica} Nótese que la parte (i) de
la Proposición \convergentesderaizded\ indica que la
ecuación de Pell <script type="math/tex">x^2-dy^2=1</script> tiene solución (ya
sabemos por el Teorema \buenaaproximacionconvergente\ que
necesariamente debe ser un convergente <script type="math/tex">p_k\over q_k</script>) si y
sólo si existe algún <script type="math/tex">k\in\mathbb{Z}</script> para el que <script type="math/tex">t_{k+1}=1</script>
(recuérdese que
<script type="math/tex">t_{k+1}>0</script> por la parte (ii)). Esto es equivalente a decir
<script type="math/tex">\alpha_{k+1}=s_{k+1}+\sqrt{d}</script>, es decir,
<script type="math/tex">a_{k+1}=[\alpha_{k+1}]=s_{k+1}+[\sqrt{d}]</script> y
<script type="math/tex">\alpha_{k+2}={1\over\alpha_{k+1}-a_{k+1}}
={1\over\sqrt{d}-[\sqrt{d}]}=\alpha_1</script>. Por tanto, los datos
de la fracción continua se deben repetir después de <script type="math/tex">k+1</script>
pasos, por lo que debe ser
<script type="math/tex">\sqrt{d}=[a_0;\overline{a_1,a_2,\dots,a_{k+1}}]</script>.</p>

<p>De momento, la parte (iii) de la Proposición
\convergentesderaizded\ garantiza sólo que 
existen <script type="math/tex">k,l</script> tales que <script type="math/tex">t_{k+l}=t_k</script> y
<script type="math/tex">s_{k+l}=s_k</script>, y por tanto <script type="math/tex">\alpha_{k+l}=\alpha_k</script>. De
aquí se deduce que <script type="math/tex">a_{k'+l}=a_{k'}</script> para
todo <script type="math/tex">k'\ge k</script>, y lo que
faltaría ver es que se puede tomar <script type="math/tex">k=1</script>.</p>

<p><b>LEMA:</b>  \fraccionconjugada. Para cada <script type="math/tex">k\ge1</script>,
definimos <script type="math/tex">\beta_k</script> mediante la recurrencia
<script type="math/tex">\beta_1=a_0+\sqrt{d}</script> y 
<script type="math/tex">\beta_{k+1}=a_k+{1\over\beta_k}</script>. Entonces:
\item{(i)} <script type="math/tex">\beta_k>1</script> (y por tanto <script type="math/tex">[\beta_{k+1}]=a_k</script>).
\item{(ii)}
<script type="math/tex">\beta_k={t_k\over\sqrt{d}-s_k}={s_k+\sqrt{d}\over
t_{k-1}}</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Para demostrar (i), usamos inducción sobre <script type="math/tex">k</script>,
siendo evidente el caso <script type="math/tex">k=1</script>. Si suponemos ahora
<script type="math/tex">\beta_k>1</script>, entonces <script type="math/tex">{1\over\beta_k}>0</script>, y como <script type="math/tex">a_k\ge1</script>,
de la fórmula de recurrencia
<script type="math/tex">\beta_{k+1}=a_k+{1\over\beta_k}</script> se sigue
<script type="math/tex">\beta_{k+1}>1</script>.</p>

<p>Para demostrar (ii), observamos primero que, por el Lema
\aproximacionesraizded, tenemos: 
<script type="math/tex"></script>{t_k\over\sqrt{d}-s_k}=
{t_k(\sqrt{d}+s_k)\over(\sqrt{d}-s_k)(\sqrt{d}+s_k)}
={t_k(s_k+\sqrt{d})\over d-s_k^2}=
{t_k(s_k+\sqrt{d})\over t_kt_{k-1}}={s_k+\sqrt{d}\over
t_{k-1}}<script type="math/tex"></script>
por lo que basta ver que <script type="math/tex">\beta_k</script> coincide con uno
cualquiera de los dos valores. Lo demostramos por
inducción sobre. Si <script type="math/tex">k=1</script>, recordando del
Lema \aproximacionesraizded\ las igualdades
<script type="math/tex">s_0=0</script>, <script type="math/tex">t_0=1</script> y <script type="math/tex">s_1=a_0t_0-s_0=a_0</script>, tenemos
inmediatamente
<script type="math/tex">\beta_1=a_0+\sqrt{d}={s_1+\sqrt{d}\over t_0}</script>. Supongamos
ahora demostrado <script type="math/tex">\beta_k={t_k\over\sqrt{d}-s_k}</script> y
demostremos la fórmula para <script type="math/tex">k+1</script>. Para ello, aplicamos de
nuevo el Lema \aproximacionesraizded\ y tendremos:
<script type="math/tex"></script>\beta_{k+1}=a_k+{1\over\beta_k}=a_k+{\sqrt{d}-s_k\over
t_k} ={(a_kt_k-s_k)+\sqrt{d}\over t_k}
={s_{k+1}+\sqrt{d}\over t_k}.<script type="math/tex"></script>
\qed</p>

<p>\proclaim Teorema \fraccionraiz. Si un entero positivo <script type="math/tex">d</script>
no es un cuadrado perfecto, entonces su fracción continua
tiene la forma
<script type="math/tex">\sqrt d=[a_0;\overline{a_1,a_2,a_3\dots
a_3,a_2,a_1,2a_0}]</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Como ya vimos en la Observación
\continuaraizdedperiodica, existirán <script type="math/tex">k,l</script> tales que
<script type="math/tex">t_{k+l}=t_k</script> y <script type="math/tex">s_{k+l}=s_k</script>. Veamos en primer lugar que
podemos tomar <script type="math/tex">k=1</script>. En efecto, si <script type="math/tex">k>1</script>, por la parte (ii)
del Lema \fraccionconjugada\ tendremos <script type="math/tex">\beta_{k+l}=\beta_k</script>,
mientras que la parte (i) implica entonces
<script type="math/tex">a_{k+l-1}=[\beta_{k+l}]=[\beta_k]=a_{k-1}</script>. Como también
tenemos
<script type="math/tex"></script>{1\over\alpha_{k+l-1}-a_{k+l-1}}=\alpha_{k+l}
=\alpha_k={1\over\alpha_{k-1}-a_{k-1}}<script type="math/tex"></script> 
se concluye <script type="math/tex">\alpha_{k+l-1}=\alpha_{k-1}</script>, es decir,
<script type="math/tex">t_{k+l-1}=t_{k-1}</script> y <script type="math/tex">s_{k+l-1}=s_{k-1}</script>. Reiterando el
proceso, llegaremos a <script type="math/tex">t_{l+1}=t_1</script> y <script type="math/tex">s_{l+1}=s_1</script>. Esto
quiere decir que <script type="math/tex">\alpha_{l+1}=\alpha_1</script>, lo que implica que
tendremos
<script type="math/tex"></script>\sqrt d=[a_0;\overline{a_1,a_2,\dots a_l}].<script type="math/tex"></script>
Por otra parte, podemos escribir:
<script type="math/tex"></script>\beta_1=\beta_{l+1}=a_l+{1\over\beta_l}=
a_l+{1\over a_{l-1}+{1\over\beta_{l-1}}}=\dots=
a_l+{1\over a_{l-1}+{1\over a_{l-2}+{1\over
\ddots{1\over a_2+{1\over
a_1+{1\over\beta_1}}}}}}<script type="math/tex"></script>
de donde se deduce 
<script type="math/tex">\beta_1=[\overline{a_l;a_{l-1},a_{l-2}\dots,a_1}]</script>, o
equivalentemente
<script type="math/tex"></script>\beta_1=[a_l;\overline{a_{l-1},a_{l-2}\dots,a_1,a_l}].<script type="math/tex"></script>
Por otra parte tenemos también
<script type="math/tex"></script>\beta_1=a_0+\sqrt{d}=a_0+[a_0;\overline{a_1,a_2,\dots
a_l}]=[2a_0;\overline{a_1,a_2,\dots a_l}].<script type="math/tex"></script>
Comparando ambas expresiones se obtiene el resultado.
\qed</p>

<p>En realidad, no nos va a interesar el aspecto simétrico
que tiene el periodo, sino simplemente saber que empieza en
<script type="math/tex">a_1</script> y qué longitud tiene.</p>

<p><b>DEFINICIÓN:</b> Llamaremos {\it longitud del periodo de
<script type="math/tex">\sqrt{d}</script>} al mínimo
entero positivo <script type="math/tex">r</script> para el que podemos escribir
<script type="math/tex">\sqrt d=[a_0;\overline{a_1,\dots,a_r}]</script>.</p>

<p>\proclaim Teorema \periodoraizded. Si el periodo de
<script type="math/tex">\sqrt{d}</script> tiene longitud <script type="math/tex">r</script>, entonces <script type="math/tex">t_k=1</script> si y sólo
si <script type="math/tex">r\vert k</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Como <script type="math/tex">\sqrt d=[a_0;\overline{a_1,\dots,a_r}]</script>, se
sigue <script type="math/tex">\alpha_{ir+1}=\alpha_1</script> para todo <script type="math/tex">i</script>, es decir,
<script type="math/tex"></script>{1\over\alpha_{ir}-a_{ir}}={1\over\sqrt d-a_0}.<script type="math/tex"></script>
De aquí sigue, junto con el Lema
\aproximacionesraizded,
<script type="math/tex"></script>\sqrt d-a_0=\alpha_{ir}-a_{ir}={s_{ir}+\sqrt d\over
t_{ir}}-a_{ir}<script type="math/tex"></script>
luego quitando denominadores queda
<script type="math/tex"></script>(t_{ir}-1)\sqrt d=s_{ir}-a_{ir}t_{ir}+a_0t_{ir},<script type="math/tex"></script>
de donde deducimos <script type="math/tex">t_{ir}=1</script> para todo <script type="math/tex">i</script>, es decir, que
<script type="math/tex">t_k=1</script> si <script type="math/tex">r\vert k</script>.</p>

<p>Supongamos ahora <script type="math/tex">t_k=1</script>. Por tanto, por el Lema
\aproximacionesraizded\ se tendrá <script type="math/tex">\alpha_k=s_k+\sqrt d</script>,
y tomando parte entera se sigue
<script type="math/tex"></script>a_k=[\alpha_k]=s_k+[\sqrt d]=s_k+a_0.<script type="math/tex"></script>
Por tanto, 
<script type="math/tex"></script>\alpha_{k+1}={1\over\alpha_k-a_k}
={1\over(s_k+\sqrt d)-(s_k+a_0)}={1\over\sqrt
d-a_0}=\alpha_1<script type="math/tex"></script>
y por tanto el bloque <script type="math/tex">a_1,\dots,a_k</script> se repite
periódicamente en la fracción continua de <script type="math/tex">\sqrt d</script>, es
decir, <script type="math/tex">r\vert k</script>.
\qed</p>

<p>El resultado final es entonces el siguiente:</p>

<p>\proclaim Teorema \solucionesPell. Si el periodo de
<script type="math/tex">\sqrt{d}</script> tiene longitud <script type="math/tex">r</script>, entonces las soluciones positivas de la
ecuación de Pell
<script type="math/tex">x^2-dy^2=1</script> son:
\item{(i)} Si <script type="math/tex">r</script> es par, <script type="math/tex">x=p_{ir-1}</script>, <script type="math/tex">y=q_{ir-1}</script>.
\item{(ii)} Si <script type="math/tex">r</script> es impar, <script type="math/tex">x=p_{2ir-1}</script>, <script type="math/tex">y=q_{2ir-1}</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Por el Corolario \solucionPellconvergente, las posibles
soluciones de la ecuación de Pell son de la forma
<script type="math/tex">x=p_k</script>, <script type="math/tex">y=q_k</script> donde <script type="math/tex">p_k\over q_k</script> es un convergente de
<script type="math/tex">\sqrt d</script>. Por la Proposición \convergentesderaizded,
<script type="math/tex">x^2-dy^2=(-1)^{k+1}t_{k+1}</script>, por lo que debe ser
<script type="math/tex">(-1)^{k+1}t_{k+1}=1</script>. Como además <script type="math/tex">t_{k+1}</script> es positivo,
<script type="math/tex">x=p_k</script>, <script type="math/tex">y=q_k</script> es una solución de la ecuación si y
sólo si <script type="math/tex">k</script> impar y <script type="math/tex">t_{k+1}=1</script>. Por el Teorema
\periodoraizded, esto es equivalente a que <script type="math/tex">k</script> sea impar y
<script type="math/tex">r\vert k+1</script>. Distinguimos ahora dos casos:</p>

<p>–Si <script type="math/tex">r</script> es par, entonces la condición <script type="math/tex">r\vert k+1</script> ya implica
que <script type="math/tex">k</script> es impar, luego <script type="math/tex">x=p_k</script>, <script type="math/tex">y=q_k</script> es una solución
de la ecuación si y sólo si se puede escribir <script type="math/tex">k=ir-1</script>.</p>

<p>–Si <script type="math/tex">r</script> es impar, la condición <script type="math/tex">r\vert k+1</script> equivale a que se
pueda escribir <script type="math/tex">k=i'r-1</script>, y que <script type="math/tex">k</script> sea impar equivale
ahora a que <script type="math/tex">i'</script> es par, luego se puede escribir <script type="math/tex">k=2ir-1</script>.
\qed</p>
