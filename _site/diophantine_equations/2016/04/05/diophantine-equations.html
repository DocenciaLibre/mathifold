<p>Se llama {\it ecuación diofántica} a una ecuación
cuyas variables son números enteros. La más conocida es
la llamada {\it ecuación de Fermat}, que es
<script type="math/tex">x^n+y^n=z^n</script>. Fermat aseguró que, si <script type="math/tex">n\ge3</script>, las
únicas posibles soluciones son aquéllas en que alguno
de los <script type="math/tex">x,y,z</script> es cero. Este resultado, conocido como {\it
'Ultimo Teorema de Fermat}, ha sido demostrado sólo
recientemente por Wiles. En esta sección estudiaremos los
casos más sencillos de esta ecuación, así como
otras ecuaciones diofánticas similares.</p>

<p>Empezamos con el caso <script type="math/tex">n=2</script>, que no entra dentro del
'Ultimo Teorema de Fermat, ya que en este caso sí
que existe solución, y de hecho infinitas, como
demostraremos enseguida, viendo qué estructura tienen.</p>

<p><b>DEFINICIÓN:</b> Se llama {\it terna pitagórica} al conjunto de tres
enteros <script type="math/tex">x,y,z</script> tales que <script type="math/tex">x^2+y^2=z^2</script>. El nombre viene
dado porque, si <script type="math/tex">x,y,z>0</script> forman una terna pitagórica, por
el teorema de Pitágoras existe un triángulo rectángulo
que tiene a <script type="math/tex">x</script> e <script type="math/tex">y</script> como longitudes de sus catetos y a
<script type="math/tex">z</script> como longitud de la hipotenusa. Un triángulo así
(es decir, rectángulo con las longitudes de los lados
enteras) se llama {\it triángulo pitagórico}.</p>

<p><b>LEMA:</b>  \text{mcd}ternaspitagoricas. Sea <script type="math/tex">x,y,z</script> una terna
pitagórica y <script type="math/tex">d=\text{mcd}(x,y,z)</script>. Entonces:
\item{(i)} <script type="math/tex">d=\text{mcd}(x,y)=\text{mcd}(x,z)=\text{mcd}(y,z)</script>.
\item{(ii)} Si escribimos <script type="math/tex">x=dx'</script>, <script type="math/tex">y=dy'</script>, <script type="math/tex">z=dz'</script>,
entonces <script type="math/tex">x',y',z'</script> es una terna pitagórica.</p>

<p><b>DEMOSTRACIÓN:</b>  De (i) demostraremos sólo <script type="math/tex">d=\text{mcd}(x,y)</script>,
siendo idénticas las demostraciones de las otras
igualdades. Sea
<script type="math/tex">d=\text{mcd}(x,y)</script>. Es evidente que <script type="math/tex">\text{mcd}(x,y,z)</script> divide a <script type="math/tex">d</script>,
por lo que basta demostrar que <script type="math/tex">d</script> divide a <script type="math/tex">\text{mcd}(x,y,z)</script>.
Para ello, observamos que <script type="math/tex">d\vert x</script> y <script type="math/tex">d\vert y</script> implica <script type="math/tex">d^2\vert x^2</script> y
<script type="math/tex">d^2\vert y^2</script>. Por tanto, <script type="math/tex">d^2\vert x^2+y^2=z^2</script>, de donde se deduce
<script type="math/tex">d\vert z</script> (por el Teorema \raicesirracionales). De aquí se
concluye <script type="math/tex">d\vert \text{mcd}(x,y,z)</script>.</p>

<p>La parte (ii) es inmediata.
\qed</p>

<p><b>DEFINICIÓN:</b> Una terna pitagórica se dice que es primitiva si
<script type="math/tex">\text{mcd}(x,y,z)=1</script>, o equivalentemente cualquiera de los
<script type="math/tex">\text{mcd}(x,y)</script>, <script type="math/tex">\text{mcd}(x,z)</script>, <script type="math/tex">\text{mcd}(y,z)</script> es <script type="math/tex">1</script>.</p>

<p><b>LEMA:</b>  \paridadternaspitagoricas. Sea <script type="math/tex">x,y,z</script> una
terna pitagórica primitiva. Entonces entre <script type="math/tex">x,y,z</script> hay
exactamente un número par, que es o bien <script type="math/tex">x</script> o bien <script type="math/tex">y</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Es evidente que entre <script type="math/tex">x,y,z</script> hay exactamente un
número par. Si fuera <script type="math/tex">z</script>, entonces <script type="math/tex">xx,y</script> serían
impares, luego <script type="math/tex">x^2,y^2\equiv1\ (\text{mod }8)</script>, luego
<script type="math/tex">z^2=x^2+y^2\equiv2\ (\text{mod }8)</script>, lo que es absurdo, porque
<script type="math/tex">z^2</script> debe ser divisible por <script type="math/tex">4</script>.
\qed</p>

<p>\proclaim Teorema \ternaspitagoricasprimitivas. Sea
<script type="math/tex">x,y,z</script> una terna pitagórica primitiva con <script type="math/tex">x,y,z>0</script> y
<script type="math/tex">x</script> par. Entonces existen <script type="math/tex">s,t\in\mathbb{Z}</script> tales que <script type="math/tex">0\lt t\lt s</script>,
<script type="math/tex">\text{mcd}(s,t)=1</script>, <script type="math/tex">s\not\equiv t\ (\text{mod }2)</script> y
<script type="math/tex"></script>\left{\eqalign{
x=&amp;2st\cr
y=&amp;s^2-t^2\cr
z=&amp;s^2+t^2
}\right.<script type="math/tex"></script></p>

<p><b>DEMOSTRACIÓN:</b>  Observamos en primer lugar que <script type="math/tex">\text{mcd}(z+y,z-y)=2</script>. En
efecto, cualquier divisor común de <script type="math/tex">z+y</script> y <script type="math/tex">z-y</script> lo es
también de su suma y su diferencia, es decir, de <script type="math/tex">2z</script> y
<script type="math/tex">2y</script> Como <script type="math/tex">\text{mcd}(y,z)=1</script>, se sigue el único posible divisor
común de <script type="math/tex">z+y</script> y <script type="math/tex">z-y</script> es <script type="math/tex">2</script>, que efectivamente es un
divisor, ya que <script type="math/tex">y,z</script> son impares. Podemos escribir entonces
<script type="math/tex">z+y=2a</script> y <script type="math/tex">z-y=2b</script>, con <script type="math/tex">a,b</script> enteros tales que
<script type="math/tex">\text{mcd}(a,b)=1</script>. Por tanto
<script type="math/tex"></script>\left{\eqalign{
y=a-b\cr
z=a+b
}\right.<script type="math/tex"></script>
Obsérvese que, como <script type="math/tex">y\lt \sqrt{x^2+y^2}=z</script>, entonces <script type="math/tex">b>0</script> y,
como <script type="math/tex">y>0</script>, también <script type="math/tex">a>b</script>. Por otra parte, como <script type="math/tex">x</script> es par,
podemos escribir <script type="math/tex">x=2c</script>. De la igualdad
<script type="math/tex">x^2=z^2-y^2=(z+y)(z-y)</script> se deduce entonces
<script type="math/tex">c^2=ab</script>, luego, por el Corolario \divisoresproducto(ii),
existen enteros positivos <script type="math/tex">s,t</script> tales que <script type="math/tex">a=s^2</script> y <script type="math/tex">b=t^2</script>
(y por tanto <script type="math/tex">x=2st</script>, <script type="math/tex">y=s^2-t^2</script> y <script type="math/tex">z=s^2+t^2</script>). Como
<script type="math/tex">\text{mcd}(a,b)=1</script>, necesariamente <script type="math/tex">\text{mcd}(s,t)=1</script> y, como <script type="math/tex">a>b</script>,
será <script type="math/tex">s>t</script>. Finalmente,como ni <script type="math/tex">y</script> ni <script type="math/tex">z</script> son pares,
necesariamente <script type="math/tex">s</script> y <script type="math/tex">t</script> tienen distinta paridad.
\qed</p>

<p>%\proclaim Corolario \radiotriangulospitagoricos. El radio
%de la circunferencia inscrita enun triángulo pitagórico
%es un número entero.</p>

<p>%El radio es <script type="math/tex">x+y-z\over2</script></p>

<p>\proclaim Teorema \exponentescuatrocuatrodos. La ecuación
<script type="math/tex">x^4+y^4=z^2</script> no tiene solución entera positiva.</p>

<p><b>DEMOSTRACIÓN:</b>  Sea <script type="math/tex">S</script> el conjunto de los enteros positivos <script type="math/tex">z</script> para
los que existen <script type="math/tex">x,y>0</script> tales que
<script type="math/tex">z^2=x^4+y^4</script>. Supongamos, por reducción al absurdo, que
la ecuación <script type="math/tex">x^4+y^4=z^2</script> tiene solución entera
positiva. Esto quiere decir que el conjunto
<script type="math/tex">S</script> es no vacío, y por el principio del buen orden
existirá un elemento mínimo de <script type="math/tex">S</script>. Sea
pues una solución <script type="math/tex">x,y,z</script> con <script type="math/tex">S</script>
mínimo en <script type="math/tex">S</script>. Los enteros
<script type="math/tex">x^2,y^2,z</script> forman entonces una terna pitagórica, que
veremos a continuación que es primitiva. En efecto, si
<script type="math/tex">\text{mcd}(x^2,y^2)\ne1</script>, entonces <script type="math/tex">\text{mcd}(x,y)=d>1</script>. Si
escribimos <script type="math/tex">x=dx'</script>, <script type="math/tex">y=dy'</script>, entonces <script type="math/tex">d^4\vert x^4+y^4=z^2</script>,
luego <script type="math/tex">d^2\vert z</script> y podremos escribir <script type="math/tex">z=d^2z'</script>, con
<script type="math/tex">z'\in\mathbb{Z}_{\ge1}</script>. Entonces, haciendo esas sustituciones en
la igualdad
<script type="math/tex">x^4+y^4=z^2</script> queda <script type="math/tex">d^4x'^4+d^4y'^4=d^4z'^2</script>, de donde se
deduce <script type="math/tex">x'^4+y'^4=z'^2</script>. Por tanto, <script type="math/tex">z'\in S</script>, lo que es
imposible porque <script type="math/tex">z'\lt dz'=z</script> y <script type="math/tex">z</script> era mínimo en <script type="math/tex">S</script>.</p>

<p>Sin pérdida de generalidad, podemos suponer que <script type="math/tex">x^2</script> es
par e <script type="math/tex">y^2,z</script> impares. Por el Teoorema
\ternaspitagoricasprimitivas, se tendrá que existen
<script type="math/tex">s,t</script> enteros positivos primos entre sí y de distinta
paridad tales que 
<script type="math/tex"></script>\left{\eqalign{
x^2=&amp;2st\cr
y^2=&amp;s^2-t^2\cr
z=&amp;s^2+t^2
}\right.<script type="math/tex"></script>
En particular, <script type="math/tex">t^2+y^2=s^2</script>, luego <script type="math/tex">t,y,s</script> es también una
terna pitagórica primitiva y además necesariamente <script type="math/tex">s</script>
es impar y <script type="math/tex">t</script> es par. Usando de nuevo  el Teorema
\ternaspitagoricasprimitivas, concluimos que  podemos
encontrar <script type="math/tex">u,v</script> primos entre sí y de distinta paridad
tales que
<script type="math/tex"></script>\left{\eqalign{
t=&amp;2uv\cr
y=&amp;u^2-v^2\cr
s=&amp;u^2+v^2
}\right.<script type="math/tex"></script>
Como <script type="math/tex">s</script> es impar, <script type="math/tex">\text{mcd}(2t,s)=1</script>, luego de la igualdad
<script type="math/tex">x^2=(2t)s</script> y del Corolario \divisoresproducto(ii) deducimos
que existen <script type="math/tex">t',s'\in\mathbb{Z}_{\ge1}</script> tales que
<script type="math/tex"></script>\left{\eqalign{
2t=&amp;(2t’)^2\cr
s=&amp;s’^2
}\right.<script type="math/tex"></script>
Finalmente, haciendo la sustitución <script type="math/tex">t=2t'^2</script> en la
igualdad <script type="math/tex">t=2uv</script> llegamos a <script type="math/tex">t'^2=uv</script>, y usando de nuevo el
Corolario \divisoresproducto(ii) y <script type="math/tex">\text{mcd}(u,v)=1</script>, obtenemos
que existen <script type="math/tex">u',v'\in\mathbb{Z}_{\ge1}</script> tales que 
<script type="math/tex"></script>\left{\eqalign{
u=&amp;u’^2\cr
v=&amp;v’^2
}\right.<script type="math/tex"></script>
Por tanto, la igualdad <script type="math/tex">s=u^2+v^2</script> se convierte en
<script type="math/tex">s'^2=u'^4+v'^4</script>, luego <script type="math/tex">s'\in S</script>. La desigualdad 
<script type="math/tex"></script>s’\le s’^2=s\le s^2\lt s^2+t^2=z<script type="math/tex"></script>
produce entonces una contradicción con el hecho de que
<script type="math/tex">z</script> era mínimo en <script type="math/tex">S</script>.
\qed</p>

<p>\proclaim Corolario \fermatexponentecuatro. El 'Ultimo
Teorema de Fermat es cierto para <script type="math/tex">n=4</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  En efecto, si la ecuación <script type="math/tex">x^4+y^4=z^4</script> tuviera una
solución entera <script type="math/tex">x=a,y=b,z=c</script> con <script type="math/tex">abc\ne0</script>, entonces
<script type="math/tex">x=\vert a\vert ,y=\vert b\vert ,z=c^2</script> sería una solución entera
positiva de <script type="math/tex">x^4+y^4=z^2</script>, lo que es imposible por el
Teorema \exponentescuatrocuatrodos.
\qed</p>

<p>\obs{\fermatexponenteprimo} El corolario anterior reduce el
'Ultimo Teorema de Fermat al caso en que el exponente <script type="math/tex">n</script>
es un número primo. En efecto, supongamos demostrado el
'Ultimo Teorema de Fermat para exponentes primos.
Entonces, para cada <script type="math/tex">n>2</script>, o bien <script type="math/tex">n</script> tiene un divisor
primo impar o es una potencia de <script type="math/tex">2</script>. En el primer caso,
si <script type="math/tex">n=pk</script>, con <script type="math/tex">p>2</script> primo, entonces la ecuación de
Fermat se puede escribir como <script type="math/tex">(x^k)^p+(y^k)^p=(z^k)^p</script>,
que no tiene solución no trivial, porque por hipótesis
<script type="math/tex">x^p+y^p=z^p</script> no la tiene. Si, en cambio, <script type="math/tex">n</script> es una
potencia de <script type="math/tex">2</script>, como <script type="math/tex">n>2</script>, necesariamente se puede
escribir <script type="math/tex">n=4k</script> (además, <script type="math/tex">k</script> sería una potencia de
<script type="math/tex">2</script>, aunque esto no nos interesa). En este caso, se puede
escribir la ecuación como <script type="math/tex">(x^k)^4+(y^k)^4=(z^k)^4</script>,
pero el Corolario \fermatexponentecuatro\ implica que
entonces <script type="math/tex">x^ky^kz^k=0</script>, es decir, <script type="math/tex">xyz=0</script>.</p>

<p>\bigskip</p>

<p>Veamos otra ecuación diofántica más restrictiva que
la de Fermat de grado cuatro:</p>

<p>\proclaim Teorema \exponentescuatrodoscuatro. La ecuación
<script type="math/tex">x^4+y^2=z^4</script> no tiene solución entera positiva.</p>

<p><b>DEMOSTRACIÓN:</b>  Como en el Teorema \exponentescuatrocuatrodos,
suponemos por reducción al absurdo que exista solución
y tomamos aquélla con
<script type="math/tex">z</script> mínimo, lo que implicará en particular que
<script type="math/tex">x^2,y,z^2</script> es una terna pitagórica primitiva. Tenemos que
distinguir ahora dos casos según la paridad de <script type="math/tex">x</script> e <script type="math/tex">y</script>.</p>

<p>Si <script type="math/tex">x</script> es impar e <script type="math/tex">y</script> es par se tendrá, por el Teorema
\ternaspitagoricasprimitivas, que existen <script type="math/tex">s,t\in\mathbb{Z}</script> tales
que
<script type="math/tex"></script>\left{\eqalign{
x^2=&amp;s^2-t^2\cr
y=&amp;2st\cr
z^2=&amp;s^2+t^2
}\right.<script type="math/tex"></script>
y, multiplicando la primera y última igualdad se obtiene
<script type="math/tex">x^2z^2=(s^2-t^2)(s^2+t^2)=s^4-t^4</script>, y en particular
<script type="math/tex">t^4+(xz)^2=s^4</script>. Como <script type="math/tex">s^2\lt s^2+t^2=z^2</script>, se concluye que
<script type="math/tex">s\lt z</script>, lo que contradice la minimalidad de <script type="math/tex">z</script>.</p>

<p>Nos queda entonces el caso en que <script type="math/tex">x^2</script> es par e <script type="math/tex">y</script> impar.
Por el Teorema \ternaspitagoricasprimitivas, se tendrá que
existen <script type="math/tex">s,t</script> enteros positivos primos entre sí y de
distinta paridad tales que 
<script type="math/tex"></script>\left{\eqalign{
x^2=&amp;2st\cr
z^2=&amp;s^2+t^2
}\right.<script type="math/tex"></script>
donde no decimos si <script type="math/tex">y=s^2-t^2</script> o <script type="math/tex">y=t^2-s^2</script>; por tanto,
<script type="math/tex">s</script> y <script type="math/tex">t</script> juegan un papel simétrico, y podemos
suponer que <script type="math/tex">s</script> es par y <script type="math/tex">t</script> impar. Como la igualdad
<script type="math/tex">s^2+t^2=z^2</script> nos dice que <script type="math/tex">s,t,z</script> es una terna pitagórica
(primitiva porque <script type="math/tex">\text{mcd}(s,t)=1</script>), por el Teorema
\ternaspitagoricasprimitivas, podemos
encontrar 
<script type="math/tex">u,v</script> primos entre sí y de distinta paridad tales que
<script type="math/tex"></script>\left{\eqalign{
s=&amp;2uv\cr
t=&amp;u^2-v^2\cr
z=&amp;u^2+v^2
}\right.<script type="math/tex"></script>
Como <script type="math/tex">t</script> es impar, <script type="math/tex">\text{mcd}(2s,t)=1</script>, luego de
la igualdad <script type="math/tex">x^2=(2s)t</script> y del Corolario
\divisoresproducto(ii) deducimos que existen
<script type="math/tex">s',t'\in\mathbb{Z}_{\ge1}</script> tales que
<script type="math/tex"></script>\left{\eqalign{
2s=&amp;(2s’)^2\cr
t=&amp;t’^2
}\right.<script type="math/tex"></script>
Finalmente, haciendo la sustitución <script type="math/tex">s=2s'^2</script> en la
igualdad <script type="math/tex">s=2uv</script> llegamos a <script type="math/tex">s'^2=uv</script>, y usando de nuevo el
Corolario \divisoresproducto(ii) y <script type="math/tex">\text{mcd}(u,v)=1</script>, obtenemos
que existen <script type="math/tex">u',v'\in\mathbb{Z}_{\ge1}</script> tales que 
<script type="math/tex"></script>\left{\eqalign{
u=&amp;u’^2\cr
v=&amp;v’^2
}\right.<script type="math/tex"></script>
Por tanto, la igualdad <script type="math/tex">t=u^2-v^2</script> se convierte en
<script type="math/tex">v'^4+t'^2=u'^4</script>, y claramente 
<script type="math/tex"></script>u’\le u’^2=u\le u^2\lt u^2+v^2=z<script type="math/tex"></script>
lo que contradice la minimalidad de <script type="math/tex">z</script>.
\qed</p>

<p>\proclaim Corolario \areatriangulospitagoricos. El área de
un triángulo pitagórico no puede ser un cuadrado
perfecto.</p>

<p><b>DEMOSTRACIÓN:</b>  Si <script type="math/tex">x,y,z</script> son las longitudes de los lados de un
triángulo pitagórico, el área del mismo es 
<script type="math/tex">{1\over2}xy</script>, luego si es un cuadrado perfecto existirá
<script type="math/tex">u\in\mathbb{Z}_{\ge1}</script> tal que <script type="math/tex">xy=2u^2</script>. Por tanto tendremos
<script type="math/tex"></script>(x+y)^2=x^2+2xy+y^2=z^2+4u^2<script type="math/tex"></script>
<script type="math/tex"></script>(x-y)^2=x^2-2xy+y^2=z^2-4u^2<script type="math/tex"></script>
y multiplicando llegamos a
<script type="math/tex"></script>(x^2-y^2)^2=z^4-(2u)^4<script type="math/tex"></script>
que contradice el Teorema \exponentescuatrodoscuatro.
\qed</p>

<p>\obs{\exponentescuatrodosdos} No podemos seguir poniendo
más restricciones a la ecuación de Fermat de grado
cuatro sin llegar ya a soluciones no triviales.
Obsérvese que en los Teoremas \exponentescuatrocuatrodos\
y \exponentescuatrodoscuatro\ hemos cambiado un exponente
<script type="math/tex">4</script> por un <script type="math/tex">2</script>. Si cambiáramos dos exponentes <script type="math/tex">4</script> por
un <script type="math/tex">2</script>, es decir, si consideráramos las ecuaciones
<script type="math/tex">x^2+y^4=z^2</script> y <script type="math/tex">x^2+y^2=z^4</script>, ya tendríamos infinitas
soluciones. Basta mirar en la expresión de las ternas
pitagóricas primitivas dada en el Teorema
\ternaspitagoricasprimitivas\ para ver que se
obtienen infinitas soluciones de <script type="math/tex">x^2+y^4=z^2</script> si existen
infinitas soluciones de
<script type="math/tex"></script>\left{\eqalign{
x=&amp;2st\cr
y^2=&amp;s^2-t^2\cr
z=&amp;s^2+t^2
}\right.<script type="math/tex"></script>
lo que es cierto porque existen infinitas soluciones de
<script type="math/tex">y^2=s^2-t^2</script>. De la misma forma, existirán infinitas
soluciones de <script type="math/tex">x^2+y^2=z^4</script> si existen infinitas
soluciones de
<script type="math/tex"></script>\left{\eqalign{
x=&amp;2st\cr
y=&amp;s^2-t^2\cr
z^2=&amp;s^2+t^2
}\right.<script type="math/tex"></script> 
lo que vuelve a ser cierto, porque basta encontrar
infinitas soluciones de <script type="math/tex">z^2=s^2+t^2</script>.</p>

<p>\bigskip</p>

<p>Las soluciones de la ecuación <script type="math/tex">x^2+y^2=z^2</script> se pueden
interpretar desde otro punto de vista: ?<code class="highlighter-rouge">cuándo un
cuadrado perfecto $$z^2$$ se puede escribir como suma de dos
cuadrados $$x^2+y^2$$? O bien, ?</code>cuándo un cuadrado
perfecto <script type="math/tex">x^2</script> se puede escribir como diferencia de dos
cuadrados <script type="math/tex">z^2-y^2</script>? A continuación queremos estudiar un
problema más general: ?`cuándo un número se puede
escribir como suma o diferencia de dos cuadrados?.
Empezamos con el caso de la diferencia de cuadrados, que
resulta sorprendentemente fácil:</p>

<p>\proclaim Teorema \diferenciacuadrados. Un número <script type="math/tex">n\in\mathbb{Z}</script>
se puede escribir como <script type="math/tex">n=x^2-y^2</script> si y sólo si
<script type="math/tex">n\not\equiv2\ (\text{mod }4)</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Supongamos primero que <script type="math/tex">n=x^2-y^2</script>. Como 
<script type="math/tex">x^2,y^2\equiv0,1\ (\text{mod }4)</script>, se sigue que
<script type="math/tex">n=x^2-y^2\equiv0,1,3\ (\text{mod }4)</script>. Recíprocamente,
supongamos que <script type="math/tex">n\not\equiv2\ (\text{mod }4)</script>. Distinguimos dos
casos:</p>

<p>-Si <script type="math/tex">n</script> es impar, entonces escribimos
<script type="math/tex">n=({n+1\over2})^2-({n-1\over2})^2</script>.</p>

<p>-Si <script type="math/tex">n</script> es par, entonces es múltiplo de <script type="math/tex">4</script>, y podemos
escribir <script type="math/tex">n=({n+4\over4})^2-({n-4\over4})^2</script>.
\qed</p>

<p>El caso de la suma de dos cuadrados es más complicado.
Empezamos con una observación que será muy útil:</p>

<p><b>LEMA:</b>  \sumadoscuadradosmultiplicativo. El producto
de dos sumas de dos cuadrados es también una suma de dos
cuadrados.</p>

<p><b>DEMOSTRACIÓN:</b>  En efecto, basta observar que <script type="math/tex">(x^2+y^2)(z^2+w^2)=
(xz+yw)^2+(xw-yz)^2</script>. 
<script type="math/tex">{}</script>\qed</p>

<p>A la vista del resultado anterior, parece lógico 
estudiar primero qué números primos son sumas de dos
cuadrados. En este caso, tenemos el siguiente
primer resultado:</p>

<p><b>LEMA:</b> \unicidadsumadoscuadrados. Si <script type="math/tex">p</script> es
un número primo y <script type="math/tex">x,y\in\mathbb{Z}</script>, entonces:
\item{(i)} <script type="math/tex">p=x^2+y^2</script> si y sólo si
<script type="math/tex">p\vert x^2+x^2</script> y <script type="math/tex">0\lt \vert x\vert ,\vert y\vert \lt \sqrt{p}</script>.
\item{(ii)} Si
<script type="math/tex">p=x^2+y^2=z^2+w^2</script>, entonces o bien <script type="math/tex">\vert x\vert =\vert z\vert</script>, <script type="math/tex">\vert y\vert =\vert w\vert</script> o
bien <script type="math/tex">\vert x\vert =\vert w\vert</script>, <script type="math/tex">\vert y\vert =\vert z\vert</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Para demostrar (i), supongamos primero <script type="math/tex">p=x^2+y^2</script>,
de donde se deduce inmediatamente <script type="math/tex">p\vert x^2+x^2</script>. Además, no
puede ser <script type="math/tex">x=0</script>, ya que entonces
<script type="math/tex">p=y^2</script>, y no podría ser un número primo. De la misma
forma, <script type="math/tex">y\ne0</script>, por lo que <script type="math/tex">\vert x\vert ,\vert y\vert >0</script>. De aquí se
deduce también <script type="math/tex">x^2\lt x^2+y^2=p</script>, luego <script type="math/tex">\vert x\vert \lt \sqrt{p}</script> y,
análogamente, <script type="math/tex">\vert y\vert \lt \sqrt{p}</script>.</p>

<p>Recíprocamente, supongamos <script type="math/tex">p\vert x^2+x^2</script> y
<script type="math/tex">0\lt \vert x\vert ,\vert y\vert \lt \sqrt{p}</script>. En particular, <script type="math/tex">x^2+y^2=np</script> para
algún <script type="math/tex">n>0</script>. Por otra parte,
<script type="math/tex">np=x^2+y^2\lt (\sqrt{p})^2+(\sqrt{p})^2=p+p=2p</script>, luego <script type="math/tex">n\lt 2</script>,
es decir, <script type="math/tex">n=1</script> y <script type="math/tex">x^2+y^2=p</script>.</p>

<p>Para demostrar (ii), es claro que basta suponer <script type="math/tex">x,y,z,w>0</script>.
Tenemos entonces
<script type="math/tex"></script>(xz-yw)(xw-yz)=x^2zw-xyz^2-xyw^2+y^2zw
=(x^2+y^2)zw-xy(z^2+w^2)=p(zw-xy).<script type="math/tex"></script>
Como <script type="math/tex">p</script> es primo, entonces <script type="math/tex">p\vert xz-yw</script> o <script type="math/tex">p\vert xw-yz</script>. Por
otra parte, por (i),
<script type="math/tex">x,y,z,w\lt \sqrt{p}</script>, luego <script type="math/tex">\vert xz-yw\vert ,\vert xw-yz\vert \lt p</script>, por lo que
decir que <script type="math/tex">xz-yw</script> o <script type="math/tex">xw-yz</script> son divisibles por <script type="math/tex">p</script> es lo
mismo que decir que <script type="math/tex">xw-yz</script> o <script type="math/tex">xw-yz</script> son cero y, en
cualquiera de los caso, se tendrá también <script type="math/tex">zw-xy=0</script>.
Supongamos por ejemplo <script type="math/tex">xw-yz=0</script>. Entonces
<script type="math/tex"></script>zw^2=w(zw)=w(xy)=y(xw)=y(yz)=y^2z<script type="math/tex"></script>
de donde se sigue <script type="math/tex">y^2=w^2</script> y por tanto <script type="math/tex">x^2=w^2</script>, es
decir, <script type="math/tex">y=w</script> y <script type="math/tex">x=z</script>. Cuando <script type="math/tex">xw-yz=0</script>, el mismo argumento
demuestro <script type="math/tex">x=w</script>, <script type="math/tex">y=z</script>.
\qed</p>

<p>A la vista de la parte (i) del resultado anterior, empezamos
viendo cuándo una suma de dos cuadrados es divisible por un
número primo.</p>

<p><b>LEMA:</b>  \divisoressumadoscuadrados. Sea <script type="math/tex">p</script>
un número primo y sean <script type="math/tex">x,y</script> números enteros no
divisibles por <script type="math/tex">p</script>. Sea <script type="math/tex">a\in\mathbb{Z}</script> tal que <script type="math/tex">ax\equiv y\ (\text{mod }
p)</script>. Entonces <script type="math/tex">p\vert x^2+y^2</script> si y sólo 
si <script type="math/tex">a^2\equiv -1\ (\text{mod } p)</script>. En particular, un número primo
<script type="math/tex">p\equiv3\ (\text{mod } 4)</script> no puede dividir a la suma de dos
cuadrados no divisibles por <script type="math/tex">p</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Para la primera parte, basta observar que
<script type="math/tex">x^2\equiv-y^2\equiv-a^2x^2\ (\text{mod } p)</script>. Como <script type="math/tex">\text{mcd}(x,p)=1</script>,
por la Proposición
\propiedadescongruencias(vi) la congruencia anterior es
equivalente a <script type="math/tex">a^2\equiv-1\ (\text{mod } p)</script>.</p>

<p>Para la segunda parte, supongamos por reducción al
absurdo que <script type="math/tex">p\equiv3\ (\text{mod } 4)</script> y <script type="math/tex">p\vert x^2+y^2</script> con
<script type="math/tex">x,y</script> no divisibles por <script type="math/tex">p</script>. Como <script type="math/tex">\text{mcd}(x,p)=1</script>, por la
Proposición \congruencialineal, existirá <script type="math/tex">a\in\mathbb{Z}</script> tal
que <script type="math/tex">ax\equiv y\ (\text{mod } p)</script>. El Lema
\divisoressumadoscuadrados\ implica entonces <script type="math/tex">a^2\equiv-1\
(\text{mod } p)</script>, y por el Teorema \menosunocuadrado\ no puede ser
<script type="math/tex">p\equiv3\ (\text{mod } 4)</script>.
\qed</p>

<p>El resultado anterior y la Proposición
\unicidadsumadoscuadrados(i) sugieren que necesitaremos el
siguiente:</p>

<p><b>LEMA:</b>  \thue\ {\rm (Thue)}. Sea <script type="math/tex">p</script> un número
primo y <script type="math/tex">a\in\mathbb{Z}</script> con <script type="math/tex">\text{mcd}(a,p)=1</script>. Entonces existen
<script type="math/tex">x,y\in\mathbb{Z}</script> tales que <script type="math/tex">ax\equiv y\ (\text{mod } p)</script> y
<script type="math/tex">0\lt \vert x\vert ,\vert y\vert \lt \sqrt{p}</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Consideramos el conjunto de expresiones de la forma
<script type="math/tex">ax-y</script> con <script type="math/tex">0\le x,y\le\sqrt{p}</script>. Como tenemos
<script type="math/tex">([\sqrt{p}]+1)^2>p</script> posibilidades para los pares
<script type="math/tex">x,y</script>, necesariamente tendremos dos pares distintos
<script type="math/tex">x_1,y_1</script> y <script type="math/tex">x_2,y_2</script> en esas condiciones tales que
<script type="math/tex">ax_1-y_1\equiv ax_2-y_2\ (\text{mod } p)</script>. Por tanto,
<script type="math/tex">x=x_1-x_2</script>, <script type="math/tex">y=y_1-y_2</script> es la solución buscada.
\qed</p>

<p>\proclaim Teorema \primosdoscuadrados. Un número primo <script type="math/tex">p</script>
se puede expresar como suma de dos cuadrados si y sólo si
<script type="math/tex">p=2</script> o <script type="math/tex">p\equiv1\ (\text{mod }4)</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Suponemos en primer lugar que podemos escribir
<script type="math/tex">p=x^2+y^2</script>. Por la Proposición
\unicidadsumadoscuadrados(i), <script type="math/tex">0\lt \vert x\vert ,\vert y\vert \lt p</script>, luego <script type="math/tex">x,y</script> no
son divisibles por <script type="math/tex">p</script>. El Lema
\divisoressumadoscuadrados\ implica entonces que
<script type="math/tex">p</script> no es congruente con 3 módulo 4, luego <script type="math/tex">p=2</script> o
<script type="math/tex">p\equiv1\ (\text{mod }4)</script>.</p>

<p>Recíprocamente, si <script type="math/tex">p=2</script> o <script type="math/tex">p\equiv1\ (\text{mod }4)</script>, el
Teorema \menosunocuadrado\ implica que existe
<script type="math/tex">a\in\mathbb{Z}</script> tal que <script type="math/tex">p\vert a^2+1</script>. Evidentemente, <script type="math/tex">\text{mcd}(a,p)=1</script>,
por lo que por el Lema de Thue existen <script type="math/tex">x,y\in\mathbb{Z}</script>
tales que <script type="math/tex">ax\equiv y\ (\text{mod } p)</script> y <script type="math/tex">0\lt \vert x\vert ,\vert y\vert \lt \sqrt{p}</script>. La
condición <script type="math/tex">ax\equiv y\ (\text{mod } p)</script> implica, por el Lema
\divisoressumadoscuadrados, que <script type="math/tex">p\vert x^2+y^2</script>, y entonces la
condición <script type="math/tex">0\lt \vert x\vert ,\vert y\vert \lt \sqrt{p}</script> implica, por el Lema
\divisoressumadoscuadrados, <script type="math/tex">p=x^2+y^2</script>, como queríamos.
\qed</p>

<p>Podemos caracterizar finalmente los enteros que son sumas
de dos cuadrados:</p>

<p>\proclaim Teorema \sumadoscuadrados. Un número positivo es
suma de dos cuadrados si y sólo si, en su
descomposición en factores primos, todos los factores
primos de la forma
<script type="math/tex">4k+3</script> aparecen con exponente par.</p>

<p><b>DEMOSTRACIÓN:</b>  Sea <script type="math/tex">n=x^2+y^2</script> y llamemos <script type="math/tex">d=\text{mcd}(x,y)</script>. Podemos
entonces escribir <script type="math/tex">x=dx'</script> y <script type="math/tex">y=dy'</script> con <script type="math/tex">\text{mcd}(x',y')=1</script>.
Entonces <script type="math/tex">n=d^2(x'^2+y'^2)</script>. Cada factor primo <script type="math/tex">p</script> de
<script type="math/tex">x'^2+y'^2</script>, no puede dividir ni a <script type="math/tex">x'</script> ni a <script type="math/tex">y'</script> (si
dividiera a uno, dividiría a ambos), luego por la Lema
\divisoressumadoscuadrados, no es <script type="math/tex">p\equiv3\ (\text{mod } 4)</script>. Por
tanto, los factores primos de <script type="math/tex">n</script> de la forma <script type="math/tex">4k+3</script> 
están todos en <script type="math/tex">d^2</script>, luego aparecen con exponente par.</p>

<p>Recíprocamente, si <script type="math/tex">n</script> tiene todos sus factores primos
de la forma <script type="math/tex">4k+3</script> con exponente par, se podrá escribir
<script type="math/tex">n=d^2p_1\dots p_r</script>, donde <script type="math/tex">p_1,\dots,p_r</script> son primos
distintos que no son de la forma <script type="math/tex">4k+3</script>. Por el Teorema
\primosdoscuadrados, cada <script type="math/tex">p_i</script> es suma de dos cuadrados, y
por el Lema \sumadoscuadradosmultiplicativo\ su producto
también lo es, es decir, <script type="math/tex">p_1\dots p_r=x^2+y^2</script>. De
aquí se sigue
<script type="math/tex">n=(dx)^2+(dy)^2</script>.
<script type="math/tex">{}</script>\qed</p>

<p>\obs{\nounicidadsumadoscuadrados} Nótese que, si <script type="math/tex">n</script> no es
primo, no se tiene la unicidad de la des-com-posición en
suma de dos cuadrados que obtuvimos en la Proposición
\unicidadsumadoscuadrados(ii). En efecto, consideremos
<script type="math/tex">n=65=5\cdot13</script>. Tenemos entonces <script type="math/tex">5=2^2+1^2</script> y
<script type="math/tex">13=3^2+2^2</script>. Aplicando el Lema
\sumadoscuadradosmultiplicativo\ con <script type="math/tex">x=2,y=1,z=3,w=2</script>,
obtenemos <script type="math/tex">65=8^2+1^2</script>, mientras que, si aplicamos el Lema
\sumadoscuadradosmultiplicativo\ con <script type="math/tex">x=2,y=1,z=2,w=3</script>,
obtendremos <script type="math/tex">65=7^2+4^2</script>.</p>

<p>\bigskip</p>

<p>Ya que hay muchos números positivos que no se pueden
escribir como suma de dos cuadrados, cabe plantearse ahora
al pregunta: ?`podrá escribirse todo número positivo
como suma de tres cuadrados? Inmediatamente encontramos una
respuesta negativa:</p>

<p>\proclaim Teorema \sumatrescuadrados. Ningún número de
la forma
<script type="math/tex">4^n(8k+7)</script> se puede escribir como suma de tres cuadrados.</p>

<p><b>DEMOSTRACIÓN:</b>  Lo demostramos por inducción sobre <script type="math/tex">n</script>. Si <script type="math/tex">n=0</script>,
tenemos que ver que no se puede escribir
<script type="math/tex">8k+7=x^2+y^2+z^2</script>. Esto es evidente, ya que
<script type="math/tex">x^2,y^2,z^2\equiv 0,1,4\ (\text{mod } 8)</script>.</p>

<p>Supongamos ahora demostrado el resultado para <script type="math/tex">n</script> y veamos
que es cierto para <script type="math/tex">n+1</script>. Supongamos, por
reducción al absurdo, que podemos escribir
<script type="math/tex">4^{n+1}(8k+7)=x^2+y^2+z^2</script>. Como <script type="math/tex">4^{n+1}\equiv0\ (\text{mod }
4)</script> y <script type="math/tex">x^2,y^2,z^2\equiv 0,1\ (\text{mod } 4)</script>, se sigue que
necesariamente <script type="math/tex">a^2,b^2,c^2\equiv 0\ (\text{mod } 4)</script>, es decir,
<script type="math/tex">x,y,z</script> son pares. Escribimos entonces <script type="math/tex">x=2x'</script>, <script type="math/tex">y=2y'</script> y
<script type="math/tex">z=2z'</script>, por lo que se tendrá <script type="math/tex">4^n(8k+7)=x'^2+y'^2+z'^2</script>,
lo que contradice la hipótesis de inducción.
\qed</p>

<p>\obs{\trescuadradosnomultiplicativo} En realidad, se puede
demostrar que el teorema anterior caracteriza a los
números que no son sumas de tres cuadrados. Sin embargo,
la demostración no es fácil (por lo que no la haremos).
Esto se debe a que, contrariamente a lo que ocurre para la
suma de dos cuadrados (ver el Lema
\sumadoscuadradosmultiplicativo) el hecho de ser suma de
tres cuadrados no se respeta por productos. Por ejemplo,
<script type="math/tex">14=3^2+2^2+1^2</script> y <script type="math/tex">18=4^2+1^2+1^2</script>, mientras que
<script type="math/tex">14\cdot18=4(8\cdot7+7)</script> no es suma de tres cuadrados por
el Teorema \sumatrescuadrados.</p>

<p>\bigskip</p>

<p>Ya que con tres cuadrados no se puede, podemos seguir
preguntándonos ahora: ?`Y será cierto que todo
número entero positivo se puede escribir como suma de
cuatro cuadrados? La respuesta ahora será positiva, y se
basa en que, en este caso ya es cierto el análogo del Lema
\sumadoscuadradosmultiplicativo, que es una simple
cuenta que dejamos como ejercicio:</p>

<p>\ejer{\cuatrocuadradosmultiplicativo} Comprobar que se
verifica la igualdad
<script type="math/tex"></script>(a^2+b^2+c^2+d^2)(x^2+y^2+z^2+w^2)=r^2+s^2+t^2+u^2<script type="math/tex"></script>
donde
<script type="math/tex"></script>\left{\eqalign{
r=ax+by+cz+dw\cr
s=bx-ay+dz-cw\cr
t=cx-dy-az+bw\cr
u=dx+cy-bz-aw
}\right.<script type="math/tex"></script></p>

<p>A la vista de este resultado, bastará ver que todo
número primo es suma de cuatro cuadrados. Como en el
caso de dos cuadrados, empezamos de momento con 
propiedades sobre los divisores de distintas sumas de
cuadrados:</p>

<p><b>LEMA:</b>  \lemacuatrocuadrados. Si <script type="math/tex">p\equiv3\ (\text{mod }4)</script>
es un número primo, entonces existen <script type="math/tex">x,y\in\mathbb{Z}</script> tales que
<script type="math/tex">p\vert x^2+y^2+1</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Por las partes (iii) y (iv) de la Proposición
\propiedadessimbololegendre, tenemos respectivamente
<script type="math/tex">\leg{1}{p}=1</script> y <script type="math/tex">\leg{p-1}{p}=\leg{-1}{p}=-1</script>. Podremos
encontrar entonces <script type="math/tex">a\in\{2,3,\dots,p-1\}</script> tal que
<script type="math/tex">\leg{a-1}{p}=1</script> y <script type="math/tex">\leg{a}{p}=-1</script> y, en particular,
 <script type="math/tex"></script>\leg{-a}{p}=\leg{-1}{p}\leg{a}{p}=(-1)(-1)=1.<script type="math/tex"></script>
Por tanto, existen <script type="math/tex">a-1</script> y <script type="math/tex">-a</script> son restos cuadráticos
módulo <script type="math/tex">p</script>, es decir, existen <script type="math/tex">x,y\in\mathbb{Z}</script> tales que
<script type="math/tex">x^2\equiv a-1\ (\text{mod } p)</script> y <script type="math/tex">y^2\equiv -a\ (\text{mod } p)</script>.
Sumando, tendremos
<script type="math/tex"></script>x^2+y^2\equiv (a-1)+(-a)=-1\ (\text{mod } p),<script type="math/tex"></script> 
es decir, <script type="math/tex">p\vert x^2+y^2+1</script>.
\qed</p>

<p><b>LEMA:</b>  \descensocuatrocuadrados. Sea <script type="math/tex">m</script> un
divisor impar de una suma <script type="math/tex">x^2+y^2+z^2+w^2</script>. Entonces
existen
<script type="math/tex">a,b,c,d\in\mathbb{Z}</script> tales que 
<script type="math/tex"></script>\left{\eqalign{
x\equiv a\ (\text{mod } m)\cr
y\equiv b\ (\text{mod } m)\cr
z\equiv c\ (\text{mod } m)\cr
w\equiv d\ (\text{mod } m)\cr
}\right.<script type="math/tex"></script>
y <script type="math/tex">a^2+b^2+c^2+d^2=mm'</script>, con <script type="math/tex">m'\lt m</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Sea <script type="math/tex">r</script> el resto de la división de <script type="math/tex">x</script> entre <script type="math/tex">m</script>. Si
<script type="math/tex">r\lt {m\over 2}</script> tomamos <script type="math/tex">a=r</script>, y si <script type="math/tex">r>{m\over2}</script> tomamos
<script type="math/tex">a=r-m</script> (hace falta que <script type="math/tex">m</script> sea impar para que no se pueda
dar el caso <script type="math/tex">r={m\over2}</script>. Entonces <script type="math/tex">x\equiv a\ (\text{mod } m)</script> y
<script type="math/tex">\vert a\vert \lt {m\over2}</script>. Construimos de la misma forma <script type="math/tex">b,c,d</script>, es
decir, congruentes respectivamente con <script type="math/tex">y,z,w</script> módulo <script type="math/tex">m</script>
y de valor absoluto menor que <script type="math/tex">m\over2</script>. Por tanto,
tendremos
<script type="math/tex"></script>a^2+b^2+c^2+d^2\equiv x^2+y^2+z^2+w^2\equiv0\ (\text{mod } m)<script type="math/tex"></script>
luego existirá <script type="math/tex">m'\in\mathbb{Z}</script> tal que <script type="math/tex">a^2+b^2+c^2+d^2=mm'</script>.
Además,
<script type="math/tex"></script>mm’=a^2+b^2+c^2+d^2\lt 
\left({m\over2}\right)^2
+\left({m\over2}\right)^2
+\left({m\over2}\right)^2
+\left({m\over2}\right)^2
=m^2<script type="math/tex"></script>
por lo que <script type="math/tex">m'\lt m</script>.
\qed</p>

<p>Finalmente, podemos demostrar ya el resultado que
buscábamos:</p>

<p>\proclaim Teorema \sumacuatrocuadrados. Todo número
natural se puede escribir como suma de cuatro cuadrados (no
necesariamente distintos de cero).</p>

<p><b>DEMOSTRACIÓN:</b>  Por el Ejercicio \cuatrocuadradosmultiplicativo, basta
demostrar que cada número primo <script type="math/tex">p</script> es suma de cuatro
cuadrados. Si <script type="math/tex">p=2</script> o <script type="math/tex">p\equiv1\ (\text{mod }4)</script> ya sabemos que
<script type="math/tex">p</script> se escribe como suma de incluso sólo dos cuadrados,
así que basta demostrar el caso <script type="math/tex">p\equiv3\ (\text{mod } 4)</script>.
Por el Lema \lemacuatrocuadrados, sabemos que <script type="math/tex">p</script> divide a
la suma de tres cuadrados de enteros no todos nulos,
luego en particular un múltiplo de <script type="math/tex">p</script> se puede
poner como la suma de cuatro cuadrados de enteros no todos
nulos. Sea <script type="math/tex">kp</script> el múltiplo más peque\~no de <script type="math/tex">p</script> que se
puede escribir como suma de cuatro cuadrados de enteros
positivos no todos nulos. Por el Lema
\descensocuatrocuadrados\ tomando <script type="math/tex">m=p</script>, se tiene <script type="math/tex">k\lt p</script>, y
lo que queremos ver es <script type="math/tex">k=1</script>.</p>

<p>Veamos primero que <script type="math/tex">k</script> es impar. Escribimos
<script type="math/tex"></script>kp=x^2+y^2+z^2+w^2.<script type="math/tex"></script>
Si <script type="math/tex">k</script> fuera par, entonces entre <script type="math/tex">x,y,z,w</script> hay una cantidad
par de números pares y una cantidad par de impares. En
cualquier caso, reordenándolos, podemos suponer que <script type="math/tex">x</script> e
<script type="math/tex">y</script> tienen la misma paridad y que <script type="math/tex">z</script> y <script type="math/tex">w</script> tienen la misma
paridad. Entonces tendremos
<script type="math/tex"></script>{k\over2}p=\left({x+y\over2}\right)^2
+\left({x-y\over2}\right)^2
+\left({z+w\over2}\right)^2
+\left({z-w\over2}\right)^2,<script type="math/tex"></script>
lo que contradice la minimalidad de <script type="math/tex">k</script>, lo que implica que
<script type="math/tex">k</script> es impar.</p>

<p>Supongamos, por reducción al absurdo, que <script type="math/tex">k>1</script>.
Aplicando ahora el Lema \descensocuatrocuadrados\ tomando
<script type="math/tex">m=k</script>, existirán
<script type="math/tex">a,b,c,d\in\mathbb{Z}</script> tales que 
<script type="math/tex"></script>\left{\eqalign{
x\equiv a\ (\text{mod } k)\cr
y\equiv b\ (\text{mod } k)\cr
z\equiv c\ (\text{mod } k)\cr
w\equiv d\ (\text{mod } k)\cr
}\right.<script type="math/tex"></script>
y <script type="math/tex">a^2+b^2+c^2+d^2=nk</script> con <script type="math/tex">n\lt k</script>. Si fuera <script type="math/tex">n=0</script>, entonces
<script type="math/tex">a=b=c=d=0</script>, luego <script type="math/tex">k</script> dividiría a <script type="math/tex">x,y,z,w</script>, así
que <script type="math/tex">k^2</script> dividiría a <script type="math/tex">x^2+y^2+z^2+w^2=kp</script>, es decir,
<script type="math/tex">k</script> dividiría a <script type="math/tex">p</script>, lo que contradice el hecho de que
<script type="math/tex">1\lt k\lt p</script>. Por tanto, <script type="math/tex">0\lt n\lt k</script>. Usando la igualdad del
Ejercicio
\cuatrocuadradosmultiplicativo\ tendremos
<script type="math/tex"></script>k^2np=(a^2+b^2+c^2+d^2)(x^2+y^2+z^2+w^2)=r^2+s^2+t^2+u^2<script type="math/tex"></script>
donde
<script type="math/tex"></script>\left{\eqalign{
r&amp;=ax+by+cz+dw\equiv x^2+y^2+z^2+w^2\equiv0\ (\text{mod } k)\cr
s&amp;=bx-ay+dz-cw\equiv ba-ab+dc-cd=0\ (\text{mod } k)\cr
t&amp;=cx-dy-az+bw\equiv ca-db-ac+bd=0\ (\text{mod } k)\cr
u&amp;=dx+cy-bz-aw\equiv da+cb-bc-ad=0\ (\text{mod } k)
}\right.<script type="math/tex"></script>
es decir, <script type="math/tex">r,s,t,u</script> son divisibles por <script type="math/tex">k</script>. Se
tiene entonces 
<script type="math/tex"></script>np=\left({r\over k}\right)^2
+\left({s\over k}\right)^2
+\left({t\over k}\right)^2
+\left({u\over k}\right)^2,<script type="math/tex"></script>
lo que de nuevo contradice la minimalidad de <script type="math/tex">k</script>, ya que
<script type="math/tex">n\lt k</script>. Por tanto, <script type="math/tex">k=1</script>, como queríamos.
\qed</p>

<p>\obs{\waring} Para sumas de potencias superiores, se tiene
el llamado {\it problema de Waring}. En concreto, fijado
<script type="math/tex">n\in\mathbb{Z}_{\ge1}</script>, ?<code class="highlighter-rouge">cuál es el mínimo número $$g(n)$$
tal que cada número entero positivo es suma de $$g(n)$$
potencias $$n$$-ésimas de números enteros? En este
contexto, el Teorema \sumatrescuadrados\ indica que
$$g(2)\ge4$$ y el Teorema \sumacuatrocuadrados\ indica que
$$g(2)\le4$$, por lo que $$g(2)=4$$. Para $$n\ge3$$ el problema
es mucho más complicado, ya que no ocurre que el
producto sumas de
$$g$$ potencias $$n$$-ésimas sea una suma de $$g$$ potencias
$$n$$-ésimas (como ocurre para $$n=2$$ con $$g=2$$ y $$g=4$$).
Hay además una situación nueva. Por ejemplo, para $$n=3$$
no es difícil ver que
$$23=2^3+2^3+1^3+1^3+1^3+1^3+1^3+1^3+1^3$$ es la menor
descomposición en suma de cubos de $$23$$, por lo que
$$g(3)\ge9$$. Por otra parte, ha logrado demostrarse (por
L. Dickson) que cualquier entero positivo distinto de $$23$$ y
$$239$$ puede escribirse como suma de como mucho ocho cubos,
y de la misma forma se sabe (por un resultado debido a
Linnik) que salvo una cantidad finita de casos, todo entero
positivo es suma de a lo sumo de siete cubos. Esto da lugar
a otro problema, llamado el {\it gran problema de Waring}
(al anterior se le suele llamar por contraposición
{\it peque\~no problema de Waring}): ?</code>cuál es el
mínimo número <script type="math/tex">G(n)</script> tal que cada número entero
positivo, salvo una cantidad finita de casos, es suma de
<script type="math/tex">G(n)</script> potencias <script type="math/tex">n</script>-ésimas de números enteros? Mientras
que para <script type="math/tex">n=2</script> sigue siendo <script type="math/tex">g(2)=G(2)=4</script>, lo anterior para
<script type="math/tex">n=3</script> se traduce en <script type="math/tex">g(3)=9</script>, <script type="math/tex">G(3)\le7</script>. Es un problema
abierto cuál es el valor de <script type="math/tex">G(3)</script> (se sospecha <script type="math/tex">G(3)=4</script>,
pero sólo se sabe <script type="math/tex">4\le G(3)\le7</script>) y en general de <script type="math/tex">G(n)</script>
para <script type="math/tex">n\ge3</script>. Respecto a <script type="math/tex">g(n)</script>, se ha demostrado
recientemente que <script type="math/tex">g(4)=19</script>, <script type="math/tex">g(5)=37</script> y
<script type="math/tex">g(n)=[({3\over2})^n]+2^n-2</script> si <script type="math/tex">n\ge6</script> salvo quizá una
cantidad finita de valores de <script type="math/tex">n</script>.</p>

<p>\bigskip</p>

<p>Los Teoremas \diferenciacuadrados\ y \sumadoscuadrados\ 
pueden interpretarse como haber estudiado cuándo las
ecuaciones de la forma
<script type="math/tex">x^2-y^2=n</script> o <script type="math/tex">x^2+y^2=n</script> tienen solución entera. El caso
más sencillo ha sido el de diferencia de dos cuadrados.
Podemos complicar la ecuación un poco más y poner
coeficientes a la <script type="math/tex">x</script> y a la <script type="math/tex">y</script>, en cuyo caso las cosas se
complican muchísimo. El primer caso, aparentemente
sencillo, sería la ecuación <script type="math/tex">x^2-dy^2=1</script> con <script type="math/tex">d</script>
entero positivo que no sea un cuadrado perfecto. Esta
ecuación (llamada {\it ecuación de Pell}, aunque en
realidad se debería atribuir a Fermat), no es fácil
en absoluto, aunque al menos se puede decir que sus
soluciones (caso de existir) tienen una buena estructura:</p>

<p>\proclaim Teorema \presentacionPell. Sea <script type="math/tex">d</script> un entero
positivo que no sea un cuadrado perfecto y consideremos la
ecuación
<script type="math/tex">x^2-dy^2=1</script>. 
\item{(i)} Si <script type="math/tex">x',y'</script> y <script type="math/tex">x'',y''</script> son soluciones enteras de
la ecuación, entonces <script type="math/tex">x'x''+dy'y'',x'y''+x''y'</script> es
también  solución de la ecuación.
\item{(ii)} Si existe una solución entera positiva
<script type="math/tex">x_1,y_1</script> tal que <script type="math/tex">x_1+y_1\sqrt{d}</script> es mínimo entre
todas las soluciones enteras positivas de la ecuación, 
entonces las soluciones enteras positivas de la ecuación
son los pares de la forma <script type="math/tex">x_n,y_n</script> donde
<script type="math/tex">x_n+y_n\sqrt{d}=(x_1+y_1\sqrt{d})^n</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Obsérvese que
<script type="math/tex"></script>(x’+y’\sqrt{d})(x’‘+y’‘\sqrt{d})
=(x’x’‘+dy’y’’)+(x’y’‘+x’‘y’)\sqrt{d}<script type="math/tex"></script>
<script type="math/tex"></script>(x’-y’\sqrt{d})(x’‘-y’‘\sqrt{d})
=(x’x’‘+dy’y’’)-(x’y’‘+x’‘y’)\sqrt{d}<script type="math/tex"></script>
Como las soluciones de la ecuación son los enteros que
verifican <script type="math/tex">(x+y\sqrt{d})(x-y\sqrt{d})=1</script>, multiplicando las
dos igualdades anteriores se obtiene (i). De la misma forma
se obtiene que los pares <script type="math/tex">x_n,y_n</script> de (ii) son solución.
Lo que falta ver es que son las únicas soluciones.</p>

<p>Supongamos, por reducción al absurdo, que tenemos otra
solución entera positiva
<script type="math/tex">x',y'</script> que no es ninguna de las <script type="math/tex">x_n,y_n</script>. Por la
minimalidad de <script type="math/tex">x_1,y_1</script>, se tendrá
<script type="math/tex">x_1+y_1\sqrt{d}\lt x'+y'\sqrt{d}</script>. Además como la
sucesión <script type="math/tex">(x_1+y_1\sqrt{d})^n</script> es monótona creciente
con límite infinito se tendrá que existe
<script type="math/tex">n\in\mathbb{Z}_{\ge1}</script> tal que
<script type="math/tex"></script>(x_1+y_1\sqrt{d})^n\lt x’+y’\sqrt{d}\lt (x_1+y_1\sqrt{d})^{n+1}.<script type="math/tex"></script>
Multiplicando por <script type="math/tex">(x_1-y_1\sqrt{d})^n</script> (que es positivo
porque su producto con <script type="math/tex">(x_1+y_1\sqrt{d})^n</script> es <script type="math/tex">1</script>) se
tiene
<script type="math/tex"></script>1\lt (x’+y’\sqrt{d})(x_1-y_1\sqrt{d})^n\lt x_1+y_1\sqrt{d}.<script type="math/tex"></script>
Ahora bien, por (i), si escribimos 
<script type="math/tex"></script>(x’+y’\sqrt{d})(x_1-y_1\sqrt{d})^n
=(x’+y’\sqrt{d})(x_n-y_n\sqrt{d})=x’‘+y’‘\sqrt{d}<script type="math/tex"></script>
se tiene que <script type="math/tex">x'',y''</script> es una solución de la ecuación.
Para encontrar el absurdo que buscamos basta ver que esta
última solución es positiva. Ahora bien, como
<script type="math/tex">x''+y''\sqrt{d}>1</script> y
<script type="math/tex">(x''+y''\sqrt{d})(x''-y''\sqrt{d})=1</script>, entonces
<script type="math/tex">0\lt x''-y''\sqrt{d}\lt 1</script>. Por tanto,
<script type="math/tex"></script>2x’’=(x’‘+y’‘\sqrt{d})+(x’‘-y’‘\sqrt{d})&gt;1+0&gt;0<script type="math/tex"></script>
<script type="math/tex"></script>2y’‘\sqrt{d}=(x’‘+y’‘\sqrt{d})-(x’‘-y’‘\sqrt{d})&gt;1-1&gt;0<script type="math/tex"></script>
lo que termina la demostración.
\qed</p>

<p>Esta demostración indica lo que es una de las técnicas
fundamentales de la Teoría Algebraica de Números:
ampliar el conjunto de los enteros a expresiones, por
ejemplo, de la forma <script type="math/tex">a+b\sqrt{d}</script>. El problema principal
de esta técnica es que, salvo para valores muy concretos
de <script type="math/tex">d</script>, no se verifica la factorización única que
tenemos para los enteros (y cuando se verifica no es de
forma tan fácil). Para terminar de estudiar la ecuación
de Pell (y en particular la existencia de la solución
<script type="math/tex">x_1,y_1</script> que necesita el teorema anterior) desarrollaremos
en la siguiente sección toda una técnica nueva, la de
las fracciones continuas.</p>
