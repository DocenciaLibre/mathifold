<p>En el Teorema \congruenciaspotencia\ hemos visto que el
Teorema \potenciaprimoprimitivo\ parece funcionar
particularmente bien para ciertas congruencias de grado
<script type="math/tex">2^k</script>. En este capítulo vamos a centrarnos en las
congruencias de grado dos. Obsérvese en primer lugar que
cualquier congruencia módulo un entero <script type="math/tex">n</script> se puede
descomponer en congruencias módulo las potencias de primos
que dividen a <script type="math/tex">n</script>. Podemos usar por tanto que, con la
excepción de las potencias de dos, las potencias de un
primo tienen raíces primitivas. De todas formas, vamos a
iniciar nuestro estudio con congruencias cuadráticas
módulo un número primo. Podemos suponer que el primo es
impar, ya que <script type="math/tex">x^2\equiv x\ (\text{mod } 2)</script>, luego las congruencias
cuadráticas módulo dos son equivalentes a congruencias
lineales.</p>

<p>El primer resultado nos da la clásica resolución de una
ecuación de grado dos, pero ahora en el lenguaje de
congruencias.</p>

<p><b>LEMA:</b> \resolucioncuadratica. Sea <script type="math/tex">p</script> un
número primo impar y sean <script type="math/tex">a,b,c\in\mathbb{Z}</script> tales que
<script type="math/tex">\text{mcd}(a,p)=1</script>. Entonces la congruencia
<script type="math/tex">ax^2+bx+c\equiv0\ (\text{mod } p)</script> tiene solución si y sólo si
la congruencia <script type="math/tex">x^2\equiv b^2-4ac\ (\text{mod } p)</script> tiene
solución. Además, las soluciones de <script type="math/tex">ax^2+bx+c\equiv0\
(\text{mod } p)</script> son exactamente las soluciones de <script type="math/tex">2ax\equiv -b+d\
(\text{mod } p)</script> y <script type="math/tex">2ax\equiv -b-d\
(\text{mod } p)</script>, donde <script type="math/tex">d</script> es una solución de <script type="math/tex">x^2\equiv
b^2-4ac\ (\text{mod } p)</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Como <script type="math/tex">\text{mcd}(4a,p)=1</script>, la congruencia <script type="math/tex">ax^2+bx+c\equiv0\
(\text{mod } p)</script> es equivalente a <script type="math/tex">4a^2x^2+4abx+4ac\equiv0\ (\text{mod }
p)</script>, es decir,
<script type="math/tex"></script>(2ax+b)^2\equiv b^2-4ac\ (\text{mod } p).<script type="math/tex"></script>
Por tanto, si nuestra congruencia original tiene solución,
entonces <script type="math/tex">b^2-4ac</script> es un cuadrado módulo <script type="math/tex">p</script>.
Recíprocamente, si <script type="math/tex">d^2\equiv b^2-4ac\ (\text{mod } p)</script>,
entonces la congruencia anterior es equivalente a<br />
<script type="math/tex">p\vert (2ax+b)^2-d^2</script>, es decir <script type="math/tex">p\vert (2ax+b+d)(2ax+b-d)</script>, que es a
su vez equivalente a <script type="math/tex">2ax\equiv -b+d\ (\text{mod } p)</script> o <script type="math/tex">2ax\equiv
-b-d\ (\text{mod } p)</script>, y ambas tienen solución única porque
<script type="math/tex">\text{mcd}(2a,p)=1</script> (ver Proposición \congruencialineal).
\qed</p>

<p>El resultado anterior indica que para saber resolver
ecuaciones cuadráticas módulo un número primo basta
saber decidir cuándo un número es un cuadrado módulo
dicho número primo. Por supuesto, si el número es
divisible por el número primo, es congruente con el
cuadrado de cero, y es la única solución. En caso
contrario, podemos usar el Teorema
\congruenciaspotencia\ para dar una respuesta:</p>

<p>\proclaim Teorema \criterioEuler\ ({\rm Criterio de
Euler)}. Sea <script type="math/tex">p</script> un número primo impar y sea
<script type="math/tex">a\in\mathbb{Z}</script> tal que <script type="math/tex">\text{mcd}(a,p)=1</script>. Entonces la congruencia
<script type="math/tex">x^2\equiv a\ (\text{mod } p)</script> tiene solución si y sólo si
<script type="math/tex">a^{p-1\over2}\equiv1\ (\text{mod } p)</script>. Además, si la congruencia
no tiene solución se verifica <script type="math/tex">a^{p-1\over2}\equiv-1\ (\text{mod }
p)</script></p>

<p><b>DEMOSTRACIÓN:</b><br />
Como <script type="math/tex">\phi(p)=p-1</script> es par, se tiene que
<script type="math/tex">\text{mcd}(2,\phi(p))=2</script>, luego por el Teorema
\congruenciaspotencia\ la congruencia
<script type="math/tex">x^2\equiv a\ (\text{mod } p)</script> tiene solución si y sólo si
<script type="math/tex">a^{p-1\over2}\equiv1\ (\text{mod } p)</script>.</p>

<p>Por otra parte, por el Teorema de Euler se tiene
<script type="math/tex">a^{p-1}\equiv1\ (\text{mod } p)</script>, es decir,
<script type="math/tex"></script>p\vert a^{p-1}-1=(a^{p-1\over2})^2-1=
(a^{p-1\over2}+1)(a^{p-1\over2}-1)<script type="math/tex"></script>
lo que implica que <script type="math/tex">a^{p-1\over2}\equiv1\ (\text{mod } p)</script> o
<script type="math/tex">a^{p-1\over2}\equiv-1\ (\text{mod } p)</script>.
\qed</p>

<p><b>DEFINICIÓN:</b> Si <script type="math/tex">\text{mcd}(a,p)=1</script>, se dice que <script type="math/tex">a</script> es un {\it resto
cuadrático módulo
<script type="math/tex">p</script>} si la congruencia <script type="math/tex">x^2\equiv a\ (\text{mod } p)</script> tiene
solución. Se llama {\it símbolo de Legendre} al
número
<script type="math/tex"></script>\leg{a}{p}=\left{\eqalign{1\ &amp;\hbox{ si es un resto
cuadrático módulo
<script type="math/tex">p</script>}\cr -1\ &amp;\hbox{ si <script type="math/tex">a</script> no es un resto cuadrático
módulo <script type="math/tex">p</script>} }\right.<script type="math/tex"></script>
Para <script type="math/tex">p=2</script>, se tiene obviamente <script type="math/tex">\leg{a}{2}=1</script> para
cualquier <script type="math/tex">a</script> impar. Si <script type="math/tex">p</script> es un número primo impar, por
el Teorema \criterioEuler, se tiene
<script type="math/tex"></script>a^{p-1\over2}\equiv\leg{a}{p}\ (\text{mod } p)<script type="math/tex"></script></p>

<p><b>LEMA:</b> \propiedadessimbololegendre. El
símbolo de Legendre verifica las siguientes propiedades:
\item{(i)} Si <script type="math/tex">a\equiv b\ (\text{mod } p)</script> entonces
<script type="math/tex">\leg{a}{p}=\leg{b}{p}</script>.
\item{(ii)} <script type="math/tex">\leg{ab}{p}=\leg{a}{p}\leg{b}{p}</script>.
\item{(iii)} <script type="math/tex">\leg{a^2}{p}=1</script>, y en particular <script type="math/tex">\leg{1}{p}=1</script>
\item{(iv)} <script type="math/tex">\leg{-1}{p}=(-1)^{p-1\over2}</script> si <script type="math/tex">p</script> es impar.</p>

<p><b>DEMOSTRACIÓN:</b>  La parte (i) es trivial. La parte (ii) (si <script type="math/tex">p</script> es
impar, ya que el caso <script type="math/tex">p=2</script> es trivial) se sigue de que
<script type="math/tex"></script>\leg{ab}{p}\equiv(ab)^{p-1\over2}=a^{p-1\over2}b^{p-1\over2}
\equiv\leg{a}{p}\leg{b}{p}\ (\text{mod } p)<script type="math/tex"></script>
lo que implica la igualdad de <script type="math/tex">\leg{ab}{p}</script> y
<script type="math/tex">\leg{a}{p}\leg{b}{p}</script>, ya que ambos valen <script type="math/tex">1</script> o <script type="math/tex">-1</script>. La
parte (iii) es (ii) cuando <script type="math/tex">a=b</script>, y la parte (iv) es el
criterio de Euler (nótese que es también equivalente
al Teorema \menosunocuadrado).
\qed</p>

<p>\obs{\usolegendre} La parte (ii) es mucho más potente de lo
que aparenta. Por ejemplo, podría parecer que no sirve
para calcular <script type="math/tex">\leg{23}{31}</script>, pero basta por ejemplo escribir 
<script type="math/tex"></script>\leg{23}{31}=\leg{-8}{31}=\leg{(-1)2^3}{31}=
\leg{-1}{31}\leg{2}{31}^3.<script type="math/tex"></script>
Por (iv), tenemos <script type="math/tex">\leg{-1}{31}=-1</script>, mientras que por (iii)
tenemos <script type="math/tex">\leg{2}{31}^3=\leg{2}{31}</script>, por lo que finalmente 
tenemos <script type="math/tex">\leg{23}{31}=-\leg{2}{31}</script>, que es más fácil de
calcular. En efecto, basta utilizar el criterio de Euler, y
observar que 
<script type="math/tex"></script>2^{31-1\over2}=2^{15}=(2^5)^3=32^3\equiv1^3=1\ (\text{mod }
31)<script type="math/tex"></script>
por lo que <script type="math/tex">\leg{2}{31}=1</script> y por tanto <script type="math/tex">\leg{23}{31}=-1</script>.</p>

<p>\proclaim Teorema \lemaGauss. Sea <script type="math/tex">p</script>
un número primo impar y sea <script type="math/tex">a\in\mathbb{Z}</script> tal que <script type="math/tex">\text{mcd}(a,p)=1</script>.
Para cada <script type="math/tex">k=1,2,\dots,{p-1\over2}</script>, sea <script type="math/tex">ka=q_kp+r_k</script> la
división de <script type="math/tex">ka</script> entre <script type="math/tex">p</script>. Separamos los restos
<script type="math/tex">r_1,r_2,\dots,r_{p-1\over2}</script> de la forma
<script type="math/tex"></script>{r_1,\dots,r_{p-1\over2}}
={r’_1,\dots,r’_m}\cup{r’‘_1,\dots,r’‘_n}<script type="math/tex"></script>
donde <script type="math/tex">r'_1,\dots,r'_m</script> son los restos menores que <script type="math/tex">p\over2</script> y
<script type="math/tex">r''_1,\dots,r''_n</script> son los restos mayores que <script type="math/tex">p\over2</script>.
Entonces:
\item{(i)} <script type="math/tex">\{1,2\dots,{p-1\over2}\}
=\{r'_1,\dots,r'_m\}\cup\{p-r''_1,\dots,p-r''_n\}</script>
\item{(ii)} {\rm (Lema de Gauss)} <script type="math/tex">\leg{a}{p}=(-1)^n</script>, donde
<script type="math/tex">n</script> es como antes, es decir, el número de ele-men-tos de
<script type="math/tex">a,2a,3a,\dots,{p-1\over2}a</script> cuyo resto al dividir por <script type="math/tex">p</script> es
mayor que <script type="math/tex">p\over2</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Usaremos repetidamente la Proposición
<b>EJEMPLO:</b> plosrestos. Como el conjunto
<script type="math/tex"></script>-{p-1\over2},-{p-3\over2},\dots,-1,0,1,\dots,{p-1\over2}<script type="math/tex"></script>
está formado por <script type="math/tex">p</script> números consecutivos, es un sistema
completo de restos módulo <script type="math/tex">p</script>. Por tanto, también los
números
<script type="math/tex"></script>-{p-1\over2}a,-{p-3\over2}a,\dots,-a,0,a,\dots,{p-1\over2}a<script type="math/tex"></script>
forma un sistema completo de restos módulo <script type="math/tex">p</script>. Como los
números <script type="math/tex">a,\dots,{p-1\over2}a</script> son congruentes módulo
<script type="math/tex">p</script> (en algún orden), a <script type="math/tex">r_1,\dots,r_{p-1\over2}</script>, es
decir, a <script type="math/tex">r'_1,\dots,r'_m,r''_1,\dots,r''_n</script>, se tendrá
que los números 
<script type="math/tex"></script>-r’_1,\dots,-r’_m,-r’‘_1,\dots,-r’‘_n,0,r’_1,\dots,r’_m,r’‘_1,\dots,r’‘_n<script type="math/tex"></script>
forman un sistema completo de restos módulo <script type="math/tex">p</script>. Esto
implica en particular que los números
<script type="math/tex">r'_1,\dots,r'_m,-r''_1,\dots,-r''_n</script> son incongruentes
módulo <script type="math/tex">p</script> cuando se toman dos a dos, y lo mismo es cierto
con los números <script type="math/tex">r'_1,\dots,r'_m,p-r''_1,\dots,p-r''_n</script>,
que serán por tanto distintos. Como hay <script type="math/tex">m+n={p+1\over2}</script>
de estos números, y todos ellos están en el conjunto
<script type="math/tex">\{1,2\dots,{p-1\over2}\}</script>, se sigue inmediatamente la parte
(i).</p>

<p>Multiplicando entonces todos estos números, se obtiene:
<script type="math/tex"></script>\left(p-1\over2\right)!=r’_1\dots
r’_m(p-r’‘_1)\dots(p-r’‘_n)\equiv
(-1)^nr’_1\dots r’_mr’‘_1\dots r’‘_n\ (\text{mod } p).<script type="math/tex"></script>
 y, como por otra parte,
<script type="math/tex"></script>r’_1\dots r’_mr’‘_1\dots
r’‘_n\equiv
a(2a)(3a)\dots({p-1\over2}a)=
\left(p-1\over2\right)!a^{p-1\over2}\ (\text{mod } p),<script type="math/tex"></script>
juntando ambas congruencias, se sigue
<script type="math/tex">a^{p-1\over2}\equiv(-1)^n\ (\text{mod } p)</script>, lo que prueba (ii).
\qed</p>

<p>\proclaim Teorema \legendredos. Si <script type="math/tex">p</script> es
un primo impar, entonces 
<script type="math/tex"></script>\leg{2}{p}=\left{\eqalign{1\
&amp;\hbox{ si <script type="math/tex">p\equiv1\ (\text{mod } 8)</script> o <script type="math/tex">p\equiv7\ (\text{mod } 8)</script>}\cr
-1\ &amp;\hbox{ si <script type="math/tex">p\equiv3\ (\text{mod } 8)</script> o <script type="math/tex">p\equiv5\ (\text{mod } 8)</script>}
}\right.<script type="math/tex"></script></p>

<p><b>DEMOSTRACIÓN:</b>  Usamos el lema de Gauss, y tenemos que ver
cuántos de los <script type="math/tex">p-1\over2</script> números
<script type="math/tex">2,4,\dots,p-1</script> son mayores que <script type="math/tex">p\over2</script>. Lo
haremos analizando separadamente todos los posibles 
restos de <script type="math/tex">p</script> módulo <script type="math/tex">8</script>:</p>

<p>–Si <script type="math/tex">p=8k+1</script>, entonces el conjunto 
<script type="math/tex">2,4,\dots,p-1=8k</script> tiene tenemos <script type="math/tex">4k</script> elementos, de los que
los menores de <script type="math/tex">{p\over2}=4k+{1\over2}</script> son <script type="math/tex">2,4,\dots,4k</script>,
es decir, <script type="math/tex">2k</script>. Por tanto, <script type="math/tex">n=4k-2k=2k</script>, que es par, luego
<script type="math/tex">\leg{2}{p}=1</script>.</p>

<p>–Si <script type="math/tex">p=8k+3</script>, entonces el conjunto 
<script type="math/tex">2,4,\dots,p-1=8k+2</script> tiene tenemos <script type="math/tex">4k+1</script> elementos, de los
que los menores de <script type="math/tex">{p\over2}=4k+{3\over2}</script> son
<script type="math/tex">2,4,\dots,4k</script>, es decir, <script type="math/tex">2k</script>. Por tanto, <script type="math/tex">n=(4k+1)-2k=2k+1</script>,
que es impar, luego
<script type="math/tex">\leg{2}{p}=-1</script>.</p>

<p>–Si <script type="math/tex">p=8k+5</script>, entonces el conjunto 
<script type="math/tex">2,4,\dots,p-1=8k+4</script> tiene tenemos <script type="math/tex">4k+2</script> elementos, de los
que los menores de <script type="math/tex">{p\over2}=4k+{5\over2}</script> son
<script type="math/tex">2,4,\dots,4k+2</script>, es decir, <script type="math/tex">2k+1</script>. Por tanto,
<script type="math/tex">n=(4k+2)-(2k+1)=2k+1</script>, que es impar, luego
<script type="math/tex">\leg{2}{p}=-1</script>.</p>

<p>–Si <script type="math/tex">p=8k+7</script>, entonces el conjunto 
<script type="math/tex">2,4,\dots,p-1=8k+6</script> tiene tenemos <script type="math/tex">4k+3</script> elementos, de los
que los menores de <script type="math/tex">{p\over2}=4k+{7\over2}</script> son
<script type="math/tex">2,4,\dots,4k+2</script>, es decir, <script type="math/tex">2k+1</script>. Por tanto,
<script type="math/tex">n=(4k+3)-(2k+1)=2k+2</script>, que es par, luego
<script type="math/tex">\leg{2}{p}=1</script>.
\qed</p>

<p>\proclaim Corolario \primosochokmassiete. Existen infinitos
números primos de la forma <script type="math/tex">8k+7</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Si <script type="math/tex">p_1,p_2,\dots,p_r</script> fueran todos los números
primos de la forma <script type="math/tex">8k+7</script>, consideramos el número
<script type="math/tex">a=8(p_1p_2\dots p_r)^2-1</script>. Sea <script type="math/tex">p</script> un divisor primo de
<script type="math/tex">a</script> (necesariamente <script type="math/tex">p</script> será impar). Entonces,
<script type="math/tex">(4p_1p_2\dots p_r)^2\equiv2\ (\text{mod } p)</script>, por lo que, por
el Teorema \legendredos, se tiene <script type="math/tex">p\equiv1\ (\text{mod } 8)</script> o
<script type="math/tex">p\equiv7\ (\text{mod } 8)</script>. Como <script type="math/tex">a\equiv7\ (\text{mod } 8)</script>, no todos
los divisores de <script type="math/tex">a</script> pueden ser de la forma <script type="math/tex">8k+1</script>. Por
tanto, <script type="math/tex">a</script> es divisible por algún primo de la forma
<script type="math/tex">8k+7</script>, es decir, por algún <script type="math/tex">p_i</script>, lo que es absurdo.
\qed</p>

<p>\proclaim Teorema \legendremenosdos. Si <script type="math/tex">p</script> es
un primo impar, entonces 
<script type="math/tex"></script>\leg{-2}{p}=\left{\eqalign{1\
&amp;\hbox{ si <script type="math/tex">p\equiv1\ (\text{mod } 8)</script> o <script type="math/tex">p\equiv3\ (\text{mod } 8)</script>}\cr
-1\ &amp;\hbox{ si <script type="math/tex">p\equiv5\ (\text{mod } 8)</script> o <script type="math/tex">p\equiv7\ (\text{mod } 8)</script>}
}\right.<script type="math/tex"></script></p>

<p><b>DEMOSTRACIÓN:</b>  Basta combinar el Teorema \legendredos\ con las partes
(iii) y (iv) de la Proposición \propiedadessimbololegendre.
Lo hacemos según el resto de <script type="math/tex">p</script> módulo <script type="math/tex">8</script>:</p>

<p>–Si <script type="math/tex">p\equiv1\ (\text{mod }8)</script>, entonces por el Teorema
\legendredos, <script type="math/tex">\leg{2}{p}=1</script>, mientras que por otra parte
<script type="math/tex">p\equiv1\ (\text{mod }4)</script> luego por la Proposición
\propiedadessimbololegendre(iv) se tiene <script type="math/tex">\leg{-1}{p}=1</script>. Por
tanto, de la Proposición \propiedadessimbololegendre(iv) se
sigue <script type="math/tex">\leg{-2}{p}=1</script>.</p>

<p>–Si <script type="math/tex">p\equiv3\ (\text{mod }8)</script>, entonces por el Teorema
\legendredos, <script type="math/tex">\leg{2}{p}=-1</script>, mientras que por otra parte
<script type="math/tex">p\equiv3\ (\text{mod }4)</script> luego por la Proposición
\propiedadessimbololegendre(iv) se tiene <script type="math/tex">\leg{-1}{p}=-1</script>. Por
tanto, de la Proposición \propiedadessimbololegendre(iv) se
sigue <script type="math/tex">\leg{-2}{p}=1</script>.</p>

<p>–Si <script type="math/tex">p\equiv5\ (\text{mod }8)</script>, entonces por el Teorema
\legendredos, <script type="math/tex">\leg{2}{p}=-1</script>, mientras que por otra parte
<script type="math/tex">p\equiv1\ (\text{mod }4)</script> luego por la Proposición
\propiedadessimbololegendre(iv) se tiene <script type="math/tex">\leg{-1}{p}=1</script>. Por
tanto, de la Proposición \propiedadessimbololegendre(iv) se
sigue <script type="math/tex">\leg{-2}{p}=-1</script>.</p>

<p>–Si <script type="math/tex">p\equiv7\ (\text{mod }8)</script>, entonces por el Teorema
\legendredos, <script type="math/tex">\leg{2}{p}=1</script>, mientras que por otra parte
<script type="math/tex">p\equiv3\ (\text{mod }4)</script> luego por la Proposición
\propiedadessimbololegendre(iv) se tiene <script type="math/tex">\leg{-1}{p}=-1</script>. Por
tanto, de la Proposición \propiedadessimbololegendre(iv) se
sigue <script type="math/tex">\leg{-2}{p}=-1</script>.
\qed</p>

<p>\proclaim Corolario \primosochokmastres. Existen infinitos
números primos de la forma <script type="math/tex">8k+3</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Como siempre, supogamos que <script type="math/tex">p_1,p_2,\dots,p_r</script> son
todos los números primos de la forma <script type="math/tex">8k+3</script>.
Consideramos el número <script type="math/tex">a=(p_1p_2\dots p_r)^2+2</script>.
Entonces, si <script type="math/tex">p</script> es un divisor primo de <script type="math/tex">a</script>
(necesariamente impar), se tendrá que <script type="math/tex">(p_1p_2\dots
p_r)^2\equiv-2\ (\text{mod } p)</script>, y por el Teorema
\legendremenosdos\ se tendrá que <script type="math/tex">p</script> es congruente con
<script type="math/tex">1</script> o <script type="math/tex">3</script> módulo <script type="math/tex">8</script>. Como <script type="math/tex">a</script> es de la forma <script type="math/tex">8k+3</script> (ya
que el cuadrado de cada <script type="math/tex">p_i</script> es de la forma <script type="math/tex">8k+1</script>), no
todos los divisores de <script type="math/tex">a</script> son de la forma <script type="math/tex">8k+1</script>. Por
tanto, <script type="math/tex">a</script> es divisible por algún número primo de la
forma <script type="math/tex">8k+3</script>, es decir, por algún <script type="math/tex">p_i</script>; lo que es
imposible.
\qed</p>

<p>Damos a continuación un modo práctico de calcular los
símbolos de Legendre:</p>

<p><b>LEMA:</b>  \lemareciprocidad. Si <script type="math/tex">p</script> es un primo impar,
<script type="math/tex">a\in\mathbb{Z}</script> es impar y <script type="math/tex">\text{mcd}(a,p)=1</script>, entonces 
<script type="math/tex"></script>\leg{a}{p}=(-1)^{\sum_{k=1}^{p-1\over2}\ent{ka}{p}}.<script type="math/tex"></script></p>

<p><b>DEMOSTRACIÓN:</b>  Usando las notaciones del Teorema \lemaGauss, tenemos
que demostrar, por la parte (ii) de dicho teorema, que <script type="math/tex">n</script> y
<script type="math/tex">\sum_{k=1}^{p-1\over2}\ent{ka}{p}</script> tienen la misma paridad.
Como <script type="math/tex">a</script> y <script type="math/tex">p</script> son impares, y tomando congruencias módulo
<script type="math/tex">2</script>, tendremos:
<script type="math/tex"></script>\sum_{k=1}^{p-1\over2}\ent{ka}{p}\equiv
p\sum_{k=1}^{p-1\over2}\ent{ka}{p}=p\sum_{k=1}^{p-1\over2}q_k
=\sum_{k=1}^{p-1\over2}(ka-r_k)
=\sum_{k=1}^{p-1\over2}ka-(r’<em>1+\dots+r’_m)-(r’‘_1+\dots+r’‘_n)\equiv<script type="math/tex"></script>
<script type="math/tex"></script>\equiv\sum</em>{k=1}^{p-1\over2}k-(r’<em>1+\dots+r’_m)-(r’‘_1+\dots+r’‘_n)
\ (\text{mod } 2).<script type="math/tex"></script>
Por el Teorema \lemaGauss(i),
<script type="math/tex">\{r'_1,\dots,r'_m,p-r''_1,\dots,p-r''_n\}=\{1,2,\dots,{p-1\over2}\}</script>, y
por tanto
<script type="math/tex"></script>(r’_1+\dots+r’_m)+((p-r’‘_1)+\dots+(p-r’‘_n))
=\sum</em>{k=1}^{p-1\over2}k.<script type="math/tex"></script>
Sustituyendo en la congruencia anterior, obtenemos
<script type="math/tex"></script>\sum_{k=1}^{p-1\over2}\ent{ka}{p}\equiv((p-r’‘_1)+\dots+(p-r’‘_n))-(r’‘_1+\dots+r’‘_n)
=pn-2(r’‘_1+\dots+r’‘_n)\equiv n\ (\text{mod } 2)<script type="math/tex"></script>
que es lo que queríamos demostrar.
\qed</p>

<p>El resultado anterior nos permite demostrar el siguiente
resultado fundamental, que servirá para calcular cualquier
símbolo de Legendre:</p>

<p>\proclaim Teorema \reciprocidad\ {\rm (Ley de reciprocidad
cuadrática)}. Si <script type="math/tex">p,q</script> son primos impares distintos,
entonces
<script type="math/tex"></script>\leg{p}{q}\leg{q}{p}=(-1)^{ {p-1\over2}{q-1\over2}}.<script type="math/tex"></script></p>

<p><b>DEMOSTRACIÓN:</b> 
Consideramos el conjunto de pares de la forma <script type="math/tex">(k,l)</script>, con
<script type="math/tex">k\in\{1,2,\dots,{p-1\over2}\}</script> y
<script type="math/tex">l\in\{1,2,\dots,{q-1\over2}\}</script>. Evidentemente, hay
<script type="math/tex">{p-1\over2}{q-1\over2}</script> de dichos pares. Dividimos ahora el
mencionado conjunto en dos subconjuntos:</p>

<p>–En primer lugar, consideramos los pares <script type="math/tex">(k,l)</script> tales
que <script type="math/tex">kq\le lp</script>. Para cada <script type="math/tex">l\in\{1,2,\dots,{q-1\over2}\}</script>
los posibles valores de <script type="math/tex">k</script> son <script type="math/tex">1,2,\dots,\ent{lp}{q}</script>.
Por tanto, el número de pares de esta forma es
<script type="math/tex">\sum_{l=1}^{q-1\over2}\ent{lp}{q}</script>.</p>

<p>–Consideramos por otra parte los pares <script type="math/tex">(k,l)</script> tales
que <script type="math/tex">kq\ge lp</script>. Para cada <script type="math/tex">k\in\{1,2,\dots,{p-1\over2}\}</script>
los posibles valores de <script type="math/tex">l</script> son <script type="math/tex">1,2,\dots,\ent{kq}{p}</script>.
Por tanto, el número de pares de esta forma es
<script type="math/tex">\sum_{k=1}^{p-1\over2}\ent{kq}{p}</script>.</p>

<p>Observemos que no hay pares que estén en ambos
subconjuntos, ya que por ejemplo <script type="math/tex">p</script> no divide a ningún
<script type="math/tex">kq</script>. Por tanto, el número total de pares es igual, por una
parte a <script type="math/tex">{p-1\over2}{q-1\over2}</script>, y por otra parte a
<script type="math/tex">\sum_{k=1}^{p-1\over2}\ent{kq}{p}
+\sum_{l=1}^{q-1\over2}\ent{lp}{q}</script>. Tomando potencias de
<script type="math/tex">-1</script> y usando el Lema
\lemareciprocidad, tenemos
<script type="math/tex"></script>(-1)^{ {p-1\over2}{q-1\over2}}=
(-1)^{\sum_{k=1}^{p-1\over2}\ent{ka}{p}
+\sum_{l=1}^{q-1\over2}\ent{lp}{q}}=
(-1)^{\sum_{k=1}^{p-1\over2}\ent{ka}{p}}
(-1)^{\sum_{l=1}^{q-1\over2}\ent{lp}{q}}
=\leg{p}{q}\leg{q}{p}.<script type="math/tex"></script>
\qed</p>

<p>\obs{<b>DEMOSTRACIÓN:</b> ostracionesreciprocidad} La ley de
reciprocidad cuadrática es el resultado del que más
demostraciones se conocen. En 
http://www.rzuser.uni-heidelberg.de/<script type="math/tex">\sim</script>hb3/fchrono.html
hay una lista de ellas, y hasta el a\~no 2007 se llevan
contabilizadas 224 distintas.</p>

<p>\proclaim Corolario \legendretres. Sea <script type="math/tex">p>3</script> un número
primo. Entonces:
\item{(i)} <script type="math/tex">% <![CDATA[
\leg{3}{p}=\left\{\eqalign{1\
&\hbox{ si %]]></script>p\equiv1\ (\text{mod } 12)<script type="math/tex">o</script>p\equiv11\ (\text{mod } 12)<script type="math/tex">% <![CDATA[
}\cr
-1\ &\hbox{ si %]]></script>p\equiv5\ (\text{mod } 12)<script type="math/tex">o</script>p\equiv7\ (\text{mod } 12)<script type="math/tex">}
}\right.</script>
\item{(ii)} <script type="math/tex">% <![CDATA[
\leg{-3}{p}=\left\{\eqalign{1\
&\hbox{ si %]]></script>p\equiv1\ (\text{mod } 3)<script type="math/tex">% <![CDATA[
}\cr
-1\ &\hbox{ si %]]></script>p\equiv2\ (\text{mod } 3)<script type="math/tex">}
}\right.</script></p>

<p><b>DEMOSTRACIÓN:</b>  Por la ley de reciprocidad cuadrática, tenemos
<script type="math/tex">\leg{3}{p}=(-1)^{p-1\over2}\leg{p}{3}</script>. Por otra parte,
por la Proposición \propiedadessimbololegendre(iv),
tenemos <script type="math/tex">\leg{-1}{p}=(-1)^{p-1\over2}</script>. Por
tanto, <script type="math/tex">\leg{-3}{p}=\leg{-1}{p}\leg{3}{p}=\leg{p}{3}</script>, que
claramente viene dado por la fórmula de (ii). La parte (i)
se demuestra como el Corolario \legendremenosdos\ a partir
de (i).
\qed</p>

<p>\proclaim Corolario \primosdocekmasonce. Existen infinitos
números primos de la forma <script type="math/tex">12k+11</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Supongamos en primer lugar que <script type="math/tex">p_1,\dots,p_r</script> sean
todos los números primos de la forma <script type="math/tex">12k+11</script>.
Consideramos <script type="math/tex">a=12(p_1\dots p_r)^2-1</script>. Entonces, si <script type="math/tex">p</script>
es un divisor primo de <script type="math/tex">a</script> (necesariamente <script type="math/tex">p>3</script>), se
tiene que <script type="math/tex">6p_1\dots p_r</script> es una solución de
<script type="math/tex">x^2\equiv3\ (\text{mod } p)</script>. El Corolario
\legendretres(i) implica entonces que <script type="math/tex">p</script> es de la forma
<script type="math/tex">12k+1</script> o
<script type="math/tex">12k+11</script>. Como <script type="math/tex">a</script> es de la forma <script type="math/tex">12k+11</script>,
necesariamente tendrá algún divisor primo de
la forma <script type="math/tex">12k+11</script>, es decir, algún <script type="math/tex">p_i</script>, lo que es
absurdo.
\qed</p>

<p>\ejer{\primostreskmasuno} Demostrar que existen infinitos
números primos de la forma <script type="math/tex">3k+1</script>. Más aún, demostrar que existen infinitos
números primos de la forma <script type="math/tex">12k+7</script>.
%%%%% <script type="math/tex">a=(2p_1p_2\dots p_r)^2+3</script></p>

<p><b>EJEMPLO:</b> {<b>EJEMPLO:</b> ploreciprocidad} Veamos en un ejemplo práctico
cómo la Ley de Reciprocidad Cuadrática permite calcular
cualquier símbolo de Legendre. Supongamos que
queremos calcular <script type="math/tex">\leg{17}{41}</script>. Por la Ley de
Reciprocidad Cuadrática, podremos escribir
<script type="math/tex">\leg{17}{41}=\leg{41}{17}</script> y, como se tiene <script type="math/tex">41\equiv7\
(\text{mod }17)</script>, también tendremos <script type="math/tex">\leg{41}{17}=\leg{7}{17}</script>.
Por tanto, hemos reducido calcular un símbolo
<script type="math/tex">\leg{17}{41}</script> a calcular <script type="math/tex">\leg{7}{17}</script>, que involucra
números más peque\~nos. Es claro que podemos seguir el
proceso, escribiendo ahora
<script type="math/tex">\leg{7}{17}=\leg{17}{7}=\leg{3}{7}</script>, que es igual a <script type="math/tex">-1</script>
por el Corolario \legendretres. Por tanto,
<script type="math/tex">\leg{17}{41}=-1</script>.</p>

<p>\noindent Aprovechamos para hacer el mismo cálculo con
un truco distinto. Podemos escribir
<script type="math/tex"></script>\leg{17}{41}=\leg{-24}{41}=\leg{-2\cdot2^2\cdot3}{41}
=\leg{-2}{41}\leg{2^2}{41}\leg{3}{41}=1\cdot1\cdot(-1)=-1<script type="math/tex"></script>
donde los tres últimos símbolos han sido calculados
respectivamente con el Teorema \legendredos, la
Proposición \propiedadessimbololegendre(iii) y el
Corolario \legendretres(i).</p>

<p>Veamos, para terminar el capítulo, que el
símbolo de Legendre también mide cuándo un
número es un resto cuadrático módulo la potencia de
un primo:</p>

<p>\proclaim Teorema \potenciaslegendre. Si <script type="math/tex">p</script> es un primo
impar, <script type="math/tex">k\ge1</script>, y <script type="math/tex">\text{mcd}(a,p)=1</script>, entonces la congruencia
<script type="math/tex">x^2\equiv a\ (\text{mod } p^k)</script> tiene solución si y sólo si
<script type="math/tex">\leg{a}{p}=1</script>. Además, en tal caso, el número de
soluciones módulo <script type="math/tex">p^k</script> es dos.</p>

<p><b>DEMOSTRACIÓN:</b>  Obviamente, si <script type="math/tex">x^2\equiv a\ (\text{mod } p^k)</script> tiene
solución, también la tiene <script type="math/tex">x^2\equiv a\ (\text{mod } p)</script>, por
lo que <script type="math/tex">\leg{a}{p}=1</script>. Hay que demostrar entonces el
recíproco, que si <script type="math/tex">\leg{a}{p}=1</script> entonces <script type="math/tex">x^2\equiv a\
(\text{mod } p^k)</script> tiene solución. Lo haremos por inducción
sobre <script type="math/tex">k</script>, siendo trivial el caso <script type="math/tex">k=1</script>.</p>

<p>Supongamos entonces que <script type="math/tex">x^2\equiv a\ (\text{mod } p^k)</script> tiene
solución <script type="math/tex">x_0</script> y encontremos una solución de <script type="math/tex">x^2\equiv a\
(\text{mod } p^{k+1})</script>. Como las soluciones de esta segunda
congruencia son soluciones de la primera, en realidad
buscamos enteros de la forma <script type="math/tex">x_0+yp^k</script> que sean solución
de la segunda congruencia.</p>

<p>Que <script type="math/tex">x_0</script> sea solución de la primera congruencia quiere
decir que se puede escribir <script type="math/tex">x_0^2=a+bp^k</script>, para algún
<script type="math/tex">b\in\mathbb{Z}</script>. Por tanto, tendremos
<script type="math/tex"></script>(x_0+yp^k)^2=x_0^2+2x_0yp^k+y^2p^{2k}=a+(2x_0y+b)p^k+p^{2k}<script type="math/tex"></script>
de donde se deduce que <script type="math/tex">(x_0+yp^k)^2\equiv a\ (\text{mod } p^{k+1})</script>
si y sólo si <script type="math/tex">p\vert 2x_0y+b</script>. Como <script type="math/tex">\text{mcd}(2,p)=1</script>, la congruencia
<script type="math/tex">2x_0y+b\equiv0\ (\text{mod } p)</script> tiene solución, y tomando una
solución <script type="math/tex">y</script> se tiene que <script type="math/tex">x_0+yp^k</script> es una solución de
<script type="math/tex">x^2\equiv a\ (\text{mod } p^{k+1})</script>.</p>

<p>El hecho de que haya exactamente dos soluciones módulo
<script type="math/tex">p^k</script> es consecuencia del Teorema \congruenciaspotencia, ya
que <script type="math/tex">p^k</script> tiene raíces primitivas. Puede hacerse
también directamente, ya que, si <script type="math/tex">x_0</script> es una solución,
entonces cualquier otra solución <script type="math/tex">x</script> verifica <script type="math/tex">x^2\equiv
x_0^2\ (\text{mod } p^k)</script>, es decir,
<script type="math/tex">p^k\vert x^2-x_0^2=(x+x_0)(x-x_0)</script>. No puede ocurrir
simultáneamente <script type="math/tex">p\vert x+x_0</script> y <script type="math/tex">p\vert x-x_0</script>, ya que entonces
<script type="math/tex">p\vert (x+x_0)-(x-x_0)=2x_0</script> y, como <script type="math/tex">p</script> es un primo impar,
<script type="math/tex">p\vert x_0</script>, lo que contradice que <script type="math/tex">x_0^2\equiv1\ (\text{mod } p^k)</script>.
Por tanto <script type="math/tex">\text{mcd}(p^k,x+x_0)=1</script> o bien
<script type="math/tex">\text{mcd}(p^k,x-x_0)=1</script>, por lo que <script type="math/tex">p^k\vert x-x_0</script> o bien
<script type="math/tex">p^k\vert x+x_0</script>. Por tanto, <script type="math/tex">x\equiv x_0\ (\text{mod } p^k)</script> o bien
<script type="math/tex">x\equiv-x_0\ (\text{mod } p^k)</script>, y éstas son las únicas
soluciones.
\qed</p>

<p><b>EJEMPLO:</b> {<b>EJEMPLO:</b> plopotenciaslegendre} Veamos cómo se puede
seguir la demostración anterior para resolver
congruencias cuadráticas. Por ejemplo, como
<script type="math/tex">\leg{3}{13}=1</script> (por el Corolario \legendretres(i)),
entonces la ecuación <script type="math/tex">x^2\equiv3\ (\text{mod } 13^2)</script> tendrá
dos soluciones módulo <script type="math/tex">13^2</script>. En primer lugar, debemos
resolver la ecuación <script type="math/tex">x^2\equiv3\ (\text{mod } 13)</script>, y se ve a
ojo que <script type="math/tex">x\equiv\pm4\ (\text{mod } 13)</script> son las soluciones.
Trabajamos por elemplo con la solución <script type="math/tex">x_0=4</script>, y
tenemos que buscar ahora los valores de <script type="math/tex">y</script> para los que
<script type="math/tex">4+13y</script> es solución de <script type="math/tex">x^2\equiv3\ (\text{mod } 13^2)</script>.
Operando (mejor así que intentar aprenderse de
memoria la fórmula) queremos <script type="math/tex">16+104y+13^2y^2\equiv3\
(\text{mod } 13^2)</script>, es decir, <script type="math/tex">13(1+8y)\equiv0\ (\text{mod } 13^2)</script>, que
es equivalente a <script type="math/tex">1+8y\equiv0\ (\text{mod } 13)</script>. Congruencias
lineales de este tipo ya aprendimos a resolverlas en el
Capítulo \congruencias, y se comprueba fácilmente
que <script type="math/tex">y\equiv8\ (\text{mod } 13)</script> es la solución. Por tanto,
<script type="math/tex">x\equiv4+13\cdot8=108\ (\text{mod } 13^2)</script> es una solución.
Para calcular la segunda solución no hace falta empezar
con <script type="math/tex">x_0=-4</script>, ya que necesariamente
<script type="math/tex">x\equiv-108\equiv61\ (\text{mod } 13^2)</script> es la otra solución.</p>

<p>\bigskip</p>

<p>Nos queda ver el caso de restos cuadráticos módulo una
potencia de <script type="math/tex">2</script>, que estudiamos a continuación:</p>

<p>\proclaim Teorema \potenciasdoslegendre. Sea <script type="math/tex">a</script> un
número impar. Entonces:
\item{(i)} La congruencia <script type="math/tex">x^2\equiv a\ (\text{mod } 2)</script> tiene
siempre solución.
\item{(ii)} La congruencia <script type="math/tex">x^2\equiv a\ (\text{mod } 4)</script> tiene
solución si y sólo si <script type="math/tex">a\equiv1\ (\text{mod }4)</script>.
\item{(iii)} Si <script type="math/tex">k\ge3</script>, la congruencia <script type="math/tex">x^2\equiv a\ (\text{mod }
2^k)</script> tiene solución si y sólo si <script type="math/tex">a\equiv1\ (\text{mod }8)</script>.
Además, en este caso, la congruencia tiene exactamente dos
soluciones módulo <script type="math/tex">2^{k-1}</script></p>

<p><b>DEMOSTRACIÓN:</b>  La parte (i) es obvia, y la parte (ii) sigue del hecho
de que el cuadrado de cualquier número impar es de la forma
<script type="math/tex">4k+1</script>. Para parte (iii) observamos que, como el
cuadrado de un número impar es siempre de la forma <script type="math/tex">8k+1</script>,
entonces si la congruencia <script type="math/tex">x^2\equiv a\ (\text{mod }
2^k)</script> tiene solución, entonces <script type="math/tex">a\equiv1\ (\text{mod }8)</script>.
Demostraremos el recíproco por inducción sobre <script type="math/tex">k</script>,
siendo el caso <script type="math/tex">k=3</script> trivial (las soluciones módulo <script type="math/tex">4</script> son
<script type="math/tex">1</script> y <script type="math/tex">3</script>). Supongamos entonces que
<script type="math/tex">x^2\equiv a\ (\text{mod } 2^k)</script> tiene solución, es decir, que
existe <script type="math/tex">x_0\in\mathbb{Z}</script> tal que <script type="math/tex">x_0^2=a+2^kb</script> para algún
<script type="math/tex">b\in\mathbb{Z}</script>. Veamos que existe una solución de <script type="math/tex">x^2\equiv a\
(\text{mod } 2^{k+1})</script> de la forma <script type="math/tex">x=x_0+2^{k-1}y</script>. En efecto,
como 
<script type="math/tex"></script>(x_0+2^{k-1}y)^2=x_0^2+2^kx_0y+2^{2k-2}y^2=a+2^k(b+x_0y)+2^{2k-2}y^2<script type="math/tex"></script>
y <script type="math/tex">x_0</script> es impar, si tomamos <script type="math/tex">y</script> de la misma paridad que
<script type="math/tex">b</script> tendremos que <script type="math/tex">x_0+2^{k-1}y</script> es solución de <script type="math/tex">x^2\equiv
a\ (\text{mod } 2^{k+1})</script>.</p>

<p>Además, si <script type="math/tex">x_0</script> es una solución de <script type="math/tex">x^2\equiv a\ (\text{mod }
2^k)</script>, entonces para cualquier otra solución <script type="math/tex">x</script> se verifica
<script type="math/tex"></script>2^k\vert x^2-x_0^2=(x+x_0)(x-x_0)<script type="math/tex"></script>
y, como el máximo común divisor de <script type="math/tex">x+x_0</script> y <script type="math/tex">x-x_0</script> es
divisible por <script type="math/tex">2</script> pero no por <script type="math/tex">4</script>, se sigue que <script type="math/tex">x\equiv-x_0\
(\text{mod } 2^{k-1})</script> o <script type="math/tex">x\equiv x_0\
(\text{mod } 2^{k-1})</script>.
\qed</p>
