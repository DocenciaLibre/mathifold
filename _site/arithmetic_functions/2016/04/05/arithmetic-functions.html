<p>Vamos a intentar extender ahora el Teorema de  Fermat (Teorema \fermat) cuando el exponente es un número arbitrario <script type="math/tex">n</script> no necesariamente primo. Mirando a la demostración, vamos a necesitar multiplicar sólo los restos módulo <script type="math/tex">n</script> que sean coprimos con <script type="math/tex">n</script> (pues si no, no podríamos cancelarlos luego). Ahora bien, ?`cuántos restos hay coprimos con <script type="math/tex">n</script>? Claramente, esto dependerá de <script type="math/tex">n</script>, es decir, será una función, a la que de momento damos un nombre (nuestro objetivo en este capítulo será estudiar funciones de este tipo):</p>

<p><b>DEFINICIÓN:</b>  Se llama {\it función <script type="math/tex">\phi</script> de Euler} a la función <script type="math/tex">\phi:\mathbb{Z}_{\ge1}\to\mathbb{Z}</script> que asocia a cada entero <script type="math/tex">n\ge1</script> el número <script type="math/tex">\phi(n)</script> de enteros <script type="math/tex">r\in\{1,2,\dots,n\}</script> tales que <script type="math/tex">\text{mcd}(r,n)=1</script>. Nótese que, como ni <script type="math/tex">r=0</script> ni <script type="math/tex">r=n</script> verifican <script type="math/tex">\text{mcd}(r,n)=1</script>, se puede definir también <script type="math/tex">\phi(n)</script> como el número de enteros <script type="math/tex">r\in\{0,1,\dots,n-1\}</script> tales que <script type="math/tex">\text{mcd}(r,n)=1</script>.</p>

<p>Con esta definición, la generalización del Lema \sistemarestos\ (en realidad sólo la implicación que nos intereresa) es la siguiente:</p>

<p><b>LEMA:</b>  Lema \restosprimos. Sea <script type="math/tex">n</script> un número entero positivo y sean <script type="math/tex">r_1,r_2,\dots,r_m</script> números enteros enteros tales que, <script type="math/tex">m\ge\phi(n)</script>, para todo <script type="math/tex">i=1,2,\dots,m</script> se tiene <script type="math/tex">\text{mcd}(r_i,n)=1</script> y <script type="math/tex">\text{mcd}(r_i,r_j)=1</script> si <script type="math/tex">j\ne i</script>. Entonces, los restos de la división euclídea de <script type="math/tex">r_1,r_2,\dots,r_m</script> entre <script type="math/tex">n</script> son todos distintos y coinciden, en cierto orden, con los números entre <script type="math/tex">0</script> y <script type="math/tex">n</script> que son coprimos con <script type="math/tex">n</script>.</p>

<p><b>DEMOSTRACIÓN:</b> Consideramos en primer lugar los números <script type="math/tex">s_1,s_2,\dots,s_r\in\{0,1,\dots,n-1\}</script> tales que <script type="math/tex">\text{mcd}(s_j,n)\ne1</script> para <script type="math/tex">j=1,2,\dots,r</script>. Obsérvese que, por definición, <script type="math/tex">r=n-\phi(n)</script>. Como <script type="math/tex">s_1,s_2,\dots,s_r</script> forman parte de un sistema completo de restos módulo <script type="math/tex">n</script>, son incongruentes dos a dos módulo <script type="math/tex">n</script>. Además, ningún <script type="math/tex">r_i</script> es congruente módulo <script type="math/tex">n</script> con ningún <script type="math/tex">s_j</script>, ya que eso querría decir que <script type="math/tex">\text{mcd}(r_i,n)=\text{mcd}(s_j,n)</script>, contra nuestra hipótesis. Por tanto, por el Lema \sistemarestos, como <script type="math/tex">m+r=m+n-\phi(m)\ge n</script>, se tiene que los restos de la división de <script type="math/tex">r_1,r_2,\dots,r_m,s_1,s_2,\dots,s_r</script> entre <script type="math/tex">n</script> son todos distintos y coinciden, en cierto orden con <script type="math/tex">0,1,\dots,n-1</script>. Como los restos de <script type="math/tex">s_1,s_2,\dots,s_r</script> son ellos mismos, el resultado queda demostrado. \qed</p>

<p>Con estas herramientas, podemos proceder ya a generalizar el Teorema de Fermat:</p>

<p><b>LEMA:</b>  Teorema \Euler\ {\rm (Euler)}. Dado un número entero <script type="math/tex">n\ge2</script>, entonces para cada número entero <script type="math/tex">a</script> tal que <script type="math/tex">\text{mcd}(a,n)=1</script> se tiene <script type="math/tex">a^{\phi(n)}\equiv1\ (\text{mod } n)</script>.</p>

<p><b>DEMOSTRACIÓN:</b> Sean <script type="math/tex">r_1,\dots,r_{\phi(n)}</script> los enteros positivos menores que <script type="math/tex">n</script> tales que <script type="math/tex">\text{mcd}(r_i,n)=1</script>. Como <script type="math/tex">\text{mcd}(a,n)=1</script>,  la Proposición \productocoprimos\ implica que <script type="math/tex">\text{mcd}(ar_i,n)=1</script> para todo <script type="math/tex">i=1,2,\dots,\phi(n)</script> y, si <script type="math/tex">j\ne i</script>, la Proposición \propiedadescongruencias(vi) implica <script type="math/tex">ar_i\not\equiv ar_j\ (\text{mod } n)</script>. Por el Lema \restosprimos, los números <script type="math/tex">ar_1,\dots,ar_{\phi(n)}</script> son congruentes, en algún orden, con <script type="math/tex">r_1,\dots,r_{\phi(n)}</script> módulo <script type="math/tex">n</script>. Por tanto, haciendo el producto de todos ellos tendremos <script type="math/tex"></script>a^{\phi(n)}r_1\dots r_{\phi(n)}\equiv r_1\dots r_{\phi(n)}\ (\text{mod } n).<script type="math/tex"></script> Como <script type="math/tex">\text{mcd}(r_1\dots r_{\phi(n)},n)=1</script> (por la Proposición \productocoprimos), la Proposición \propiedadescongruencias(vi) implica <script type="math/tex">a^{\phi(n)}\equiv1\ (\text{mod } n)</script>. \qed</p>

<p>Como consecuencia, obtenemos un método práctico para resolver una congruencia lineal:</p>

<p><b>LEMA:</b>  Corolario \congruenciaEuler. Si <script type="math/tex">\text{mcd}(a,n)=1</script>, la congruencia lineal  <script type="math/tex">ax\equiv b\ (\text{mod } n)</script> es equivalente a <script type="math/tex">x\equiv a^{\phi(n)-1}b\ (\text{mod } n)</script>.  %%%%NO SE USA</p>

<p><b>DEMOSTRACIÓN:</b> Por la Proposición \congruencialineal), la congruencia tiene una única solución, así que basta ver que <script type="math/tex">a^{\phi(n)-1}b</script> es una solución. Pero esto es inmediato, ya que <script type="math/tex">a(a^{\phi(n)-1}b)=a^{\phi(n)}b</script> es, por el Teorema de Euler, congruente con <script type="math/tex">b</script> módulo <script type="math/tex">n</script>. \qed</p>

<p>\obs{\calculophiprimo} Claramente, el Teorema de Euler es una generalización del peque\~no teorema de Fermat, ya que si <script type="math/tex">p</script> es un número primo es claro que <script type="math/tex">\phi(p)=p-1</script> (puesto que <script type="math/tex">1,2,\dots,p-1</script> son los números coprimos con <script type="math/tex">p</script> y menores que él). Más en general, si <script type="math/tex">n=p^k</script>, con <script type="math/tex">p</script> número primo, es claro que los enteros positivos menores o iguales que <script type="math/tex">n</script> que no son primos con <script type="math/tex">n</script> son los múltiplos de <script type="math/tex">p</script>, es decir, <script type="math/tex">1\cdot p,2\cdot p,\dots, p^{k-1}\cdot p</script>. Como hay <script type="math/tex">p^{k-1}</script> de ellos, se sigue entonces que <script type="math/tex"></script>\phi(p^k)=p^k-p^{k-1}=p^{k-1}(p-1)=p^k(1-{1\over p}).<script type="math/tex"></script></p>

<p>Calcular <script type="math/tex">\phi(n)</script> para un <script type="math/tex">n</script> arbitrario no parece a priori fácil. Sin embargo, tenemos la siguiente propiedad que resuelve el problema.</p>

<p><b>LEMA:</b>  Teorema \phimultiplicativo. Si <script type="math/tex">\text{mcd}(m,n)=1</script>, entonces <script type="math/tex">\phi(mn)=\phi(m)\phi(n)</script>.</p>

<p><b>DEMOSTRACIÓN:</b> Escribimos los primeros <script type="math/tex">mn</script> números en forma de rectángulo <script type="math/tex">n\times m</script>:</p>

<p><script type="math/tex"></script>\matrix{
 1  &amp;  2 &amp;\dots&amp;  i &amp;\dots&amp;m-1 &amp;m\cr
m+1 &amp; m+2&amp;\dots&amp; m+i&amp;\dots&amp;2m-1&amp;2m\cr
\vdots&amp;\vdots&amp;&amp;\vdots&amp;&amp;\vdots&amp;\vdots\cr
jm+1&amp;jm+2&amp;\dots&amp;jm+i&amp;\dots&amp;jm+m-i&amp;(j+1)m\cr
\vdots&amp;\vdots&amp;&amp;\vdots&amp;&amp;\vdots&amp;\vdots\cr
(n-1)m+1&amp;(n-1)m+2&amp;\dots&amp;(n-1)m+i&amp;\dots&amp;mn-1&amp;mn}<script type="math/tex"></script></p>

<p>es decir, escribimos cada número como <script type="math/tex">jm+i</script>, con <script type="math/tex">i=1,2,\dots,m</script> y <script type="math/tex">j=0,1,\dots,n-1</script>. Por la Proposición \productocoprimos, un número es primo con <script type="math/tex">mn</script> si y sólo si es primo con <script type="math/tex">m</script> y con <script type="math/tex">n</script>, luego <script type="math/tex">\phi(mn)</script> será el número de elementos <script type="math/tex">jm+i</script> que son primos con <script type="math/tex">m</script> y con <script type="math/tex">n</script>. La primera observación es que (por la Proposición \propiedadesMCD(i)) <script type="math/tex">\text{mcd}(jm+i,m)=\text{mcd}(i,m)</script>, luego el que un número <script type="math/tex">jm+i</script> sea primo con <script type="math/tex">m</script> depende sólo de la columna <script type="math/tex">i</script>-ésima en que está. Por la propia definición de <script type="math/tex">\phi</script>, tendremos exactamente <script type="math/tex">\phi(m)</script> valores de <script type="math/tex">i</script> tales que <script type="math/tex">\text{mcd}(i,m)=1</script>, es decir, que los elementos de la tabla que son primos con <script type="math/tex">m</script> son los elementos de <script type="math/tex">\phi(m)</script> columnas.</p>

<p>Queda entonces ver cuántos elementos en cada columna de las <script type="math/tex">\phi(n)</script> anteriores son además primos con <script type="math/tex">n</script>. De hecho, el teorema quedará demostrado si vemos que cada una de esas columnas tiene exactamente <script type="math/tex">\phi(n)</script> elementos primos con <script type="math/tex">n</script>. De hecho, cualquier columna de la matriz tiene exactamente <script type="math/tex">\phi(n)</script> elementos primos con <script type="math/tex">n</script>. En efecto, los elementos de una columna son de la forma <script type="math/tex">i,m+i,2m+i,\dots (n-1)m+i</script> que, por la Proposición \ejemplosrestos(iii), forman un sistema completo de restos módulo <script type="math/tex">n</script>. Por tanto, son congruentes, aunque posiblemente en otro orden, a <script type="math/tex">0,1,2,\dots,n-1</script>, por lo que hay exactamente <script type="math/tex">\phi(n)</script> que sean coprimos con <script type="math/tex">n</script>. \qed</p>

<p><b>LEMA:</b>  Corolario \formulaphi. Si <script type="math/tex">n=p_1^{k_1}p_2^{k_2}\dots p_r^{k_r}</script> es la descomposición de <script type="math/tex">n</script> en factores primos, entonces <script type="math/tex">\phi(n)=p_1^{k_1-1}p_2^{k_2-1}\dots p_r^{k_r-1} (p_1-1)(p_2-1)\dots(p_r-1)
=n(1-{1\over p_1})(1-{1\over p_2})\dots(1-{1\over p_r})</script>.</p>

<p><b>DEMOSTRACIÓN:</b> Es consecuencia inmediata de que, aplicando reiteradamente el Teorema \phimultiplicativo, se tiene <script type="math/tex">\phi(p_1^{k_1}p_2^{k_2}\dots p_r^{k_r}) =\phi(p_1^{k_1})\phi(p_2^{k_2})\dots\phi(p_r^{k_r})</script>, y por otra parte, como vimos en la Observación \calculophiprimo, para cada <script type="math/tex">i=1,2,\dots,r</script> se tiene <script type="math/tex">\phi(p_i^{k_i})=p_i^{k_i-1}(p_i-1)</script>. \qed</p>

<p>\ejem{\EulerFermat} Aunque el teorema de Euler sea una generalización del de Fermat, normalmente con este último se puedun obtener resultados mejores. Por ejemplo, para estudiar cuándo una potencia es congruente con <script type="math/tex">1</script> módulo <script type="math/tex">35</script>, el teorema de Euler diría que, como <script type="math/tex"></script>\phi(35)=\phi(5\cdot7)=\phi(5)\phi(7)=(5-1)(7-1)=24,<script type="math/tex"></script> entonces <script type="math/tex">a^{24}\equiv1\ (\text{mod } 35)</script> si <script type="math/tex">\text{mcd}(a,35)=1</script>. Sin embargo, como <script type="math/tex">\text{mcd}(a,35)=1</script> es equivalente a <script type="math/tex">\text{mcd}(a,5)=1=\text{mcd}(a,7)</script> (ver Proposición \productocoprimos), por el teorema de Fermat se tiene
<script type="math/tex"></script>a^4\equiv1\ (\text{mod } 5)<script type="math/tex"></script> y 
<script type="math/tex"></script>a^6\equiv1\ (\text{mod } 7).<script type="math/tex"></script> 
Elevando respectivamente al cubo y al cuadrado se tendrá 
<script type="math/tex"></script>a^{12}\equiv1\ (\text{mod } 5)<script type="math/tex"></script> y 
<script type="math/tex"></script>a^{12}\equiv1\ (\text{mod } 7),<script type="math/tex"></script>
de donde se deduce <script type="math/tex">a^{12}\equiv1\ (\text{mod } 35)</script>.</p>

<p><b>DEFINICIÓN:</b>  Una {\it función aritmética} es una función <script type="math/tex">f:\mathbb{Z}_{\ge1}\to\mathbb{Z}</script>. Se dice además que es {\it multiplicativa} si <script type="math/tex">f(mn)=f(m)f(n)</script> cuando <script type="math/tex">\text{mcd}(m,n)=1</script>.</p>

<p>\ejem{\multiplicativastriviales} De forma trivial se pueden construir varias funciones aritméticas multiplicativas:</p>

<p>1) La función idénticamente cero es claramente multiplicativa.</p>

<p>2) Si una función multiplicativa <script type="math/tex">f</script> no es idénticamente cero, existe <script type="math/tex">n\in\mathbb{Z}_{\ge1}</script> tal que <script type="math/tex">f(n)\ne0</script>. Como se tiene <script type="math/tex">f(n)=f(n\cdot1)=f(n)f(1)</script>, se sigue entonces <script type="math/tex">f(1)=1</script>. Esto sugiere otro segundo ejemplo trivial de función aritmética multiplicativa: <script type="math/tex"></script>f(n)=\left{\matrix{1\hfil&amp;\hbox{ si } n=1\hfill\cr  0\hfil&amp;\hbox{ si } n&gt;1 \hfill}\right.<script type="math/tex"></script></p>

<p>3) De la misma forma, la función idénticamente uno es claramente multiplicativa.</p>

<p>4) La función identidad <script type="math/tex">id(n)=n</script> es también claramente multiplicativa.</p>

<p>5) Más en general, aunque no vayamos a usarla, para cada <script type="math/tex">k\ge0</script>, la función <script type="math/tex">f(n)=n^k</script> es multiplicativa.</p>

<p>\bigskip</p>

<p>Todos los ejemplos anteriores son <code class="highlighter-rouge">mucho más multiplicativos'' que la función $$\phi$$, ya que $$f(mn)=f(m)f(n)$$ independientemente de que $$m$$ y $$n$$ tengan factores en común o no. El siguiente resultado nos dará un modo de calcular funciones multiplicativas</code>más serias’’ a partir de otras funciones multiplicativas, aunque sean triviales:</p>

<p><b>LEMA:</b>  Teorema \generacionmultiplicativas. Si <script type="math/tex">f</script> es una función aritmética multiplicativa, entonces la función <script type="math/tex"></script>F(n)=\sum_{d\vert n}f(d)<script type="math/tex"></script> es también una función multiplicativa.</p>

<p><b>DEMOSTRACIÓN:</b> Sean <script type="math/tex">m,n\in\mathbb{Z}_{\ge1}</script> tales que <script type="math/tex">\text{mcd}(m,n)=1</script>. Por el Corolario \divisoresproducto(i), cada divisor positivo de <script type="math/tex">mn</script> se puede escribir como <script type="math/tex">dd'</script> con <script type="math/tex">d\vert m</script> y <script type="math/tex">d'\vert n</script>. Podemos entonces escribir <script type="math/tex"></script>F(mn)=\sum_{d\vert m,d’\vert n}f(dd’)=\sum_{d\vert m,d’\vert n}f(d)f(d’)= \big(\sum_{d\vert m}f(d)\big)\big(\sum_{d’\vert n}f(d’)\big)= F(m)F(n).<script type="math/tex"></script> \qed</p>

<p>\ejem{\ejemplosgeneracion} Apliquemos la construcción anterior a los ejemplos que tenemos de funciones multiplicativas.</p>

<p>1) Evidentemente, si <script type="math/tex">f</script> es idénticamente cero, entonces <script type="math/tex">F</script> también lo es.</p>

<p>2) Si <script type="math/tex">f</script> vale cero para todo <script type="math/tex">n</script>, excepto para <script type="math/tex">f(1)=1</script>, es claro que entonces <script type="math/tex">F</script> es constantemente <script type="math/tex">1</script>.</p>

<p>3) Cuando <script type="math/tex">f</script> es la función constante <script type="math/tex">1</script>, se suele escribir <script type="math/tex">\tau</script> para la función <script type="math/tex">F</script> correspondiente, y se tiene que <script type="math/tex">\tau(n)</script> es el número de divisores positivos de <script type="math/tex">n</script>.</p>

<p>4) Cuando <script type="math/tex">f=id</script>, la función <script type="math/tex">F</script> se suele denotar <script type="math/tex">\sigma</script>, y se tiene que <script type="math/tex">\sigma(n)</script> es la suma de los divisores positivos de <script type="math/tex">n</script>.</p>

<p>5) Cuando <script type="math/tex">f=\phi</script>, en principio no es fácil deducir quién es <script type="math/tex">F</script>. La ventaja es que sabemos que <script type="math/tex">F</script> es multiplicativa, por lo que basta calcularla para potencias de primos. Usando que los divisores de una potencia de un primo <script type="math/tex">p</script> son las potencias menores de <script type="math/tex">p</script>, tendremos, por la Observación \calculophiprimo:
<script type="math/tex"></script>F(p^k)=\phi(1)+\phi(p)+\phi(p^2)+
\dots+\phi(p^{k-1})+\phi(p^k)=<script type="math/tex"></script>
<script type="math/tex"></script>=1+(p-1)+(p^2-p)+\dots+(p^{k-1}-p^{k-2})+(p^k-p^{k-1})
=p^k.<script type="math/tex"></script>
Por tanto, <script type="math/tex">F</script> es la identidad en potencias de primos, y por
ser multiplicativa se tendrá <script type="math/tex">F=id</script>. En otras palabras,
hemos demostrado que para todo <script type="math/tex">n\in\mathbb{Z}_{\ge1}</script> se verifica:
<script type="math/tex"></script>\sum_{d\vert n}\phi(d)=n<script type="math/tex"></script></p>

<p>\obs{\formulatausigma} El hecho de que las funciones <script type="math/tex">\tau</script> y <script type="math/tex">\sigma</script> anteriores son multiplicativas se puede deducir directamente de su propia definición. En efecto, dado un número <script type="math/tex">p_1^{k_1}p_2^{k_2}\dots p_r^{k_r}</script>, con <script type="math/tex">p_1,\dots,p_r</script> primos distintos, sus divisores son (por la Proposición \divisoresnumero) los números de la forma <script type="math/tex">p_1^{a_1}\dots p_r^{a_r}</script> con <script type="math/tex">0\le a_i\le k_i</script>, es decir, los sumandos de 
<script type="math/tex"></script>(1+p_1+p_1^2+\dots+p_1^{k_1})
(1+p_2+p_2^2+\dots+p_2^{k_2})\dots
(1+p_r+p_r^2+\dots+p_r^{k_r}).<script type="math/tex"></script>
Claramente hay <script type="math/tex">(k_1+1)(k_2+1)\dots(k_r+1)</script> sumandos por lo
que 
<script type="math/tex"></script>\tau(p_1^{k_1}p_2^{k_2}\dots
p_r^{k_r})=(k_1+1)(k_2+1)\dots(k_r+1)<script type="math/tex"></script>
y
<script type="math/tex"></script>\sigma(p_1^{k_1}p_2^{k_2}\dots
p_r^{k_r})=(1+p_1+p_1^2+\dots+p_1^{k_1})
(1+p_2+p_2^2+\dots+p_2^{k_2})\dots
(1+p_r+p_r^2+\dots+p_r^{k_r})<script type="math/tex"></script>
o equivalentemente
<script type="math/tex"></script>\sigma(p_1^{k_1}p_2^{k_2}\dots
p_r^{k_r})={p_1^{k_1+1}-1\over p_1-1}
{p_2^{k_21+1}-1\over p_2-1}\dots
{p_r^{k_r+1}-1\over p_r-1}.<script type="math/tex"></script>
Con estas descripciones, si <script type="math/tex">\text{mcd}(m,n)=1</script>, eso quiere decir que sus factorizaciones son, como en la demostración del Teorema \generacionmultiplicativas, de la forma <script type="math/tex">m=p_1^{k_1}p_2^{k_2}\dots p_r^{k_r}</script> y <script type="math/tex">n=q_1^{l_1}q_2^{l_2}\dots q_s^{l_s}</script>, con <script type="math/tex">p_i\ne q_j</script> para todo <script type="math/tex">i=1,2,\dots,r</script> y <script type="math/tex">j,1,2,\dots,s</script>. Por tanto, <script type="math/tex">mn</script> factoriza como <script type="math/tex">mn=p_1^{k_1}p_2^{k_2}\dots p_r^{k_r}q_1^{l_1}q_2^{l_2}\dots q_s^{l_s}</script>, y se tiene  <script type="math/tex"></script>\tau(mn)=(k_1+1)(k_2+1)\dots(k_r+1) (l_1+1)(l_2+1)\dots(l_s+1)=\tau(m)\tau(n)<script type="math/tex"></script> y</p>

<p><script type="math/tex"></script>\sigma(mn)={p_1^{k_1+1}-1\over p_1-1}
{p_2^{k_21+1}-1\over p_2-1}\dots
{p_r^{k_r+1}-1\over p_r-1}
{q_1^{l_1+1}-1\over q_1-1}
{q_2^{l_21+1}-1\over q_2-1}\dots
{q_r^{l_s+1}-1\over q_s-1}=\sigma(m)\sigma(n)<script type="math/tex"></script></p>

<p>En el Ejemplo \ejemplosgeneracion\ hemos visto que, aplicando la construcción del Teorema \generacionmultiplicativas, el ejemplo 2 genera el 3 y que el 3 genera la función <script type="math/tex">\tau</script>, mientras que el ejemplo 4 genera la función <script type="math/tex">\sigma</script> y está generado por la función <script type="math/tex">\phi</script>. Cabe preguntarse, por tanto, si el ejemplo 2 está generado a partir de alguna función aritmética. El siguiente resultado nos da la respuesta:</p>

<p><b>LEMA:</b>  Proposición \funcionmu. Sea <script type="math/tex">\mu:\mathbb{Z}_{\ge1}\to\{-1,0,1\}</script> la función definida por: <script type="math/tex"></script>\mu(n)=\left{\matrix{1\hfil&amp;\hbox{ si } n=1\hfill\cr 0\hfil&amp;\hbox{ si existe un primo <script type="math/tex">p</script> tal que }p^2\vert n\hfill\cr (-1)^r&amp;\hbox{ si <script type="math/tex">n=p_1p_2\dots p_r</script> con <script type="math/tex">p_1,p_2,\dots,p_r</script> primos distintos\hfill}}\right.<script type="math/tex"></script> Entonces
\item{(i)} <script type="math/tex">\mu</script> es multiplicativa.
\item{(ii)} <script type="math/tex">% <![CDATA[
\sum_{d\vert n}\mu(d)=
\left\{\matrix{1\hfil&\hbox{ si } n=1\hfill\cr 
0\hfil&\hbox{ si } n>1. \hfill}\right. %]]></script></p>

<p><b>DEMOSTRACIÓN:</b> Veamos primero la parte (i). Sean por tanto <script type="math/tex">m,n\in\mathbb{Z}_{\ge1}</script> con <script type="math/tex">\text{mcd}(m,n)=1</script>. Distinguimos tres casos:</p>

<p>–Si <script type="math/tex">m=1</script> o <script type="math/tex">n=1</script>, es evidente que <script type="math/tex">\mu(mn)=\mu(m)\mu(n)</script>, ya que <script type="math/tex">\mu(1)=1</script>.</p>

<p>–Si existe un primo <script type="math/tex">p</script> cuyo cuadrado divide a <script type="math/tex">m</script> (resp. <script type="math/tex">n</script>), entonces su cuadrado divide también a <script type="math/tex">mn</script>, luego <script type="math/tex">\mu(mn)=0</script>, que conicide con <script type="math/tex">\mu(m)\mu(n)</script> ya que <script type="math/tex">\mu(m)</script> (resp. <script type="math/tex">\mu(n)</script>) es cero.</p>

<p>–Finalmente si ni <script type="math/tex">m</script> ni <script type="math/tex">n</script> son divisibles por cuadrados de primos, se podrá escribir <script type="math/tex">m=p_1\dots p_r</script> y <script type="math/tex">q_1\dots q_s</script>, con <script type="math/tex">p_1,\dots,p_r,q_1,\dots,q_s</script> primos distintos. Por tanto, <script type="math/tex">mn=p_1\dots p_rq_1\dots q_s</script> y se tendrá <script type="math/tex"></script>\mu(mn)=(-1)^{r+s}=(-1)^r(-1)^s=\mu(m)\mu(n).<script type="math/tex"></script></p>

<p>Para la parte (ii), definimos <script type="math/tex">F(n)=\sum_{d\vert n}\mu(d)</script>, que será multiplicativa por (i) y el Teorema \generacionmultiplicativas. Por tanto, basta comprobar que <script type="math/tex">F(1)=1</script> (lo que es evidente, ya que <script type="math/tex">F(1)=\mu(1)=1</script>) y que si <script type="math/tex">p</script> es un número primo y <script type="math/tex">k>0</script> entonces <script type="math/tex">F(p^k)=0</script>. Esto último sigue de que los divisores de <script type="math/tex">p^k</script> son <script type="math/tex">1,p,p^2,\dots,p^k</script>, y que por definición <script type="math/tex">\mu(p^j)=0</script> si <script type="math/tex">j\ge2</script>, por lo que <script type="math/tex"></script>F(p^k)=\mu(1)+\mu(p)+\mu(p^2)+\dots+\mu(p^k)= 1+(-1)^1+0+\dots+0=0.<script type="math/tex"></script> \qed</p>

<p><b>DEFINICIÓN:</b>  La función <script type="math/tex">\mu</script> definida en el teorema anterior se llama {\it función de M"obius}.</p>

<p><b>LEMA:</b>  Teorema \inversionmobius. Sea <script type="math/tex">f</script> una función aritmética (no
necesariamente multiplicativa) y sea <script type="math/tex">F</script> la función definida por
<script type="math/tex">F(n)=\sum_{d\vert n}f(d)</script>. Entonces:
\item{(i)} (Fórmula de
inversión de M"obius) <script type="math/tex">f(n)=\sum_{d\vert n}\mu(d)F({n\over d})=
\sum_{d\vert n}\mu({n\over d})F(d).</script>
\item{(ii)} <script type="math/tex">\sum_{i=1}^nF(i)=\sum_{k=1}^n\ent{n}{k}f(k)</script>.</p>

<p><b>DEMOSTRACIÓN:</b> Es claro que, en (i), las dos expresiones para <script type="math/tex">f(n)</script> son iguales, así que basta demostrarlo para la primera expresión. Tendremos entonces:
<script type="math/tex"></script>\sum_{d\vert n}\mu(d)F({n\over d})=
\sum_{d\vert n}\mu(d)\big(\sum_{c\vert {n\over d}}f(c)\big)=
\sum_{d\vert n,c\vert {n\over d}}\mu(d)f(c).<script type="math/tex"></script>
La primera observación ahora es que el conjunto de pares <script type="math/tex">(d,c)</script> tales que <script type="math/tex">d\vert n</script> y <script type="math/tex">c\vert {n\over d}</script> es igual al conjunto de pares <script type="math/tex">(d,c)</script> tales que <script type="math/tex">c\vert n</script> y <script type="math/tex">d\vert {n\over c}</script>. Por tanto, la igualdad anterior prosigue como
<script type="math/tex"></script>\sum_{d\vert n}\mu(d)F({n\over d})=
\sum_{c\vert n,d\vert {n\over c}}\mu(d)f(c)=
\sum_{c\vert n}f(c)\big(\sum_{d\vert {n\over c}}\mu(d)\big).<script type="math/tex"></script>
Ahora bien, por la Proposición \funcionmu\ sabemos que
<script type="math/tex"></script>\sum_{d\vert {n\over c}}\mu(d)=
\left{\matrix{1\hfil&amp;\hbox{ si } {n\over c}=1\hfill\cr 
0\hfil&amp;\hbox{ si } {n\over c}&gt;1, \hfill}\right.<script type="math/tex"></script> 
por lo que <script type="math/tex">\sum_{c\vert n}f(c)\big(\sum_{d\vert {n\over
c}}\mu(d)\big)=f(n)</script>.</p>

<p>Para demostrar (ii), tenemos que 
<script type="math/tex"></script>\sum_{i=1}^nF(i)=\sum_{i=1}^n\big(\sum_{d\vert i}f(d)\big)
=\sum_{i=1}^n \sum_{d\vert i}f(d).<script type="math/tex"></script>
La observación central es que basta demostrar que, para cada <script type="math/tex">k=1,\dots,n</script>, <script type="math/tex">f(k)</script> aparece <script type="math/tex">\ent{n}{k}</script> veces en la suma anterior. Y en efecto, <script type="math/tex">k</script> aparecerá tantas veces como <script type="math/tex">k</script> sea un divisor de un número <script type="math/tex">i\in\{1,2,\dots,n\}</script>. Como <script type="math/tex">k</script> es divisor de <script type="math/tex">1\cdot k,2\cdot k,\dots,\ent{n}{k}k</script>, el resultado sigue inmediatamente.
\qed</p>

<p>\ejem{\ejemplosinversion} Aplicando el resultado anterior a los casos 3, 4, y 5 del Ejemplo \ejemplosgeneracion, deducimos respectivamente las siguientes fórmulas para todo <script type="math/tex">n\in\mathbb{Z}_{\ge1}</script>:</p>

<p>Si <script type="math/tex">f=1</script> y <script type="math/tex">F=\tau</script>:
<script type="math/tex"></script>\sum_{d\vert n}\mu({n\over d})\tau(d)=1<script type="math/tex"></script>
<script type="math/tex"></script>\sum_{i=1}^n\tau(i)=\sum_{k=1}^n\ent{n}{k},<script type="math/tex"></script>
si <script type="math/tex">f=id</script> y <script type="math/tex">F=\sigma</script>:
<script type="math/tex"></script>\sum_{d\vert n}\mu({n\over d})\sigma(d)=n<script type="math/tex"></script>
<script type="math/tex"></script>\sum_{i=1}^n\sigma(i)=\sum_{k=1}^n\big\lbrack{n\over
k}\big\rbrack k<script type="math/tex"></script>
y si <script type="math/tex">f=\phi</script> y <script type="math/tex">F=id</script>:
<script type="math/tex"></script>\phi(n)=n\sum_{d\vert n}{\mu(d)\over d}=\sum_{d\vert n}\mu({n\over
d})d<script type="math/tex"></script>
<script type="math/tex"></script>\sum_{i=1}^n i=\sum_{k=1}^n\big\lbrack{n\over
k}\big\rbrack\phi(k)<script type="math/tex"></script>
\bigskip</p>

<p>Veamos alguna aplicación de las funciones <script type="math/tex">\tau</script> y <script type="math/tex">\sigma</script> en teoría de números.</p>

<p>\ejem{\primossigmatau} La primera observación es que es
equivalente que un número <script type="math/tex">n</script> sea primo a que <script type="math/tex">\tau(n)=2</script>
o <script type="math/tex">\sigma(n)=1+n</script>. Las fórmulas anteriores nos dan en
realidad una fórmula para calcular estas funciones para
un número <script type="math/tex">n</script> del que no sabemos si factoriza. En efecto,
la observación es que en general
<script type="math/tex">F(n)=\sum_{i=1}^nF(i)-\sum_{i=1}^{n-1}F(i)</script>, así que,
por ejemplo, tendremos la fórmula, para <script type="math/tex">n>1</script>,
<script type="math/tex"></script>\tau(n)=\sum_{k=1}^n\big\lbrack{n\over
k}\big\rbrack-\sum_{k=1}^{n-1}\big\lbrack{n-1\over
k}\big\rbrack=2+\sum_{k=2}^{n-1}\big(\big\lbrack{n\over
k}\big\rbrack-\big\lbrack{n-1\over
k}\big\rbrack\big).<script type="math/tex"></script>
Por ejemplo, para <script type="math/tex">n=7</script>, podemos escribir
<script type="math/tex"></script>\tau(7)=2+(3-3)+(2-2)+(1-1)+(1-1)+(1-1)=2,<script type="math/tex"></script>
lo que concluye que <script type="math/tex">7</script> es primo. En realidad, el resultado
no es sorprendente, ya que <script type="math/tex">n>1</script> es primo si y sólo si no
es divisible por ningún <script type="math/tex">k=2,\dots,n-1</script>, es decir, que
<script type="math/tex">{n\over k}</script> no es entero, que es equivalente a
<script type="math/tex">\big\lbrack{n\over k}\big\rbrack=\big\lbrack{n-1\over
k}\big\rbrack</script>, es decir <script type="math/tex">\tau(n)=2</script>.</p>

<p>Veamos otra simple aplicación del tipo de
ideas anterior para estudiar una clase de números que
llamaron la atención a los griegos clásicos:</p>

<p><b>DEFINICIÓN:</b>  Se llama {\it número perfecto} a un entero positivo
que sea igual a la suma de todos sus divisores menores que
él. Usando la terminología anterior, la suma de los
divisores de <script type="math/tex">n</script> es <script type="math/tex">\sigma(n)</script>, por lo que para obtener la
suma de los divisores de <script type="math/tex">n</script> menores que <script type="math/tex">n</script> hay que quitar
el propio <script type="math/tex">n</script>. Es decir, <script type="math/tex">n</script> es un número perfecto si y
sólo si <script type="math/tex">\sigma(n)-n=n</script>, i.e. <script type="math/tex">\sigma(n)=2n</script>.</p>

<p>El resultado más importante sobre los números perfectos
es el siguiente:</p>

<p><b>LEMA:</b>  Teorema \perfectospares. Un número par <script type="math/tex">n</script> es un
número perfecto si y sólo si se puede escribir como
<script type="math/tex">n=2^{k-1}(2^k-1)</script>, siendo <script type="math/tex">k\ge 2</script> y <script type="math/tex">2^k-1</script> un número
primo.</p>

<p><b>DEMOSTRACIÓN:</b> Supongamos en primer lugar que <script type="math/tex">n</script> es un número
perfecto par. Lo escribimos separando los factores primos
impares, es decir, de la forma <script type="math/tex">n=2^{k-1}m</script> con <script type="math/tex">k\ge2</script> y
<script type="math/tex">m</script> impar. La condición de que <script type="math/tex">n</script> sea perfecto es
equivalente a <script type="math/tex">\sigma(n)=2n</script>, que usando que <script type="math/tex">\sigma</script> es
multiplicativa y la fórmula de la Observación
\formulatausigma\ quiere decir:
<script type="math/tex"></script>2^km=2n=\sigma(n)=\sigma(2^{k-1}m)=\sigma(2^{k-1})\sigma(m)
=(2^k-1)\sigma(m).<script type="math/tex"></script>
Como <script type="math/tex">\text{mcd}(2^k,2^k-1)=1</script>, se sigue de que existe
<script type="math/tex">M\in\mathbb{Z}_{\ge1}</script> tal que 
<script type="math/tex"></script>\left{\eqalign{&amp;m=(2^k-1)M\cr &amp;\sigma(m)=2^kM}\right.<script type="math/tex"></script>
En particular, <script type="math/tex">m</script> y <script type="math/tex">M</script> son dos divisores distintos de <script type="math/tex">m</script>,
por lo que se tendrá <script type="math/tex">\sigma(m)\ge m+M</script>, y de hecho se
dará la igualdad si y sólo si <script type="math/tex">m</script> y <script type="math/tex">M</script> son los
únicos divisores de <script type="math/tex">m</script>, es decir, <script type="math/tex">m</script> es primo y
<script type="math/tex">M=1</script>. Ahora observamos que efectivamente se da la igualdad,
ya que se tiene
<script type="math/tex"></script>2^kM=\sigma(m)\ge m+M=(2^k-1)M+M=2^kM.<script type="math/tex"></script>
Por tanto, <script type="math/tex">m=2^k-1</script> es un número primo y
<script type="math/tex">n=2^{k-1}m=2^{k-1}(2^k-1)</script>.</p>

<p>Recíprocamente, si <script type="math/tex">n=2^{k-1}(2^k-1)</script>, con <script type="math/tex">k\ge2</script> y
<script type="math/tex">2^k-1=p</script> primo, entonces, como <script type="math/tex">\sigma</script> es multiplicativa y
usando la fórmula de la Observación \formulatausigma, se
tiene
<script type="math/tex"></script>\sigma(n)=\sigma(2^{k-1}p)=
\sigma(2^{k-1})\sigma(p)=(2^k-1)(p+1)=(2^k-1)2^k=2n.<script type="math/tex"></script>
\qed
\vfill\eject  %%%%%% OJO: Est para que no se parta aqu%%%</p>

<p>El interés del resultado anterior radica en que no se
conocen números perfectos impares, y de hecho todo indica
que no existen (por ejemplo, se sabe que un número
perfecto impar debería tener al menos <script type="math/tex">300</script> cifras).
Respecto a la existencia de infinitos números perfectos
pares, es también un problema abierto. Por el teorema
anterior, bastaría que demostrar que existen infinitos
números primos de la forma <script type="math/tex">2^k-1</script>. Es una simple
observación que si <script type="math/tex">2^k-1</script> es primo entonces <script type="math/tex">k</script> es primo
(ya que, si <script type="math/tex">r\vert k=</script>, entonces <script type="math/tex">2^s-1\vert 2^k-1</script>).</p>

<p><b>DEFINICIÓN:</b>  Se llama {\it número primo de Mersenne} a un
número primo de la forma <script type="math/tex">M_k:=2^k-1</script> con <script type="math/tex">k</script>
primo (nótese que es equivalente a decir que, en base dos,
se escribe sólo con unos).</p>

<p>Por tanto, existen infinitos números
perfectos pares si y sólo si existen infinitos números
primos de Mersenne (lo que se conjetura que es cierto). Damos
a continuación una tabla con los primeros <script type="math/tex">k</script> primos tales
que <script type="math/tex">M_k</script> es primo, con el correspondiente número perfecto
<script type="math/tex">n=2^{k-1}(2^k-1)</script>.</p>

<p>\bigskip</p>

<p>\moveright 1.5cm\vbox{\halign{
\vrule\ \hfil # <script type="math/tex">\matrix{\cr\cr}</script>\vrule &amp;\ \hfil #
\vrule &amp;\ \hfil # \vrule \cr 
\noalign{\hrule}
<script type="math/tex">k</script>&amp;<script type="math/tex">M_k=2^k-1</script>&amp;<script type="math/tex">n=2^{k-1}(2^k-1)</script>\cr 
\noalign{\hrule} 
\noalign{\hrule} 
2&amp;3&amp;6 \cr 
\noalign{\hrule} 
3&amp;7&amp;28 \cr 
\noalign{\hrule} 
5&amp;31&amp;496 \cr 
\noalign{\hrule} 
7&amp;127&amp;8128 \cr 
\noalign{\hrule} 
13&amp;8191&amp;33550336 \cr 
\noalign{\hrule} 
17&amp;131071&amp;8589869056 \cr 
\noalign{\hrule} 
19&amp;524287&amp;137438691328 \cr 
\noalign{\hrule} 
31&amp;2147483647&amp;2305843008139952128 \cr 
\noalign{\hrule} 
61&amp;2305843009213693951&amp;2658455991569831744654692615953842176
\cr 
\noalign{\hrule}<br />
%89&amp;618970019642690137449562111&amp;191561942608236107294793378084303638130997321548169216
%\cr 
%\noalign{\hrule}<br />
}}</p>

<p>\bigskip</p>

<p>Nótese que <script type="math/tex">k=11</script> es el primer número primo tal que
<script type="math/tex">M_k</script> no es primo (<script type="math/tex">M_{11}=2047=23\cdot89</script>), y  a partir de
ahí hay muchos
<script type="math/tex">k</script> con la misma propiedad. Hasta la fecha, se conocen
sólo 43 números primos de Mersenne (el último,
obtenido en septiembre de 2008). El mayor número primo de
Mersenne que se conoce (encontrado en agosto de este a\~no)
es para <script type="math/tex">k=43112609</script>, y el número de cifras de
<script type="math/tex">M_k</script> es 12978189 (casi trece millones). El primo <script type="math/tex">M_{31}</script>
ya era conocido por Euler en 1772.</p>
