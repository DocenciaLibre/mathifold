<p>El Ejemplo \EulerFermat\ muestra que, dado <script type="math/tex">n\in\mathbb{Z}_{\ge1}</script>,
no siempre <script type="math/tex">\phi(n)</script> es la menor potencia a la que debemos
elevar un número para que nos dé <script type="math/tex">1</script> módulo <script type="math/tex">n</script>. En
este capítulo, pretendemos estudiar en qué
condiciones <script type="math/tex">\phi(n)</script> es dicho menor exponente. Las
definiciones naturales de partida son las siguientes:</p>

<p><b>DEFINICIÓN:</b> Fijado un entero positivo <script type="math/tex">n</script>, para cada <script type="math/tex">a\in\mathbb{Z}</script>
tal que <script type="math/tex">\text{mcd}(a,n)=1</script> se llama {\it orden del elemento <script type="math/tex">a</script>
módulo <script type="math/tex">n</script>} al menor entero positivo <script type="math/tex">k</script> tal que
<script type="math/tex">a^k\equiv1\ (\text{mod } n)</script>. Del teorema de Euler sigue
<script type="math/tex">k\le\phi(n)</script>, y diremos que <script type="math/tex">a</script> es una {\it raíz
primitiva (de la unidad) módulo <script type="math/tex">n</script>} si su orden es
<script type="math/tex">k=\phi(n)</script>.</p>

<p><b>EJEMPLO:</b> {\onceprimitivo} Estudiemos el caso <script type="math/tex">n=11</script>. Si tomamos
<script type="math/tex">a=2</script>, es un simple cálculo observar que las potencias
<script type="math/tex">2^1,2^2,2^3,2^4,2^5,2^6,2^7,2^8,2^9,2^{10}</script> son
respectivamente congruentes con
<script type="math/tex">2,4,8,5,10,9,7,3,6,1</script> módulo <script type="math/tex">11</script>. Por tanto, <script type="math/tex">2</script> tiene
orden <script type="math/tex">10</script> módulo <script type="math/tex">11</script>, y por tanto es una raíz
primitiva. Obsérvese que las distintas potencias nos han
dado precisamente todos los restos <script type="math/tex">1,2,3,4,5,6,7,8,9,10</script>,
aunque en orden distinto. Ya veremos más adelante que
esto no es una coincidencia. Si en cambio tomamos <script type="math/tex">a=3</script>,
las potencias <script type="math/tex">3^1,3^2,3^3,3^4,3^5</script> son respectivamente
congruentes con <script type="math/tex">3,9,5,4,1</script> módulo <script type="math/tex">11</script>, por lo que <script type="math/tex">3</script>
tiene orden <script type="math/tex">5</script> módulo <script type="math/tex">11</script> y no es una raíz
primitiva. Tampoco es casualidad que el orden de <script type="math/tex">3</script> sea
un divisor de <script type="math/tex">\phi(11)=10</script>.</p>

<p>No tienen por qué existir siempre raíces
primitivas (de hecho, es lo menos frecuente). Por ejemplo,
el Ejemplo \EulerFermat\ indica que
<script type="math/tex">35</script> no tiene raíces primitivas. Más
aún, indica que el problema es que <script type="math/tex">35</script> factoriza en dos
números primos entre sí, <script type="math/tex">7</script> y <script type="math/tex">5</script>, cuyos valores de
<script type="math/tex">\phi</script> no son primos entre sí, ya que son ambos pares.
El siguiente resultado indica que esta situación se
repetirá muchas veces.</p>

<p><b>LEMA:</b>  \phipar. Si <script type="math/tex">n>2</script>, <script type="math/tex">\phi(n)</script> es par.</p>

<p><b>DEMOSTRACIÓN:</b>  Si <script type="math/tex">n</script> contiene algún divisor primo impar <script type="math/tex">p</script>, entonces
el resultado es evidente, ya que se podrá escribir
<script type="math/tex">n=p^km</script> con <script type="math/tex">\text{mcd}(m,p)=1</script> y <script type="math/tex">k\ge1</script>. Entonces
<script type="math/tex">\phi(n)=\phi(p^k)\phi(m)</script>, y <script type="math/tex">\phi(p^k)</script> es par, ya que por
la Observación \calculophiprimo\ se tiene 
<script type="math/tex">\phi(p^k)=p^{k-1}(p-1)</script> y <script type="math/tex">p-1</script> es par.</p>

<p>Queda por tanto estudiar el caso en que <script type="math/tex">n</script> no tiene
factores impares, es decir, es de la forma <script type="math/tex">n=2^k</script>. En tal
caso, <script type="math/tex">\phi(2^k)=2^{k-1}</script>, que es también par por ser
<script type="math/tex">k>1</script> (puesto que <script type="math/tex">n>2</script>).
\qed</p>

<p>Del lema sacamos ya muchos casos en que no hay raíces
primitivas.</p>

<p><b>LEMA:</b> \dosfactoresnoprimitivo. Si
<script type="math/tex">\text{mcd}(m,n)>1</script> y <script type="math/tex">m,n>2</script>, entonces <script type="math/tex">mn</script> no tiene raíces
primitivas.</p>

<p><b>DEMOSTRACIÓN:</b>  Sea <script type="math/tex">a\in\mathbb{Z}</script> tal que <script type="math/tex">\text{mcd}(a,mn)=1</script>, es decir,
<script type="math/tex">\text{mcd}(a,m)=1</script> y <script type="math/tex">\text{mcd}(a,n)=1</script> (ver Proposición
\productocoprimos). Si aplicamos el Teorema de
Euler separadamente a <script type="math/tex">m</script> y <script type="math/tex">n</script>, tendremos que
<script type="math/tex">a^{\phi(m)}\equiv1\ (\text{mod } m)</script> y
<script type="math/tex">a^{\phi(n)}\equiv1\ (\text{mod } n)</script>. Elevando respectivamente a
<script type="math/tex">\phi(n)\over2</script> y <script type="math/tex">\phi(m)\over2</script> (que son enteros, ya que 
por el lema <script type="math/tex">\phi(m)</script> y <script type="math/tex">\phi(n)</script> son pares) obtenemos que
<script type="math/tex">a^{\phi(m)\phi(n)\over2}</script> es congruente con <script type="math/tex">1</script> módulo
<script type="math/tex">m</script> y <script type="math/tex">n</script>, luego también módulo <script type="math/tex">mn</script>. Por tanto, el
orden de <script type="math/tex">a</script> módulo <script type="math/tex">mn</script> es a lo sumo
<script type="math/tex">\phi(m)\phi(n)\over2</script>. Como <script type="math/tex">\phi(mn)=\phi(m)\phi(n)</script> al
ser <script type="math/tex">\text{mcd}(m,n)=1</script>, se tiene que ningún <script type="math/tex">a</script> tiene orden
<script type="math/tex">\phi(mn)</script>.
\qed</p>

<p>Como consecuencia, los únicos números que pueden tener
raíces primitivas son los de la forma
<script type="math/tex">p^k</script> o <script type="math/tex">2p^k</script> (con <script type="math/tex">p\ne2</script> en el segundo caso). El caso de
las potencias de <script type="math/tex">2</script> queda excluido (salvo para las dos
primeras potencias) por el siguiente resultado.</p>

<p><b>LEMA:</b> \potenciasdosnoprimitivo. Para todo
número impar <script type="math/tex">a</script> y para cada entero <script type="math/tex">k\ge3</script>, se tiene que
<script type="math/tex">a^{2^{k-2}}\equiv1\ (\text{mod } 2^k)</script>. Por tanto, <script type="math/tex">2^k</script> no tiene
raíces primitivas.</p>

<p><b>DEMOSTRACIÓN:</b>  Si demostramos la primera parte, como
<script type="math/tex">\phi(2^k)=2^{k-1}</script> por la Observación \calculophiprimo,
se sigue que <script type="math/tex">2^k</script> no tiene raíces primitivas. Basta
entonces demostrar la primera parte, es decir,
<script type="math/tex">2^k\vert a^{2^{k-2}}-1</script> si <script type="math/tex">k\ge3</script>. Lo demostraremos por
inducción sobre <script type="math/tex">k</script>. Si <script type="math/tex">k=3</script>, entonces tenemos
<script type="math/tex">a^2-1=(a+1)(a-1)</script>. Como <script type="math/tex">a-1</script> y <script type="math/tex">a+1</script> son dos pares
consecutivos, uno de ellos es necesariamente múltiplo de
<script type="math/tex">4</script>, con el producto de ambos es divisible por <script type="math/tex">8</script>.</p>

<p>Supongamos ahora que lo tenemos demostrado para <script type="math/tex">k</script> y
queremos demostrarlo para <script type="math/tex">k+1</script>. Entonces escribimos
<script type="math/tex">a^{2^{k-1}}-1=(a^{2^{k-2}}+1)(a^{2^{k-2}}-1)</script>. El primer
factor es par, mientras que el segundo, por hipótesis de
inducción, es divisible por <script type="math/tex">2^k</script>, así que el
producto de ambos factores es divisible por <script type="math/tex">2^{k+1}</script>, como
queríamos demostrar.
\qed</p>

<p>El resultado final, que demostraremos algo más
adelante, cuando dispongamos de las técnicas necesarias, es
el siguiente:</p>

<p>\proclaim Teorema \caracterizacionprimitivos. Un número
natural <script type="math/tex">n>1</script> posee raíces primitivas si y
sólo si es <script type="math/tex">n=2</script>, <script type="math/tex">n=4</script>, <script type="math/tex">n=p^k</script> o <script type="math/tex">n=2p^k</script> donde <script type="math/tex">p</script> es
un primo impar y <script type="math/tex">k\ge1</script>.</p>

<p>Por las Proposiciones \dosfactoresnoprimitivo\ y
\potenciasdosnoprimitivo, tenemos que los únicos casos
posibles son los del enunciado. Por otra parte, es evidente
que <script type="math/tex">3</script> es una raíz primitiva módulo <script type="math/tex">2</script> y módulo
<script type="math/tex">4</script>. Por tanto, basta ver que los números de la forma
<script type="math/tex">p^k</script> o <script type="math/tex">2p^k</script> tienen raíces primitivas. Eso lo
demostraremos en el Teorema
\potenciaprimoprimitivo.</p>

<p>\bigskip</p>

<p>Dado que debemos estudiar la existencia de elementos de orden
<script type="math/tex">\phi(n)</script>, parece razonable estudiar primero propiedades de
los órdenes de los elementos.</p>

<p><b>LEMA:</b> \propiedadesordenes. Sea <script type="math/tex">a</script> un
elemento de orden
<script type="math/tex">k</script> módulo
<script type="math/tex">n</script>. Entonces: 
\item{(i)} <script type="math/tex">a^h\equiv1\ (\text{mod } n)</script> si y sólo si <script type="math/tex">k\vert h</script>.
\item{(ii)} <script type="math/tex">k</script> es un divisor de <script type="math/tex">\phi(n)</script>.<br />
\item{(iii)} <script type="math/tex">a^i\equiv a^j\ (\text{mod } n)</script> si y sólo si
<script type="math/tex">i\equiv j\ (\text{mod } k)</script>.
\item{(iv)} Los elementos <script type="math/tex">a,a^2,\dots,a^{k-1},a^k</script> son
incongruentes módulo <script type="math/tex">n</script>.
\item{(v)} Si <script type="math/tex">h>0</script>, entonces <script type="math/tex">a^h</script> tiene orden
<script type="math/tex">k\over\text{mcd}(h,k)</script> módulo <script type="math/tex">n</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Para la parte (i), sea <script type="math/tex">h=qk+r</script> la división
euclídea de <script type="math/tex">h</script> entre <script type="math/tex">k</script>, por lo que <script type="math/tex">0\le r\lt k</script>. Se
tendrá entonces 
<script type="math/tex"></script>a^h=a^{qk+r}=(a^k)^ra^r\equiv1^ka^r=a^r\ (\text{mod } n).<script type="math/tex"></script>
Por tanto, <script type="math/tex">a^h\equiv1\ (\text{mod } n)</script> si y sólo si
<script type="math/tex">a^r\equiv1\ (\text{mod } n)</script>. Como <script type="math/tex">r\lt n</script> y, por definición de
orden, <script type="math/tex">k</script> es el menor entero positivo tal que <script type="math/tex">a^k\equiv1\
(\text{mod } n)</script>, se sigue que <script type="math/tex">a^r\equiv1\ (\text{mod } n)</script> si y sólo
si <script type="math/tex">r\le0</script>, es decir, si y sólo si <script type="math/tex">r=0</script> (ya que <script type="math/tex">r\ge0</script>).
Como esto es equivalente a decir <script type="math/tex">k\vert h</script>, queda demostrado (i).</p>

<p>La parte (ii) es una consecuencia de (i), ya que, por el
Teorema de Euler, se tiene <script type="math/tex">a^{\phi(n)}\equiv1\ (\text{mod } n)</script>.</p>

<p>Para (iii), podemos suponer <script type="math/tex">i\le j</script>. Entonces
<script type="math/tex">a^i(a^{j-i}-1)\equiv0\ (\text{mod } n)</script>, es decir,
<script type="math/tex">n\vert a^i(a^{j-i}-1)</script>. Como <script type="math/tex">\text{mcd}(a,n)=1</script>, se sigue que
<script type="math/tex">n\vert a^{j-i}-1</script>, es decir, <script type="math/tex">a^{j-i}\equiv1\ (\text{mod } n)</script>. Por (i),
<script type="math/tex">k\vert j-i</script>, o lo que es lo mismo <script type="math/tex">i\equiv j\ (\text{mod } k)</script>.</p>

<p>La parte (iv) es una consecuencia de (iii), ya que, si
<script type="math/tex">i,j\in\{1,2,\dots,k\}</script>, la condición 
<script type="math/tex">a^i\equiv a^j\ (\text{mod } n)</script> es equivalente a <script type="math/tex">i\equiv j\
(\text{mod } k)</script>, que a su vez es equivalente a <script type="math/tex">i=j</script>, por ser
<script type="math/tex">\{1,2,\dots,k\}</script> un sistema completo de restos módulo
<script type="math/tex">k</script> (Proposición <b>EJEMPLO:</b> plosrestos(i)).</p>

<p>Finalmente, para demostrar la parte (v), observamos
que <script type="math/tex">(a^h)^j\equiv1\ (\text{mod } n)</script> si y sólo si
<script type="math/tex">a^{hj}\equiv1\ (\text{mod } n)</script>, que por (i), es equivalente a
<script type="math/tex">k\vert hj</script>. Por el Lema \propiedadesdivisibilidad(iv), esto
equivale a <script type="math/tex">{k\over\text{mcd}(h,k)}\vert {h\over\text{mcd}(h,k)}j</script>. Como,
por la Proposición \propiedadesMCD(ii),
<script type="math/tex">{k\over\text{mcd}(h,k)}</script> y <script type="math/tex">{h\over\text{mcd}(h,k)}</script> son primos entre
sí, el Lema de Euclides implica que la condición
anterior es equivalente también a
<script type="math/tex">{k\over\text{mcd}(h,k)}\vert j</script>. En otras palabras, las potencias de
<script type="math/tex">a^h</script> que son congruentes con <script type="math/tex">1</script> módulo <script type="math/tex">n</script> son
precisamente los múltiplos de <script type="math/tex">{k\over\text{mcd}(h,k)}</script>, lo
que implica que <script type="math/tex">{k\over\text{mcd}(h,k)}</script> es precisamente el
orden de <script type="math/tex">a^h</script> módulo <script type="math/tex">n</script>.
\qed</p>

<p>La observación principal a la hora de buscar raíces
primitivas es que éstas son las soluciones de la
congruencia <script type="math/tex">x^{\phi(n)}\equiv1\ (\text{mod } n)</script> que no son
solución solución de ninguna congruencia de la forma
<script type="math/tex">x^d\equiv1\ (\text{mod } n)</script> con <script type="math/tex">d\vert \phi(n)</script>. En los casos que
hemos visto en que <script type="math/tex">n</script> no tiene raíces primitivas
ocurre que existe <script type="math/tex">d\lt \phi(n)</script> tal que la congruencia
<script type="math/tex">x^d\equiv1\ (\text{mod } n)</script> tiene <script type="math/tex">\phi(n)</script> soluciones
módulo <script type="math/tex">n</script> (como en el Ejemplo
\EulerFermat, en que la congruencia <script type="math/tex">x^{12}\equiv1\ (\text{mod }
35)</script> tiene <script type="math/tex">24</script> soluciones). Este tipo de anomalías
(tener más soluciones que el grado de la congruencia) no se
dan en el caso en que <script type="math/tex">n</script> es un número primo (ni para
congruencias de grado uno, como indica la Proposición
\congruencialineal), y de hecho se tiene el siguiente
resultado, que será clave para demostrar el Teorema
\caracterizacionprimitivos:</p>

<p>\proclaim Teorema \lagrange\ {\rm (Lagrange)}. Sea <script type="math/tex">p</script> un
número primo y
<script type="math/tex">f(x)=a_dx^d+a_{d-1}x^{d-1}+\dots+a_1x+a_0</script> un polinomio con
algún <script type="math/tex">a_i</script> no divisible por <script type="math/tex">p</script>. Entonces existen como
mucho <script type="math/tex">d</script> soluciones distintas módulo <script type="math/tex">p</script> de la congruencia
<script type="math/tex">f(x)\equiv0\ (\text{mod } p)</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Lo hacemos por inducción sobre <script type="math/tex">d</script>. Si <script type="math/tex">d=0</script>,
entonces <script type="math/tex">f(x)</script> es una constante <script type="math/tex">a_0</script> no divisible por <script type="math/tex">p</script>,
por lo que <script type="math/tex">f(x)\equiv0\ (\text{mod } p)</script> no tiene solución.
Supongamos entonces que tenemos el resultado demostrado para
polinomios no nulos de grado menor o igual que <script type="math/tex">d</script> y
demostrémoslo para polinomios de grado <script type="math/tex">d+1</script>. Tomemos por
tanto un polinomio
<script type="math/tex">f(x)=a_{d+1}x^{d+1}+a_dx^d+\dots+a_1x+a_0</script> con algún
<script type="math/tex">a_i</script> no divisible por <script type="math/tex">p</script>. Distinguimos dos casos:</p>

<p>–Si <script type="math/tex">p\vert a_{d+1}</script>, entonces algún <script type="math/tex">a_i</script>, con
<script type="math/tex">i=0,1,\dots,d</script>, no es divisible por <script type="math/tex">p</script>. Además, las
soluciones de <script type="math/tex">f(x)\equiv0\ (\text{mod } p)</script> son las soluciones de
<script type="math/tex">a_dx^d+\dots+a_1x+a_0\equiv0\ (\text{mod } p)</script>, que, por
hipótesis de inducción, son al máximo <script type="math/tex">d</script> distintas
módulo <script type="math/tex">p</script>. Por tanto, en este caso hay incluso menos de
<script type="math/tex">d+1</script> soluciones módulo <script type="math/tex">p</script>.</p>

<p>–Si en cambio <script type="math/tex">p\nmid a_{d+1}</script>, demostraremos por
reducción al absurdo que <script type="math/tex">f(x)\equiv0\ (\text{mod } p)</script> no puede
tener más de <script type="math/tex">d+1</script> soluciones módulo <script type="math/tex">p</script>. En efecto,
supongamos que tuviera <script type="math/tex">d+2</script> soluciones distintas, que
denotamos por <script type="math/tex">x\equiv x_1,x_2\dots,x_{d+1},x_{d+2}\ (\text{mod }
p)</script>. Consideramos el polinomio
<script type="math/tex"></script>g(x)=f(x)-a_{d+1}(x-x_1)\dots(x-x_{d+1}),<script type="math/tex"></script> 
que claramente tiene grado como mucho <script type="math/tex">d</script> (ya que el
coeficiente de <script type="math/tex">x^{d+1}</script> es cero). Además, no todos sus
coeficientes son divisibles por <script type="math/tex">p</script>, ya que
<script type="math/tex">g(x_{d+2})=-a_{d+1}(x_{d+2}-x_1)\dots(x_{d+2}-x_{d+1})
\not\equiv0\ (\text{mod } p)</script> porque es el producto de números
no divisibles por <script type="math/tex">p</script> (Corolario \primodivideproducto). Por
tanto, por hipótesis de inducción la congruencia
<script type="math/tex">g(x)\equiv0\ (\text{mod } p)</script> tiene a lo sumo <script type="math/tex">d</script> soluciones
distintas módulo <script type="math/tex">p</script>, mientras que claramente <script type="math/tex">x\equiv
x_1,x_2\dots,x_{d+1}\ (\text{mod } p)</script> son soluciones, lo que nos
da la contradicción que buscábamos.
\qed</p>

<p><b>DEFINICIÓN:</b> Dado un polinomio <script type="math/tex">f(x)</script> con coeficientes enteros,
llamaremos {\it raíces del polinomio módulo <script type="math/tex">p</script>} a
las soluciones de la congruencia <script type="math/tex">f(x)\equiv0\ (\text{mod } p)</script>.</p>

<p>Un ejemplo típico del resultado anterior es el
polinomio <script type="math/tex">x^{p-1}-1</script>, que por el peque\~no Teorema de Fermat
tiene exactamente <script type="math/tex">p-1</script> raíces módulo <script type="math/tex">p</script>. Entre este
hecho y el teorema podemos demostrar el siguiente resultado
fundamental:</p>

<p><b>LEMA:</b> \raicesdesimas. Para cada <script type="math/tex">d\vert p-1</script>,
la congruencia <script type="math/tex">x^d-1\equiv0\ (\text{mod } p)</script> tiene exactamente
<script type="math/tex">d</script> soluciones módulo <script type="math/tex">p</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Si escribimos <script type="math/tex">p-1=dk</script>, entonces podemos escribir 
<script type="math/tex"></script>x^{p-1}-1=(x^d)^k-1=(x^d-1)\big((x^d)^{k-1}+(x^d)^{k-2}+\dots+
x^d+1\big)=(x^d-1)f(x)<script type="math/tex"></script><br />
donde <script type="math/tex">f(x)</script> está definido como el segundo factor, y en
particular tiene grado <script type="math/tex">dk-d=p-1-d</script>. Como, por el peque\~no
teorema de Fermat cada <script type="math/tex">a</script> primo con <script type="math/tex">a</script> es raíz
módulo <script type="math/tex">p</script> de <script type="math/tex">x^{p-1}-1</script>, entonces también es raíz
de <script type="math/tex">x^d-1</script> o de <script type="math/tex">f(x)</script>. Como por el Teorema de Lagrange
<script type="math/tex">x^d-1</script> tiene como mucho <script type="math/tex">d</script> raíces módulo <script type="math/tex">p</script> y
<script type="math/tex">f(x)</script> tiene como mucho <script type="math/tex">p-1-d</script>, se sigue que se da la
igualdad en ambos casos, es decir, <script type="math/tex">x^d-1</script> tiene exactamente
<script type="math/tex">d</script> raíces módulo <script type="math/tex">p</script>.
\qed</p>

<p>Podemos demostrar ya el resultado principal que nos da los
elementos que tenemos de cada orden, y en particular la
existencia de raíces primitivas módulo <script type="math/tex">p</script>:</p>

<p>\proclaim Teorema \ordenesmodulop. Para cada <script type="math/tex">d\vert p-1</script>,
existen exactamente <script type="math/tex">\phi(d)</script> enteros incongruentes de orden
<script type="math/tex">d</script> módulo <script type="math/tex">p</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Llamamos <script type="math/tex">\psi(d)</script> al número de enteros incongruentes
módulo <script type="math/tex">p</script> de orden <script type="math/tex">d</script>. Como el orden de un elemento
módulo <script type="math/tex">p</script> es un divisor de <script type="math/tex">\phi(p)=p-1</script>, se tendrá
<script type="math/tex"></script>\sum_{d\vert p-1}\psi(d)=p-1.<script type="math/tex"></script>
Por otra parte, como vimos en la parte 5 del Ejemplo
<b>EJEMPLO:</b> plosgeneracion,
<script type="math/tex"></script>\sum_{d\vert p-1}\phi(d)=p-1,<script type="math/tex"></script>
por lo que bastará ver que <script type="math/tex">\psi(d)\le\phi(d)</script> para cada
<script type="math/tex">d\vert p-1</script>. Sea entonces <script type="math/tex">d\vert p-1</script>. Si <script type="math/tex">\psi(d)=0</script>, entonces no
hay nada que demostrar, así que podemos suponer que
existe un elemento <script type="math/tex">a</script> de orden <script type="math/tex">d</script> módulo <script type="math/tex">p</script>. Entonces,
los elementos <script type="math/tex">a,a^2,\dots,a^d</script> son todos incongruentes
módulo <script type="math/tex">p</script> por la Proposición
\propiedadesordenes(iv), luego son las <script type="math/tex">d</script> soluciones de
<script type="math/tex">x^d-1\equiv0\ (\text{mod } p)</script> de la proposición anterior. Por
tanto, los elementos de orden <script type="math/tex">d</script> son de la forma <script type="math/tex">a^i</script>, y por
la Proposición \propiedadesordenes(v), un elemento
<script type="math/tex">a^i</script> tiene orden <script type="math/tex">d</script> si y sólo si <script type="math/tex">\text{mcd}(i,d)=1</script> , es decir,
hay exactamente <script type="math/tex">\phi(d)</script> elementos incongruentes de orden
<script type="math/tex">d</script>, lo que demuestra el resultado.
\qed</p>

<p>\proclaim Corolario \primoprimitivo. Cualquier número
primo tiene raíces primitivas.</p>

<p><b>DEMOSTRACIÓN:</b>  Es consecuencia del teorema, tomando <script type="math/tex">d=p-1</script>. De hecho,
podemos precisar que hay exactamente <script type="math/tex">\phi(p-1)</script> elementos
incongruentes entre sí de orden <script type="math/tex">p-1</script> módulo <script type="math/tex">p</script>, es
decir, raíces primitivas módulo <script type="math/tex">p</script>.
\qed</p>

<p>Pasar de raíces primitivas módulo un número primo a
una potencia suya se basa en la siguiente observación:</p>

<p><b>LEMA:</b>  \lemapotenciaprimoprimitivo. Sea <script type="math/tex">r</script> una
raíz primitiva módulo un número primo <script type="math/tex">p</script>.
Entonces, para cualquier <script type="math/tex">k\ge2</script>, el orden de <script type="math/tex">r</script> módulo
<script type="math/tex">p^k</script> es de la forma <script type="math/tex">(p-1)p^j</script>, con <script type="math/tex">j\le k-1</script>. En
particular, <script type="math/tex">r</script> es una raíz primitiva módulo <script type="math/tex">p^k</script> si
y sólo si <script type="math/tex">p^k</script> no divide a <script type="math/tex">r^{p^{k-2}(p-1)}-1</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Sea <script type="math/tex">m</script> el orden de <script type="math/tex">r</script> módulo <script type="math/tex">p^k</script>. Se tendrá, en
particular, <script type="math/tex">a^m\equiv1\ (\text{mod } p^k)</script>, y en particular
<script type="math/tex">a^m\equiv1\ (\text{mod } p)</script>. Por el Lema
\propiedadesordenes(i), se tendrá <script type="math/tex">p-1\vert m</script>, ya que <script type="math/tex">p-1</script> es
el orden de <script type="math/tex">r</script> módulo <script type="math/tex">p</script> (por ser <script type="math/tex">r</script> raíz
primitiva). Además, por el Lema
\propiedadesordenes(ii) aplicado ahora a <script type="math/tex">n=p^k</script>, se tendrá
<script type="math/tex">m\vert \phi(p^k)=p^{k-1}(p-1)</script>. De estas dos condiciones sobre
<script type="math/tex">m</script> se deduce que es de la forma <script type="math/tex">m=(p-1)p^j</script>, con <script type="math/tex">j\le
k-1</script>.</p>

<p>Para demostrar la segunda parte, es claro ahora que <script type="math/tex">r</script> no
es una raíz primitiva módulo <script type="math/tex">p^k</script> si y sólo si
tiene orden <script type="math/tex">m=(p-1)p^j</script>, con <script type="math/tex">j\le k-2</script>, es decir si y
sólo si su orden <script type="math/tex">m</script> divide a <script type="math/tex">(p-1)p^{k-2}</script>. Por el Lema
\propiedadesordenes(i), esta condición es equivalente a
<script type="math/tex">r^{p^{k-2}(p-1)}\equiv1\ (\text{mod } p^k)</script>, es decir, a
<script type="math/tex">p^k\vert r^{p^{k-2}(p-1)}-1</script>.
\qed</p>

<p>Este resultado nos permite finalmente terminar de
demostrar el Teorema \caracterizacionprimitivos:</p>

<p>\proclaim Teorema \potenciaprimoprimitivo. Si <script type="math/tex">p</script> es un
número primo impar, <script type="math/tex">p^k</script> y <script type="math/tex">2p^k</script> tienen raíces
primitivas para cada <script type="math/tex">k\ge1</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Ya hemos visto en el Corolario \primoprimitivo\ que
existen raíces primitivas módulo <script type="math/tex">p</script>. Demostremos en
primer lugar una raíz primitiva módulo <script type="math/tex">p^2</script>. Para
ello, fijaremos una raíz primitiva <script type="math/tex">r</script> módulo <script type="math/tex">p</script>, y
veamos que, si <script type="math/tex">r</script> no es una raíz primitiva módulo
<script type="math/tex">p^2</script>, entonces <script type="math/tex">r+p</script> lo es (en realidad valdría
cualquier <script type="math/tex">r+ip</script> con <script type="math/tex">\text{mcd}(i,p)=1</script>).</p>

<p>En efecto, si <script type="math/tex">r</script> no es una raíz primitiva módulo
<script type="math/tex">p^2</script>, por el Lema \lemapotenciaprimoprimitivo\ sabemos que
<script type="math/tex">p^2</script> divide a <script type="math/tex">r^{p-1}-1</script>. Por tanto, módulo <script type="math/tex">p^2</script>
tendremos 
<script type="math/tex"></script>(r+p)^{p-1}-1\equiv r^{p-1}+(p-1)r^{p-2}p-1\equiv
(p-1)r^{p-2}p\ (\text{mod } p^2).<script type="math/tex"></script>
Como <script type="math/tex">(p-1)r^{p-2}</script> no es divisible por <script type="math/tex">p</script>, entonces
<script type="math/tex">(p-1)r^{p-2}p</script> no es divisible por <script type="math/tex">p^2</script>, luego
<script type="math/tex">(r+p)^{p-1}-1</script> tampoco lo es, lo que implica por Lema
\lemapotenciaprimoprimitivo\ que
<script type="math/tex">r+p</script> es una raíz primitiva módulo <script type="math/tex">p^2</script>.</p>

<p>Construida pues una raíz primitiva <script type="math/tex">r</script> módulo <script type="math/tex">p^2</script>,
veamos que, por ser <script type="math/tex">p</script> impar, <script type="math/tex">r</script> es también una
raíz primitiva módulo <script type="math/tex">p^k</script> para cualquier
<script type="math/tex">k\ge2</script>. Por el Lema \lemapotenciaprimoprimitivo, tenemos
que demostrar que, si <script type="math/tex">p^2</script> no divide a <script type="math/tex">r^{p-1}-1</script>, entonces
<script type="math/tex">p^k</script> no divide a <script type="math/tex">r^{p^{k-2}(p-1)}-1</script>. Lo demostraremos por
inducción sobre <script type="math/tex">k</script>, siendo el resultado trivial para <script type="math/tex">k=2</script>.
Supongamos ahora cierto el resultado para <script type="math/tex">k</script> y vamos a
demostrarlo para <script type="math/tex">k+1</script>. Por el Teorema de Euler para
<script type="math/tex">p^{k-1}</script>, sabemos que <script type="math/tex">r^{p^{k-2}(p-1)}-1</script> es
divisible por <script type="math/tex">p^{k-1}</script>, y nuestra hipótesis de
inducción indica que no es divisible por <script type="math/tex">p^k</script>. En otras
palabras, podemos escribir
<script type="math/tex"></script>r^{p^{k-2}(p-1)}=1+ap^{k-1}<script type="math/tex"></script>
con <script type="math/tex">a</script> no divisible por <script type="math/tex">p</script>. Elevando a <script type="math/tex">p</script>, tendremos
<script type="math/tex"></script>r^{p^{k-1}(p-1)}=(1+ap^{k-1})^p=1+ap^k+{p\choose
2}a^2p^{2k-2}+\dots<script type="math/tex"></script>
Como <script type="math/tex">p>2</script> (es aquí donde usamos que <script type="math/tex">p</script> sea impar),
<script type="math/tex">{p\choose 2}</script> es divisible por <script type="math/tex">p</script>, luego el sumando
<script type="math/tex">{p\choose 2}a^2p^{2k-2}</script> es divisible por <script type="math/tex">p^{2k-1}</script> y
<script type="math/tex">2k-1\ge k+1</script> por ser <script type="math/tex">k\ge2</script>. El resto de sumandos en los
puntos suspensivos son divisibles por <script type="math/tex">p^{i(k-1)}</script> con
<script type="math/tex">i\ge3</script>, y como <script type="math/tex">i(k-1)\ge3k-3\ge k+1</script> son también
divisible por
<script type="math/tex">p^{k+1}</script>. Se concluye así que 
<script type="math/tex"></script>r^{p^{k-1}(p-1)}\equiv1+ap^k\ (\text{mod } p^{k+1})<script type="math/tex"></script>
y como <script type="math/tex">ap^k</script> no es divisible por <script type="math/tex">p^{k+1}</script>, entonces
<script type="math/tex">r^{p^{k-1}(p-1)}-1</script> tampoco lo es.</p>

<p>Finalmente, dada una raíz primitiva módulo <script type="math/tex">p^k</script>, si
es par le a\~nadimos <script type="math/tex">p^k</script> y seguirá siendo una raíz
primitiva módulo <script type="math/tex">p^k</script>, pero ahora impar. Por tanto, existe
<script type="math/tex">r</script> impar que es una raíz primitiva módulo <script type="math/tex">p^k</script>.
Veamos que es también raíz primitiva módulo <script type="math/tex">2p^k</script>.
En efecto, en primer lugar es evidente que <script type="math/tex">\text{mcd}(r,2p^k)=1</script>,
ya que <script type="math/tex">\text{mcd}(r,2)=1</script> y <script type="math/tex">\text{mcd}(r,p^k)=1</script>. Por otra parte
<script type="math/tex">\phi(2p^k)=(2-1)p^{k-1}(p-1)=p^{k-1}(p-1)=\phi(p^k)</script>, luego
<script type="math/tex">r^{\phi(2p^k)}\equiv1\ (\text{mod } 2p^k)</script> y no existe
<script type="math/tex">a\lt \phi(2p^k)</script> tal que <script type="math/tex">r^a\equiv1\ (\text{mod } 2p^k)</script>, por lo
que <script type="math/tex">r</script> tiene orden <script type="math/tex">\phi(2p^k)</script> módulo <script type="math/tex">p^k</script>. 
\qed</p>

<p><b>EJEMPLO:</b> {<b>EJEMPLO:</b> ploprimitiva} El resultado anterior es
constructivo. Por ejemplo, vamos a buscar una raíz
primitiva módulo <script type="math/tex">242=2\cdot11^2</script>. Ya sabemos, por el
Ejemplo \onceprimitivo, que <script type="math/tex">2</script> es una raíz primitiva
módulo <script type="math/tex">11</script>. Nos preguntamos si será también una
raíz primitiva módulo <script type="math/tex">11^2</script>, para lo que usaremos
el Lema \lemapotenciaprimoprimitivo. Como
<script type="math/tex">2^{10}-1=1023=3\cdot11\cdot31</script> no es divisible por
<script type="math/tex">11^2</script>, se sigue que <script type="math/tex">2</script> es, en efecto, una raíz
primitiva módulo <script type="math/tex">11^2</script> (nótese que, si hubiéramos
obtenido que no lo era, la demostración del Teorema
\potenciaprimoprimitivo(ii) nos diría
automáticamente que <script type="math/tex">2+11</script> es una raíz primitiva).
Finalmente, por la demostración de la parte (iv) del
Teorema \potenciaprimoprimitivo, tenemos que <script type="math/tex">2+11^2=123</script>
es una raíz primitiva módulo <script type="math/tex">2\cdot11^2</script>.</p>

<p>\bigskip</p>

<p>Ahora que sabemos qué números tienen raíz primitiva,
veamos en qué podemos usar-lo. Obsérvese en primer
lugar que, si <script type="math/tex">r</script> es una raíz primitiva módulo <script type="math/tex">n</script>,
entonces por la Proposición \propiedadesordenes(iv) los
elementos <script type="math/tex">r,r^2,\dots,r^{\phi(n)}</script> son todos no
congruentes dos a dos, luego, por el Lema \restosprimos,
son congruentes módulo <script type="math/tex">n</script>, en algún orden, a los
números <script type="math/tex">1,2,\dots,n</script> que son primos con <script type="math/tex">n</script>. Por tanto,
cualquier <script type="math/tex">a\in\mathbb{Z}</script> con <script type="math/tex">\text{mcd}(a,n)=1</script> es congruente a un
único <script type="math/tex">r^i</script> con <script type="math/tex">i\in\{1,2,\dots,\phi(n)\}</script>. Recordando la
definición de logaritmo, damos la siguiente:</p>

<p><b>DEFINICIÓN:</b> Dado un número <script type="math/tex">n</script> con raíz primitiva <script type="math/tex">r</script>, se
llama índice de <script type="math/tex">a</script> relativo a <script type="math/tex">r</script> al menor entero
positivo <script type="math/tex">k</script> tal que <script type="math/tex">a\equiv r^k\ (\text{mod } n)</script> y escribiremos
<script type="math/tex">k=\text{ind}_r(a)</script>.</p>

<p><b>EJEMPLO:</b> {<b>EJEMPLO:</b> ploindice} Si <script type="math/tex">n=11</script>, sabemos por el Ejemplo
\onceprimitivo\ que <script type="math/tex">r=2</script> es una raíz primitiva
módulo <script type="math/tex">11</script>. Además, <script type="math/tex">1,2,3,4,5,6,7,8,9,10</script> son,
respectivamente, congruentes módulo <script type="math/tex">11</script> con
<script type="math/tex">2^{10},2^1,2^8,2^2,2^4,2^9,2^7,2^3,2^6,2^5</script>, por lo que
sus índices relativos a <script type="math/tex">2</script> son, respectivamente,
<script type="math/tex">10,1,8,2,4,9,7,3,6,5</script></p>

<p>El índice funciona, en efecto, como un logaritmo en
base <script type="math/tex">r</script>, y de hecho se tienen las siguientes propiedades:</p>

<p><b>LEMA:</b> \propiedadesindice. Si <script type="math/tex">r</script> es una
raíz primitiva módulo <script type="math/tex">n</script>, se verifica:
\item{(i)} <script type="math/tex">r^k\equiv a\ (\text{mod } n)</script> si y sólo si <script type="math/tex">k\equiv
\text{ind}_r(a)\ (\text{mod }\phi(n))</script>.
\item{(ii)} <script type="math/tex">\text{ind}_r(ab)\equiv\text{ind}_r(a)+{\rm
ind}_r(b)\ (\text{mod }\phi(n))</script>.
\item{(iii)} <script type="math/tex">\text{ind}_r(a^k)\equiv k\text{ind}_r(a)\
(\text{mod }\phi(n))</script>.
\item{(iv)} <script type="math/tex">\text{ind}_r(1)\equiv0\ (\text{mod }\phi(n))</script> (y de
hecho <script type="math/tex">\text{ind}_r(1)=\phi(n)</script>).
\item{(v)} <script type="math/tex">\text{ind}_r(r)=1</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Veamos primero (i). Como por definición <script type="math/tex">r^{\text{ind}_r(a)}\equiv a\ (\text{mod } n)</script>, entonces <script type="math/tex">r^k\equiv r^{\text{ind}_r(a)}\ (\text{mod } n)</script>, y por la Proposición
\propiedadesordenes(iii) se sigue <script type="math/tex">k\equiv
\text{ind}_r(a)\ (\text{mod }\phi(n))</script> (recuérdese que el hecho de
que <script type="math/tex">r</script> sea raíz primitiva módulo <script type="math/tex">n</script> se traduce en
que el orden de <script type="math/tex">r</script> módulo <script type="math/tex">n</script> es <script type="math/tex">\phi(n)</script>).</p>

<p>El resto de los apartados se demuestra inmediatamente a
partir de (i). Haremos sólo, a modo de ejemplo, (ii). Como
se tiene
<script type="math/tex"></script>r^{\text{ind}_r(a)+\text{ind}_r(b)}=
r^{\text{ind}_r(a)}r^{\text{ind}_r(b)}\equiv ab\ (\text{mod } n)<script type="math/tex"></script>
la parte (i) implica <script type="math/tex">\text{ind}_r(a)+{\rm
ind}_r(b)\equiv\text{ind}_r(ab)\ (\text{mod }\phi(n))</script>.
\qed</p>

<p>La teoría de índices se usa para resolver cierto
tipo de congruencias no lineales, pasando de congruencias
módulo <script type="math/tex">n</script> a congruencias módulo <script type="math/tex">\phi(n)</script>. Antes de ver
el resultado preciso, hagamos un ejemplo.</p>

<p><b>EJEMPLO:</b> {<b>EJEMPLO:</b> plocongruenciaspotencia} Consideremos la
congruencia <script type="math/tex">x^6\equiv\ 3(\text{mod } 11)</script>. Evidentemente,
cualquier solución verifica <script type="math/tex">\text{mcd}(x,11)=11</script>. Por tanto,
como <script type="math/tex">2</script> es una raíz primitiva módulo <script type="math/tex">11</script> ver
Ejemplo \onceprimitivo),  se podrá se podrá escribir
<script type="math/tex">x\equiv 2^y\ (\text{mod } 11)</script>. Además, sabemos que <script type="math/tex">3\equiv2^8\
(\text{mod } 11)</script>, por lo que nuestra congruencia es equivalente a
<script type="math/tex">2^{6y}\equiv 2^8\ (\text{mod } 11)</script>. Por la Proposición
\propiedadesordenes(iii), esta congruencia es equivalente a
<script type="math/tex">6y\equiv8\ (\text{mod } 10)</script>. Aplicando ahora la Proposición
\congruencialineal, sabemos que esta congruencia tiene dos
soluciones, precisamente <script type="math/tex">y\equiv3,8\ (\text{mod } 10)</script>. De nuevo
por la Proposición \propiedadesordenes(iii), estas
soluciones son equivalentes a <script type="math/tex">2^y\equiv2^3,2^8\ (\text{mod } 11)</script>,
es decir, <script type="math/tex">x\equiv8,3\ (\text{mod } 11)</script>.</p>

<p>\proclaim Teorema \congruenciaspotencia. Sea <script type="math/tex">n</script> un entero con
una raíz primitiva <script type="math/tex">r</script>, y sean <script type="math/tex">k\ge2</script> y
<script type="math/tex">d=\text{mcd}(k,\phi(n))</script>. Si
<script type="math/tex">a\in\mathbb{Z}</script> verifica <script type="math/tex">\text{mcd}(a,n)=1</script>, y por tanto <script type="math/tex">a\equiv r^b\
(\text{mod } n)</script> para algún <script type="math/tex">b\in\mathbb{Z}_{\ge1}</script>, entonces son
equivalentes:
\item{(i)} La congruencia <script type="math/tex">x^k\equiv a\ (\text{mod } n)</script> tiene
solución.
\item{(ii)} <script type="math/tex">d\vert b</script>.
\item{(iii)} <script type="math/tex">a^{\phi(n)\over d}\equiv1\ (\text{mod } n)</script>.
\smallskip
\noindent Además, en tal caso, la congruencia tiene
exactamente <script type="math/tex">d</script> soluciones módulo <script type="math/tex">n</script></p>

<p><b>DEMOSTRACIÓN:</b>  Evidentemente, las soluciones de <script type="math/tex">x^k\equiv a\ (\text{mod } n)</script>
verifican <script type="math/tex">\text{mcd}(x,n)=1</script>, por lo que se podrá escribir
<script type="math/tex">x\equiv r^y\ (\text{mod } n)</script> para algún <script type="math/tex">y\in\mathbb{Z}</script>. En otras
palabras, la congruencia tendrá solución si y sólo si
tiene solución la congruencia
<script type="math/tex"></script>r^{ky}\equiv r^b\ (\text{mod } n)<script type="math/tex"></script>
que, por la Proposición \propiedadesordenes(iii), es
equivalente a
<script type="math/tex"></script>ky\equiv b\ (\text{mod } \phi(n)).<script type="math/tex"></script>
Por la Proposición \congruencialineal, tal congruencia
tiene solución si y sólo si <script type="math/tex">d\vert b</script>, y además en tal caso
el número de soluciones módulo <script type="math/tex">\phi(n)</script> es <script type="math/tex">d</script>. Esto da
la equivalencia de (i) y (ii), y además tomando potencias
de <script type="math/tex">r</script> nos dice que el número de soluciones de
nuestra congruencia módulo <script type="math/tex">n</script> es <script type="math/tex">d</script>.</p>

<p>Finalmente, <script type="math/tex">d\vert b</script> es equivalente a <script type="math/tex">\phi(n)\vert b{\phi(n)\over
d}</script>, que por la Proposición \propiedadesordenes(i), es
equivalente a <script type="math/tex">r^{b{\phi(n)\over d}}\equiv1\ (\text{mod }
n)</script>, es decir, <script type="math/tex">a^{\phi(n)\over d}\equiv1\ (\text{mod } n)</script>, lo que
demuestra que (ii) y (iii) son equivalentes.
\qed</p>

<p>El resultado anterior nos permite generalizar el Teorema
\menosunocuadrado:</p>

<p>\proclaim Teorema \menosunopotenciados. Sea <script type="math/tex">p</script> un número
primo impar, y sea <script type="math/tex">m\ge1</script>. Entonces la congruencia
<script type="math/tex">x^{2^m}\equiv-1\ (\text{mod } p)</script> tiene solución si y sólo si
<script type="math/tex">p\equiv1\ (\text{mod } 2^{m+1})</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Si escribimos <script type="math/tex">p-1=2^na</script> con <script type="math/tex">a</script> impar, entonces es
evidente que <script type="math/tex">d=\text{mcd}(2^m,p-1)=2^{\min\{n,m\}}</script> y por tanto
<script type="math/tex">{p-1\over d}=2^{\max\{0,n-m\}}a</script>. Por la parte (iii) del
teorema (que podemos usar ya que <script type="math/tex">p</script> tiene raíces
primitivas), la congruencia tendrá solución si y sólo si
<script type="math/tex">(-1)^{p-1\over d}\equiv1\ (\text{mod } p)</script>, es decir, si y sólo
si <script type="math/tex">{p-1\over d}</script> es par, si y sólo si <script type="math/tex">n>m</script>, si y sólo
si <script type="math/tex">2^{m+1}\vert p-1</script>, si y sólo si
<script type="math/tex">p\equiv1\ (\text{mod } 2^{m+1})</script>.
\qed</p>

<p>Podemos por tanto generalizar el Corolario
\infinitosprimoscuatrokmasuno:</p>

<p>\proclaim Teorema \infinitosprimosdosalakmasuno. Para cada
<script type="math/tex">m\ge1</script>, existen infinitos número primos de la forma
<script type="math/tex">2^mk+1</script>.</p>

<p><b>DEMOSTRACIÓN:</b>  Si <script type="math/tex">p_1,p_2,\dots,p_r</script> fueran los únicos primos de la
forma <script type="math/tex">2^mk+1</script>, consideramos el número
<script type="math/tex">n=(2p_1p_2\dots p_r)^{2^{m-1}}+1</script>. Claramente, <script type="math/tex">n</script> es
impar, luego sus posibles divisores primos son impares. Si
<script type="math/tex">p</script> es un divisor primo impar de <script type="math/tex">n</script>, entonces
<script type="math/tex">2p_1p_2\dots p_r</script> es una solución de la congruencia
<script type="math/tex">x^{2^{m-1}}\equiv-1\ (\text{mod } p)</script>. Por el Teorema
\menosunopotenciados, <script type="math/tex">p\equiv1\ (\text{mod } 2^m)</script>, es decir,
<script type="math/tex">p</script> es de la forma <script type="math/tex">2^mk+1</script>. Por tanto <script type="math/tex">p</script> tiene que ser
alguno de los <script type="math/tex">p_1,p_2,\dots,p_r</script>, lo que es absurdo.
\qed</p>

<p>\ejer{\masinfinitosprimosdosalakmasuno} Demostrar que, para
cada <script type="math/tex">m\ge2</script>, existen infinitos número primos de la forma
<script type="math/tex">2^mk+2^{m-1}+1</script>.</p>
